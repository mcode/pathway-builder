(this["webpackJsonppathway-builder"]=this["webpackJsonppathway-builder"]||[]).push([[0],{1119:function(e,t){},1120:function(e,t){},1131:function(e,t,a){e.exports=a.p+"static/media/camino-builder-logo-light-bg.a225ed53.png"},1132:function(e,t,a){e.exports=a.p+"static/media/example-pathway.f89d4f23.png"},1134:function(e,t,a){e.exports=a.p+"static/media/mitre.54eb1f7d.png"},1135:function(e,t,a){e.exports=a.p+"static/media/mcode.644320c4.png"},1159:function(e,t,a){e.exports=a(1603)},146:function(e,t,a){e.exports={selectButton:"ActionButton_selectButton___qB5R",accept:"ActionButton_accept__28b2D",decline:"ActionButton_decline__zz-vG",smallActionButton:"ActionButton_smallActionButton__1bPWu",largeActionButton:"ActionButton_largeActionButton__blRdA",largeDecline:"ActionButton_largeDecline__wz9Zw",mediumActionButton:"ActionButton_mediumActionButton__3EpOp"}},1601:function(e,t){},1602:function(e,t,a){},1603:function(e,t,a){"use strict";a.r(t);a(1160),a(1169);var n=a(33);Object(n.b)();var r=a(0),o=a.n(r),i=a(55),c=a.n(i),l=a(45),u=a(169),s=a(13),d=a(21),m=a(12),p=a(1138),b=a(1674),f=Object(r.createContext)({}),h=Object(r.memo)((function(e){var t=e.children,a=Object(r.useState)(""),n=Object(s.a)(a,2),i=n[0],c=n[1],l=Object(r.useState)(null),u=Object(s.a)(l,2),d=u[0],m=u[1],p=Object(r.useState)(!1),b=Object(s.a)(p,2),h=b[0],v=b[1],y=Object(r.useState)(""),g=Object(s.a)(y,2),E=g[0],C=g[1],O=Object(r.useCallback)((function(){c(""),m(null),v(!1),C("")}),[c,m,v,C]);return o.a.createElement(f.Provider,{value:{buildCriteriaSelected:h,setBuildCriteriaSelected:v,currentCriteriaNodeId:i,setCurrentCriteriaNodeId:c,currentCriteria:d,setCurrentCriteria:m,criteriaName:E,setCriteriaName:C,resetCurrentCriteria:O}},t)})),v=function(){return Object(r.useContext)(f)},y=a(1640),g=a(52),E=a(1136),C=a(305),O=a.n(C),j={spacing:{globalPadding:"2em"}},k={white:"#fff",black:"#222",red:"#d95d77",redDark:"#bb3551",blue:"#5d89a1",blueDark:"#386883",blueLighter:"#9ad2f0",gray:"#4a4a4a",grayMedium:"#bbbdc0",grayBlue:"#cbd5df",grayBlueDark:"#7d8892",grayLight:"#6c6c6c",grayLighter:"#aaaeb1",grayLightest:"#eaeef2",grayDark:"#444",grayVeryDark:"#3a3a3a",green:"#2fa874"},w={fontFamily:["Open Sans","-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue","sans-serif"].join(",")},x={MuiButton:{root:{borderRadius:0,height:"38px","&$disabled":{backgroundColor:k.grayMedium,color:k.white}},contained:{"&$disabled":{backgroundColor:k.grayMedium,color:k.white}},label:{fontWeight:600},iconSizeMedium:{"& > *:first-child":{fontSize:14}},iconSizeSmall:{"& > *:first-child":{fontSize:14}}},MuiTableHead:{root:{backgroundColor:k.grayLightest}},MuiTableCell:{root:{fontSize:"1em"},head:{padding:"5px 16px",borderBottom:"none"}},MuiFormControl:{root:{margin:"10px 0"}},MuiFormLabel:{root:{fontStyle:"italic","&.Mui-error":{color:k.white},"&.Mui-disabled":{color:k.white}}},MuiInputBase:{root:{fontWeight:600},input:{"&::selection":{color:k.white,backgroundColor:k.grayDark},"&:-webkit-autofill":{transitionDelay:"9999s",transitionProperty:"background-color, color"},"&$disabled":{color:k.white,backgroundColor:k.grayDark}}},MuiTooltip:{tooltip:{fontSize:14,backgroundColor:k.black},arrow:{color:k.black}},MuiOutlinedInput:{root:{borderRadius:"0"}},MuiSelect:{icon:{fontSize:"2em"}},MuiPaper:{rounded:{borderRadius:"0"}},MuiDialogTitle:{root:{display:"flex",justifyContent:"flex-end",padding:"1em 2em"}},MuiDialogContent:{root:{display:"flex",flexDirection:"column",padding:"0 4em",lineHeight:"normal",overflowY:"initial",color:k.grayLighter}},MuiDialogActions:{root:{display:"flex",justifyContent:"space-between",padding:"2em 4em",color:k.grayLighter,marginBottom:"2em"}},MuiCard:{root:{overflow:"visible"}},MuiIconButton:{root:{color:k.gray,"&:disabled":{color:k.grayMedium}},sizeSmall:{width:"20px",height:"20px",margin:"9px"}}},N={MuiFormControl:{root:{"&:hover":{borderColor:k.white}}},MuiFormLabel:{root:{color:k.white,"&$focused":{color:k.white}}},MuiInputBase:{root:{color:k.white,"&:hover":{borderColor:k.white,backgroundColor:k.grayDark}}},MuiTooltip:{tooltip:{fontSize:14}},MuiOutlinedInput:{root:{"&:hover":{borderColor:k.white},"&:hover $notchedOutline":{borderColor:k.white},"&$focused $notchedOutline":{borderColor:k.white},"&$disabled $notchedOutline":{borderColor:k.white}},notchedOutline:{borderColor:k.white}},MuiSelect:{icon:{color:k.white}},MuiMenuItem:{root:{color:k.grayDark}},MuiIconButton:{root:{color:k.white,"&:disabled":{color:k.grayLight}}}},S={primary:{main:k.blue},secondary:{main:k.red},error:{main:k.red},common:k,background:{default:k.grayLightest},text:{primary:k.gray,secondary:k.gray},grey:{800:k.gray}},T=Object(E.a)({typography:Object(g.a)({},w),palette:Object(g.a)({},S),overrides:Object(g.a)({},x),variables:Object(g.a)({},j)}),I=Object(E.a)({typography:Object(g.a)({},w),palette:O()(S,{text:{primary:k.white,secondary:k.white}}),overrides:O()(x,N),variables:Object(g.a)({},j)}),R=Object(E.a)({typography:Object(g.a)({},w),palette:O()(S,{background:{default:k.grayBlue},text:{primary:k.black,secondary:k.black}}),overrides:Object(g.a)({},x),variables:Object(g.a)({},j)}),P=function(e){var t=e.theme;if(e.useProjector)switch(t){case"dark":return I;default:return R}switch(t){case"dark":return I;default:return T}},L=Object(r.createContext)({}),B=function(){return Object(r.useContext)(L).toggleTheme},D=function(e){var t=Object(r.useContext)(L).useProjector;return P({theme:e,useProjector:t})},M=Object(r.memo)((function(e){var t=e.theme,a=void 0===t?"light":t,n=e.children,i=Object(r.useState)(!1),c=Object(s.a)(i,2),l=c[0],u=c[1],d=P({theme:a,useProjector:l}),m=Object(r.useCallback)((function(){u((function(e){return!e}))}),[]);return o.a.createElement(y.a,{theme:d},o.a.createElement(L.Provider,{value:{useProjector:l,toggleTheme:m}},n))})),A=a(297),F=a.n(A),q=a(171),z=a.n(q),W=Object(r.memo)((function(){var e=v().resetCurrentCriteria,t=Object(r.useState)(null),a=Object(s.a)(t,2),n=a[0],i=a[1],c=B(),u=Object(r.useCallback)((function(e){i(e.currentTarget)}),[]),f=Object(r.useCallback)((function(){i(null)}),[]),h=Object(r.useCallback)((function(){c(),f()}),[c,f]);return o.a.createElement("header",{className:z.a.header},o.a.createElement(l.b,{to:"/builder",className:z.a.homeLink,onClick:e},o.a.createElement("img",{src:F.a,alt:"logo",className:z.a.logo})),o.a.createElement("button",{onClick:u,"aria-controls":"options-menu","aria-haspopup":"true"},o.a.createElement(d.a,{icon:m.h})),o.a.createElement(p.a,{id:"options-menu",anchorEl:n,keepMounted:!0,open:Boolean(n),onClose:f},o.a.createElement(b.a,{onClick:h},"Toggle Theme")))})),_=a(50),H=a(1646),G=a(1651),U=a(1644),K=Object(U.a)((function(e){return{root:{display:"flex",alignItems:"center",padding:"2em",backgroundColor:e.palette.background.default,color:e.palette.text.primary,height:"6em",justifyContent:"space-between"},backButton:{height:"45px",width:"45px"},navigationIcons:{fontSize:"20px",cursor:"pointer"},pathwayName:{fontSize:"1.4em",marginLeft:"1.5em"}}}),{name:"Navigation",index:1}),Q=a(1125);var V=function(e){var t=Object(Q.a)(e),a=Object(s.a)(t,2),n=a[0],o=a[1],i=o.set,c=o.reset,l=o.undo,u=o.redo,d=o.canUndo,m=o.canRedo,p=Object(r.useRef)(n.present);return Object(r.useEffect)((function(){p.current=n.present}),[n]),[n.present,p,d,m,l,u,c,i]},J=a(215),Y=a(242),$=a.n(Y),X=a(94),Z=X.a.get("pathwaysBackend");function ee(e){return $.a.delete("".concat(Z,"/pathway/").concat(e))}function te(e){return $.a.put("".concat(Z,"/pathway/").concat(e.id),e)}function ae(e){return $.a.delete("".concat(Z,"/criteria/").concat(e))}function ne(e){return $.a.put("".concat(Z,"/criteria/").concat(e.id),e)}function re(e,t){var a=new FileReader;a.onload=t,a.readAsText(e)}var oe=Object(r.createContext)({}),ie=Object(r.memo)((function(e){var t=e.children,a=V(null),n=Object(s.a)(a,8),i=n[0],c=n[1],l=n[2],u=n[3],d=n[4],m=n[5],p=n[6],b=n[7],f=Object(_.e)(),h=Object(r.useCallback)((function(){d()}),[d]),v=Object(r.useCallback)((function(){m()}),[m]),y=Object(r.useCallback)((function(e){p(e)}),[p]),g=Object(r.useCallback)((function(e){b(e)}),[b]),E=Object(_.c)(te,{onSettled:function(){return f.invalidateQueries("pathway")}}),C=Object(s.a)(E,1)[0];return Object(r.useEffect)((function(){i&&C(i)}),[i,C]),o.a.createElement(oe.Provider,{value:{pathway:i,pathwayRef:c,canUndoPathway:l,canRedoPathway:u,undoPathway:h,redoPathway:v,resetCurrentPathway:y,setCurrentPathway:g}},o.a.createElement(J.a,{keyName:"control+z,command+z",onKeyDown:h},o.a.createElement(J.a,{keyName:"control+y,command+y",onKeyDown:v},t)))})),ce=function(){return Object(r.useContext)(oe)},le=a(76),ue=a.n(le),se=a(112),de=a(70),me=a.n(de),pe=a(72),be=a(129),fe=a(164),he=a(208),ve=a(1671);function ye(e){return e&&"null"!==e.type?e.type:"null"}function ge(e){return"action"===e.type}function Ee(e){return"branch"===e.type}var Ce={MedicationRequest:"Medication",ServiceRequest:"Procedure",CarePlan:"Regimen"},Oe=[{label:"Medication",value:"MedicationRequest"},{label:"Procedure",value:"ServiceRequest"},{label:"Regimen",value:"CarePlan"},{label:"Observation",value:"Observation"},{label:"Pathway Reference",value:"Reference"}];function je(e,t){var a=ke(e,t);return 1===a.length?a[0]:null}function ke(e,t){var a=[];return Object.keys(e).forEach((function(n){var r,o=Object(be.a)(e[n].transitions);try{for(o.s();!(r=o.n()).done;){if(r.value.transition===t){a.push(n);break}}}catch(i){o.e(i)}finally{o.f()}})),a}function we(e){return JSON.parse(JSON.stringify(e))}function xe(e,t){var a=function(e){return JSON.parse(JSON.stringify(e))}(e);return a.key=t,a}function Ne(e,t){var a=0;return Object.keys(e.nodes).forEach((function(n){e.nodes[n].transitions.forEach((function(e){e.transition===t&&(a+=1)}))})),!(a>=2)}function Se(e,t){var a=!0;return t.forEach((function(t){Ne(e,t.transition)&&(a=!1)})),a}function Te(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r="".concat(n?"/demo":"","/builder/").concat(encodeURIComponent(e),"/node/").concat(encodeURIComponent(t));r!==a.location.pathname&&a.push(r)}var Ie=function(e,t){var a,n=[],r=function e(t,a,n){var r=[],o=[],i=t.nodes[n];return i.transitions.forEach((function(n){var c;n.transition===a?r.push(i):(null===(c=o=e(t,a,n.transition))||void 0===c?void 0:c.length)&&(r.some((function(e){return e.key===i.key}))||r.push(i),r=r.concat(o))})),r}(e,null!==(a=t.key)&&void 0!==a?a:"","Start");return r.push(t),Object.keys(e.nodes).forEach((function(a){var o=e.nodes[a],i=t.transitions.some((function(e){return e.transition===a})),c=r.some((function(e){return e.key===a}));i||c||!o.key||n.push({label:o.label,value:o.key})})),n},Re=function(e){var t;switch(e.resource.resourceType){case"MedicationRequest":t=e.resource.medicationCodeableConcept;break;case"ServiceRequest":t=e.resource.code;break;case"CarePlan":t={coding:[{system:"FakeCarePlanSystem",code:e.resource.title,display:"Fake CodeableConcept for CarePlan"}],text:"Fake CodeableConcept for CarePlan"}}return t},Pe=a(173),Le=a(238);function Be(e,t,a,n){var r=Object.entries(t).map((function(e){var t=Object(s.a)(e,2),a=t[0],n=t[1];return'include "'.concat(a,"\" version '").concat(n.version,"' called ").concat(a,"\n\n")})).join(""),o=Object.entries(a).map((function(e){var t=Object(s.a)(e,2),a=t[0],n=t[1];return'define "'.concat(a,'": ').concat(n,'."').concat(a,'"\n\n')}));Object.entries(n).forEach((function(e){var t=Object(s.a)(e,2),a=t[0],n=t[1];return o.push('define "'.concat(a,'": ').concat(n,"\n\n"))}));var i=o.join("");return"\nlibrary ".concat(e," version '1.0'\n\nusing FHIR version '4.0.1'\n\n").concat(r,"\n\ncontext Patient\n\n").concat(i,"\n")}var De=/library ([^ ]*)/,Me=/version '(.*)'/,Ae=Pe.R4.LibraryStatusKind._draft,Fe=Pe.R4.PlanDefinitionStatusKind._draft,qe=Pe.R4.ActivityDefinitionStatusKind._draft,ze=Pe.R4.BundleTypeKind._transaction,We=Pe.R4.Bundle_RequestMethodKind._put,_e=Pe.R4.PlanDefinition_ConditionKindKind._applicability,He=Pe.R4.ExpressionLanguageKind._textCql,Ge=Le.PlanDefinition_RelatedActionRelationshipKind._beforeStart,Ue=Le.PlanDefinition_RelatedActionRelationshipKind._afterEnd,Ke=function(){function e(t,a,n){Object(fe.a)(this,e),this.pathway=void 0,this.pathways=void 0,this.bundle=void 0,this.criteria=void 0,this.nestedBranch=void 0,this.libraries=void 0,this.activityDefinitions=void 0;var r=we(t);r.nodes=$e(r.nodes),this.pathway=r,this.bundle={id:this.pathway.id,resourceType:"Bundle",type:ze,entry:[]},this.criteria=n,this.nestedBranch=[],this.activityDefinitions={},this.libraries=[],this.pathways=a}return Object(he.a)(e,[{key:"export",value:function(){var e=this.createPlanDefinition(Object(ve.a)(),"Strategy".concat(this.pathway.name),"Strategy for ".concat(this.pathway.name),"strategy");return this._export(e,this.pathway),this.bundle.entry.push(Je(e)),this.bundle}},{key:"_export",value:function(e,t,a,n){var r=this,o=Ye(t.name,"Action for ".concat(t.name));(null===a||void 0===a?void 0:a.id)&&o.id&&(Ve(o,a.id,Ue),Ve(a,o.id,Ge),n&&(o.condition=n)),e.action.find((function(e){return e.id===t.name}))||function(){for(var a=r.createLibraries(t),n=a[0],i=Object(ve.a)(),c=r.createPlanDefinition(i,t.name,t.description,"recommendation",n.id),l=["Start"],u=[],s=function(){var n=l.shift(),i=t.nodes[n],s=je(t.nodes,n);if(s&&!u.includes(s))return l.filter((function(e){return e!==s})),l.unshift(s),l.push(n),"continue";s&&r.convertNode(n,s,c,e,t,o,a),u.push(n),i.transitions.forEach((function(e){u.includes(e.transition)||l.includes(e.transition)||l.push(e.transition)}))};0!==l.length;)s();c.action.length&&(o.definitionCanonical=Qe("PlanDefinition",i),r.bundle.entry.push(Je(c))),e.action.push(o),a.forEach((function(e){var t=e.content[0].data;!r.libraries.find((function(e){return e===t}))&&t&&(r.bundle.entry.push(Je(e)),r.libraries.push(t))}))}()}},{key:"createActivityDefinition",value:function(e){var t=Object(ve.a)(),a=e.resource.resourceType,n=Re(e),r=n.coding[0];if(this.activityDefinitions[r.system]&&this.activityDefinitions[r.system][r.code])return null;var o={id:t,resourceType:"ActivityDefinition",meta:{profile:["http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-publishableactivity"]},extension:[{url:"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability",valueCode:"publishable"}],url:"urn:uuid:".concat(t),version:"1.0",name:"AD".concat(t.substring(0,7)),title:"ActivityDefinition: ".concat(t),status:qe,experimental:!0,date:(new Date).toISOString(),publisher:"Logged in user",description:e.description,kind:a};switch(a){case"MedicationRequest":o.productCodeableConcept=n;break;case"ServiceRequest":case"CarePlan":o.code=n}return this.setActivityDefinitionId(r,t),o}},{key:"createPlanDefinition",value:function(e,t,a,n,r){var o={id:e,resourceType:"PlanDefinition",meta:{profile:["http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-".concat(n,"definition")]},extension:[{url:"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability",valueCode:"executable"}],url:"urn:uuid:".concat(e),version:"1.0",name:"PD".concat(e.substring(0,7)),title:t,type:{coding:[{system:"http://terminology.hl7.org/CodeSystem/plan-definition-type",code:"strategy"===n?"workflow-definition":"eca-rule",display:"strategy"===n?"Workflow Definition":"ECA Rule"}]},status:Fe,experimental:!0,publisher:"Logged in user",description:a,action:[]};return r&&(o.library=[r]),o}},{key:"createLibraries",value:function(e){var t=this,a=Object(ve.a)(),n="LIB".concat(a.substring(0,7)),r={id:a,resourceType:"Library",meta:{profile:["http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-executablelibrary"]},extension:[{url:"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability",valueCode:"executable"}],url:"urn:uuid:".concat(a),version:"1.0",name:n,title:"Library for ".concat(e.name),status:Ae,experimental:!0,type:{coding:[{system:"http://terminology.hl7.org/CodeSystem/library-type",code:"logic-library",display:"Logic Library"}]},publisher:"Logged in user",description:"CQL/ELM library for pathway: ".concat(e.name),content:[]},o={},i={},c={};for(var l in e.nodes){var u,d=e.nodes[l],m=Object(be.a)(d.transitions);try{var p=function(){var e,a=u.value;if(null===(e=a.condition)||void 0===e?void 0:e.criteriaSource){var n=t.criteria.find((function(e){var t;return e.id===(null===(t=a.condition)||void 0===t?void 0:t.criteriaSource)}));if(null===n||void 0===n?void 0:n.cql){var r=De.exec(n.cql),l=Me.exec(n.cql);if(r&&l){var d=r[1],m=l[1];o[d]={cql:n.cql,version:m},i[a.condition.cql]=d,(null===n||void 0===n?void 0:n.cqlLibraries)&&Object.entries(n.cqlLibraries).forEach((function(e){var t=Object(s.a)(e,2),a=t[0],n=t[1];n.cql&&(o[a]={cql:n.cql,version:(null===n||void 0===n?void 0:n.version)||""},i[n.cql]=a)}))}}else(null===n||void 0===n?void 0:n.builder)&&(c[n.statement]=n.builder.cql)}};for(m.s();!(u=m.n()).done;)p()}catch(h){m.e(h)}finally{m.f()}}var b=Object.entries(o).map((function(t){var a=Object(s.a)(t,2),n=a[0],r=a[1],o=Object(ve.a)();return{id:o,resourceType:"Library",url:"urn:uuid:".concat(o),version:r.version,name:n,title:n,status:Ae,experimental:!0,type:{coding:[{system:"http://terminology.hl7.org/CodeSystem/library-type",code:"logic-library",display:"Logic Library"}]},publisher:"Logged in user",description:"CQL/ELM library for pathway: ".concat(e.name," / sublibrary ").concat(n),content:[{id:n,contentType:"text/cql",data:btoa(r.cql),title:"CQL for library ".concat(n)}]}})),f=Be(n,o,i,c);return r.content.push({id:"navigational-cql",contentType:"text/cql",data:btoa(f),title:"CQL for navigating the pathway"}),e.elm&&r.content.push({id:"navigational-elm",contentType:"application/elm+json",data:btoa(JSON.stringify(e.elm.navigational)),title:"ELM for navigating the pathway"},{id:"precondition",contentType:"application/elm+json",data:btoa(JSON.stringify(e.elm.preconditions)),title:"ELM for pathway preconditions"}),[r].concat(Object(pe.a)(b))}},{key:"convertNode",value:function(e,t,a,n,r,o,i){var c=r.nodes[e],l=r.nodes[t],u="".concat(c.label," (Key: ").concat(e,") - Parent Node Key: ").concat(t);if(ge(c)){var s=this.createActivityDefinition(c.action),d=Ye(e,"Action for ".concat(u),s?s.id:this.getActivityDefinitionId(c.action));Ee(l)&&(d.condition=this.createCondition(l,e,i));for(var m=l;Ee(m);){var p=je(r.nodes,m.key);if(!p)break;m=r.nodes[p]}"Start"!==m.key&&Ve(d,m.key,Ue),function e(t,a){var n=[];return t[a].transitions.map((function(e){return e.transition})).forEach((function(a){ge(t[a])?n.push(a):n.push.apply(n,Object(pe.a)(e(t,a)))})),n}(r.nodes,e).forEach((function(e){return Ve(d,e,Ge)})),this.addActionToPlanDefinition(d,a,l.key),s&&this.bundle.entry.push(Je(s))}else if(Ee(c)){var b="Branch based on ".concat(u);if(Ee(l)){var f=Ye(e,b);f.condition=this.createCondition(l,e,i),this.nestedBranch.push(e),this.addActionToPlanDefinition(f,a,l.key)}}else if(function(e){return"reference"===e.type}(c)){var h=this.pathways.find((function(e){return e.id===c.referenceId}));if(h){var v=we(h);if(v.nodes=$e(v.nodes),Ee(l)){var y=this.createCondition(l,e,i);this._export(n,v,o,y)}else this._export(n,v,o)}}else if("start"!==c.type){var g="Error Exporting at Node ".concat(c.label,"\n").concat(c.label," Node does not have a node type. Please edit the node to have a node type and add applicable details and try again.");throw alert(g),console.error("".concat(g,"\n").concat(JSON.stringify(c,void 0,2))),g}}},{key:"createCondition",value:function(e,t,a){var n=a[0],r=function(e,t){return e.transitions.find((function(e){return e.transition===t}))}(e,t);if(r){var o=this.criteria.find((function(e){var t;return e.id===(null===(t=r.condition)||void 0===t?void 0:t.criteriaSource)}));return[{kind:_e,expression:{language:He,expression:"".concat(n.name,".").concat(null===o||void 0===o?void 0:o.statement)}}]}return[]}},{key:"getActivityDefinitionId",value:function(e){var t=Re(e).coding[0];return this.activityDefinitions[t.system][t.code]}},{key:"setActivityDefinitionId",value:function(e,t){this.activityDefinitions[e.system]||(this.activityDefinitions[e.system]={}),this.activityDefinitions[e.system][e.code]=t}},{key:"addActionToPlanDefinition",value:function(e,t,a){if(this.nestedBranch.includes(a)){var n,r=function e(t,a){var n,r=Object(be.a)(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(o.id===a)return o;if(o.action){var i=e(o.action,a);if(i)return i}}}catch(c){r.e(c)}finally{r.f()}return}(t.action,a);if(!r)return;(null===(n=r.action)||void 0===n?void 0:n.length)?r.action.push(e):r.action=[e]}else t.action.push(e)}}]),e}();function Qe(e,t){return"http://example.com/".concat(e,"/").concat(t)}function Ve(e,t,a){var n,r={actionId:t,relationship:a};(null===(n=e.relatedAction)||void 0===n?void 0:n.length)?e.relatedAction.push(r):e.relatedAction=[r]}function Je(e){return{fullUrl:Qe(e.resourceType,e.id),resource:e,request:{method:We,url:"/".concat(e.resourceType,"/").concat(e.id)}}}function Ye(e,t,a){var n={id:e,title:"Action: ".concat(e),description:t,code:[{coding:[{system:"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process",code:"guideline-based-care",display:"Guideline-based Care"}]}]};return a&&(n.definitionCanonical=Qe("ActivityDefinition",a)),n}function $e(e){var t=e;return Object.keys(e).forEach((function(a){var n=function(e,t){var a=[];return ke(e,t).forEach((function(n){e[n].transitions.forEach((function(e){e.transition===t&&a.push(e)}))})),a}(e,a);n.length>1&&(n.shift(),n.forEach((function(n){var r=function(e,t){var a={},n={},r=function(e){return e.transitions.map((function(e){return e.transition}))},o=t,i=me.a.generate();n[o]=i,a[i]=xe(e[o],i);for(var c=r(e[o]),l=[o];c.length;)o=c.shift(),l.includes(o)||(i=me.a.generate(),n[o]=i,a[i]=xe(e[o],i),c.push.apply(c,Object(pe.a)(r(e[o]))),l.push(o));return Object.keys(a).forEach((function(e){a[e].transitions.forEach((function(e){return e.transition=n[e.transition]}))})),a}(e,a);r=$e(r),n&&(n.transition=r[Object.keys(r)[0]].key,Object.keys(r).forEach((function(e){return t[e]=r[e]})))})))})),t}var Xe=a(1126),Ze=X.a.get("cqlToElmWebserviceUrl"),et=new Xe.Client(Ze);function tt(e){return et.convertCQL(e)}var at=function(){function e(t,a,n){Object(fe.a)(this,e),this.pathway=void 0,this.criteria=void 0,this.actionCqlLibraries=void 0,this.pathway=we(t),this.criteria=a,this.actionCqlLibraries=n}return Object(he.a)(e,[{key:"export",value:function(){var e=this,t=Object(ve.a)(),a="LIB".concat(t.substring(0,7)),r={},o={},i={};for(var c in this.actionCqlLibraries.forEach((function(e){r[e.name]={cql:e.cql,version:e.version},o[e.nodeKey]=e.name})),this.pathway.nodes){var l,u=this.pathway.nodes[c],d=Object(be.a)(u.transitions);try{var m=function(){var t,n=l.value;if(null===(t=n.condition)||void 0===t?void 0:t.criteriaSource){var c=e.criteria.find((function(e){var t;return e.id===(null===(t=n.condition)||void 0===t?void 0:t.criteriaSource)}));if(null===c||void 0===c?void 0:c.cql){var u=De.exec(c.cql),d=Me.exec(c.cql);if(u&&d){var m=u[1].replace(/"/g,""),p=d[1];r[m]={cql:c.cql,version:p},o[n.condition.cql]=m,(null===c||void 0===c?void 0:c.cqlLibraries)&&Object.entries(c.cqlLibraries).forEach((function(e){var t=Object(s.a)(e,2),a=t[0],n=t[1];n.cql&&(r[a]={cql:n.cql,version:(null===n||void 0===n?void 0:n.version)||""})})),n.condition.cql.startsWith(m)||(n.condition.cql="".concat(m,".").concat(n.condition.cql))}}else(null===c||void 0===c?void 0:c.builder)&&(i[c.statement]=c.builder.cql,n.condition.cql="".concat(a,".").concat(n.condition.cql))}};for(d.s();!(l=d.n()).done;)m()}catch(h){d.e(h)}finally{d.f()}}var p=[],b=Be(a,r,o,i);if(p.push(b),Object.keys(r).length>0){var f=Object.values(r).map((function(e){return e.cql}));p.push.apply(p,Object(pe.a)(f))}return this.pathway.library=p,r[a]={cql:b,version:"1.0"},tt(r).then((function(t){var r,o,i=t[a],c=[];return Object.keys(t).forEach((function(e){e!==a&&c.push(t[e])})),r=e.pathway,o=[i].concat(c),Object(n.a)(r,(function(e){e.elm||(e.elm={}),e.elm.navigational={main:o[0],libraries:o.slice(1)}}))}))}}]),e}(),nt=a(209),rt=a.n(nt);function ot(e,t,a){return{id:null!==a&&void 0!==a?a:me.a.generate(),name:e,description:t,library:[""],preconditions:[],nodes:{Start:{key:"Start",label:"Start",transitions:[],type:"start"}}}}function it(e,t){var a=!1,r=t.map((function(e){return e.id})),o=Object(n.a)(e,(function(e){Object.entries(e.nodes).forEach((function(n){var o=Object(s.a)(n,2),i=o[0];o[1].transitions.forEach((function(n,o){var c=n.condition;if(c&&!r.includes(c.criteriaSource)){var l,u=c.cql.split("."),d=Object(s.a)(u,2),m=d[0],p=d[1],b=null===(l=t.find((function(e){if(!e.cql)return!1;var t=De.exec(e.cql);return t&&t[1]===m&&e.statement===p})))||void 0===l?void 0:l.id;if(b){var f=e.nodes[i].transitions[o].condition;f&&(a=!0,f.criteriaSource=b)}}}))}))}));return{updated:a,newPathway:o}}function ct(e,t){return e.map((function(e){return it(e,t).newPathway}))}function lt(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if((e=ct(e,a)).length>1){var r=new rt.a;return e.forEach((function(e){r.file("".concat(e.name,".json"),st(e,t,a,n))})),r.generateAsync({type:"blob"}).then((function(e){ut(e,"pathways.zip")}))}return st(e[0],t,a,n).then((function(t){ut(new Blob([t],{type:"application/json"}),"".concat(e[0].name,".json"))}))}function ut(e,t){var a=window.URL.createObjectURL(e),n=document.createElement("a");n.href=a,n.download=t,n.click(),window.URL.revokeObjectURL(a)}function st(e,t,a,n){return dt.apply(this,arguments)}function dt(){return(dt=Object(se.a)(ue.a.mark((function e(t,a,n,r){var o,i,c,l;return ue.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=mt(t),!r){e.next=6;break}c=new Ke(t,a,n),i=c.export(),e.next=10;break;case 6:return l=new at(t,n,o),e.next=9,l.export();case 9:i=e.sent;case 10:return e.abrupt("return",JSON.stringify(i,void 0,2));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mt(e){var t=[];return Object.keys(e.nodes).forEach((function(a){var n=e.nodes[a];ge(n)&&t.push(function(e,t){var a=e.resource,n="cql".concat(me.a.generate().replace(/-/g,"a")),r="library ".concat(n," version '1'\nusing FHIR version '4.0.1'\n"),o=function(e){return'codesystem "'.concat(e,"\": '").concat(e,"'\n")},i=function(e){return"return Tuple{ resourceType: '".concat(e,"', id: R.id.value, status: R.status.value}")},c=function(e){return"[".concat(e,': "').concat(n,' code"]')},l=function(){return'define "'.concat(t,'":')};if("MedicationRequest"===a.resourceType){var u=a.medicationCodeableConcept.coding[0];r+=o(u.system),r+='code "'.concat(n," code\": '").concat(escape(u.code),"' from \"").concat(u.system,"\" display '").concat(u.display,"'\n"),r+="".concat(l(),"\n      ").concat(c("MedicationRequest")," R ").concat(i("MedicationRequest"))}else if("ServiceRequest"===a.resourceType){var s=a.code.coding[0];r+=o(s.system),r+='code "'.concat(n," code\": '").concat(escape(s.code),"' from \"").concat(s.system,"\" display '").concat(s.display,"'\n"),r+="".concat(l(),"\n      if exists ").concat(c("Procedure"),"\n      then ").concat(c("Procedure")," R ").concat(i("Procedure"),"\n      else ").concat(c("ServiceRequest")," R ").concat(i("ServiceRequest"))}else"CarePlan"===a.resourceType?r+="".concat(l(),"\n      [CarePlan] R where R.title.value = '").concat(escape(a.title),"' ").concat(i("CarePlan")):console.error("Auto generating CQL for action - unsupported resource type: "+a.resourceType);return{name:n,version:"1",cql:r,nodeKey:t}}(n.action,a))})),t}function pt(e){return e||(e="N"+me.a.generate()),{key:e,label:"New Node",transitions:[],type:"null"}}function bt(e,t){return Object(n.a)(e,(function(e){e.nodes[t.key]=t}))}function ft(e,t,a){return Object(n.a)(e,(function(e){e.nodes[t].label=a}))}function ht(e,t,a,r){return Object(n.a)(e,(function(e){e.nodes[t].referenceId=a,e.nodes[t].referenceLabel=r}))}function vt(e,t,a){switch(a){case"MedicationRequest":return yt(Nt(e,t),t,{type:"create",description:"",id:me.a.generate(),resource:{resourceType:a,medicationCodeableConcept:{coding:[{system:"",code:"",display:""}]}}});case"ServiceRequest":return yt(Nt(e,t),t,{type:"create",description:"",id:me.a.generate(),resource:{resourceType:a,code:{coding:[{system:"",code:"",display:""}]}}});case"CarePlan":return yt(Nt(e,t),t,{type:"create",description:"",id:me.a.generate(),resource:{resourceType:a,title:""}});case"Observation":return function(e,t){return Object(n.a)(e,(function(e){var a=e.nodes[t],n={key:a.key,label:a.label,transitions:a.transitions,type:"branch"};e.nodes[t]=n}))}(e,t);case"Reference":return function(e,t){return Object(n.a)(e,(function(e){var a=e.nodes[t],n={key:a.key,label:a.label,transitions:a.transitions,referenceId:"",referenceLabel:"",type:"reference"};e.nodes[t]=n}))}(e,t);default:return console.error("Unknown nodeType: "+a),e}}function yt(e,t,a){return Object(n.a)(e,(function(e){e.nodes[t].action=a}))}function gt(e,t,a){return Object(n.a)(e,(function(e){var n={id:"T"+me.a.generate(),transition:a};e.nodes[t].transitions.push(n)}))}function Et(e,t,a,r,o){return Object(n.a)(e,(function(e){var n,i,c=null===(n=e.nodes[t])||void 0===n||null===(i=n.transitions)||void 0===i?void 0:i.find((function(e){return e.id===a}));c&&(c.condition={description:r,cql:o.statement,criteriaSource:o.id})}))}function Ct(e,t,a,r){return Object(n.a)(e,(function(e){var n,o,i=null===(n=e.nodes[t])||void 0===n||null===(o=n.transitions)||void 0===o?void 0:o.find((function(e){return e.id===a}));(null===i||void 0===i?void 0:i.condition)?i.condition.description=r:i&&(i.condition={description:r,criteriaSource:"",cql:""})}))}function Ot(e,t){return Object(n.a)(e,(function(e){e.resource.medicationCodeableConcept?e.resource.medicationCodeableConcept.coding[0].code=t:e.resource.code.coding[0].code=t}))}function jt(e,t){return Object(n.a)(e,(function(e){e.resource.medicationCodeableConcept?e.resource.medicationCodeableConcept.coding[0].system=t:e.resource.code.coding[0].system=t}))}function kt(e,t){return Object(n.a)(e,(function(e){e.description=t}))}function wt(e,t){return Object(n.a)(e,(function(e){e.resource.title=t}))}function xt(e,t){return Object(n.a)(e,(function(e){e.resource.medicationCodeableConcept?e.resource.medicationCodeableConcept.coding[0].display=t:e.resource.title?e.resource.description=t:e.resource.code.coding[0].display=t}))}function Nt(e,t){return Object(n.a)(e,(function(e){var a=e.nodes[t];a.type="action",a.transitions.forEach((function(e){delete e.condition}))}))}function St(e,t){return Object(n.a)(e,(function(e){delete e.nodes[t],Object.keys(e.nodes).forEach((function(a){e.nodes[a].transitions.forEach((function(n){n.transition===t&&(e.nodes[a].transitions=e.nodes[a].transitions.filter((function(e){return n.id!==e.id})))}))}))}))}function Tt(e,t,a){return Object(n.a)(e,(function(e){var n=e.nodes[t].transitions.find((function(e){return e.id===a}));n&&delete n.condition}))}function It(e,t,a){return Object(n.a)(e,(function(e){var n=e.nodes[t].transitions.filter((function(e){return e.transition!==a}));e.nodes[t].transitions=n}))}var Rt=a(1675),Pt=a(1668),Lt=function(e){var t=e.message,a=e.open,n=e.closeAlert;return o.a.createElement(Rt.a,{open:a,autoHideDuration:6e3,onClose:n,anchorOrigin:{vertical:"top",horizontal:"center"}},o.a.createElement(Pt.a,{elevation:6,variant:"filled",onClose:n,severity:"error"},t))},Bt=Object(r.createContext)({}),Dt=Object(r.memo)((function(e){var t=e.children,a=Object(r.useState)(!1),n=Object(s.a)(a,2),i=n[0],c=n[1],l=Object(r.useState)("An error occured. Please save your work and restart the app."),u=Object(s.a)(l,2),d=u[0],m=u[1],p=Object(r.useCallback)((function(){c(!1)}),[c]);return o.a.createElement(Bt.Provider,{value:{setAlertText:m,setOpenAlert:c}},o.a.createElement(Lt,{message:d,open:i,closeAlert:p}),t)})),Mt=function(){return Object(r.useContext)(Bt)},At=function(){var e=Mt(),t=e.setAlertText,a=e.setOpenAlert,n=X.a.get("pathwaysBackend"),o=Object(r.useState)([]),i=Object(s.a)(o,2),c=i[0],l=i[1],u=Object(_.d)("pathways",(function(){return fetch("".concat(n,"/pathway/")).then(function(){var e=Object(se.a)(ue.a.mark((function e(n){var r;return ue.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:if(r=e.sent,!n.ok){e.next=7;break}return e.abrupt("return",r);case 7:return console.error(n),t("Error loading pathways. Server returned ".concat(n.status)),a(!0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.error(e),t("Error loading pathways. Please restart the server and try again."),a(!0),[]}))})),d=u.isLoading,m=u.error,p=u.data;return Object(r.useEffect)((function(){m||d||l(p)}),[d,m,p]),{isLoading:d,error:m,pathways:c}},Ft=function(){var e=Mt(),t=e.setAlertText,a=e.setOpenAlert,n=X.a.get("pathwaysBackend"),o=Object(r.useState)([]),i=Object(s.a)(o,2),c=i[0],l=i[1],u=Object(_.d)("criteria",(function(){return fetch("".concat(n,"/criteria/")).then(function(){var e=Object(se.a)(ue.a.mark((function e(n){var r;return ue.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:if(r=e.sent,!n.ok){e.next=7;break}return e.abrupt("return",r);case 7:return console.error(n),t("Error loading criteria. Server returned ".concat(n.status)),a(!0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.error(e),t("Error loading criteria. Please restart the server and try again."),a(!0),[]}))})),d=u.isLoading,m=u.error,p=u.data;return Object(r.useEffect)((function(){m||d||l(p)}),[d,m,p]),{isLoading:d,error:m,criteria:c}},qt=a(1672),zt=a(1647),Wt=a(1648),_t=a(1649),Ht=a(1650),Gt=Object(U.a)((function(e){return{root:{display:"flex",padding:e.variables.spacing.globalPadding},modalHeader:{fontSize:"4em",fontWeight:600,margin:"-40px 0 10px",color:e.palette.common.blue},closeIcon:{width:"20px",height:"20px",padding:"20px"},modalText:{fontSize:"1.5em",color:e.palette.common.grayLighter,marginBottom:"40px"},submitButton:{fontSize:"1.3em",padding:"25px","& span":{fontFamily:["Roboto Condensed","sans-serif"].join(","),fontWeight:400,lineHeight:"0.2em"}}}}),{name:"Modal",index:1}),Ut=Object(r.memo)((function(e){var t=e.handleShowModal,a=e.handleCloseModal,n=e.handleSaveModal,r=e.headerTitle,i=e.headerSubtitle,c=e.footerText,l=void 0===c?"":c,u=e.hasSecondaryButton,s=void 0!==u&&u,p=e.submitButtonText,b=e.children,f=Gt();return o.a.createElement(qt.a,{open:t,onClose:a,fullWidth:!0,maxWidth:"sm"},o.a.createElement(zt.a,{disableTypography:!0},o.a.createElement(H.a,{"aria-label":"close",onClick:a,className:f.closeIcon},o.a.createElement(d.a,{icon:m.C}))),o.a.createElement(Wt.a,null,o.a.createElement("div",{className:f.modalHeader},r),o.a.createElement("div",{className:f.modalText},i),b&&b),o.a.createElement(_t.a,null,o.a.createElement("div",null,l),s&&o.a.createElement(Ht.a,{variant:"contained",onClick:a},"Cancel"),p&&void 0!==n&&o.a.createElement(Ht.a,{variant:"contained",color:"secondary",type:"submit",onClick:n,className:f.submitButton},p)))})),Kt=a(382),Qt=a.n(Kt),Vt=Object(r.memo)((function(){return o.a.createElement("div",{className:Qt.a.root},o.a.createElement(d.a,{icon:m.z,className:Qt.a.root,size:"4x",spin:!0}))})),Jt=function(e){var t=e.pathway,a=e.anchorEl,n=e.closeMenu,i=At().pathways,c=Ft().criteria,l=Object(r.useState)(!1),u=Object(s.a)(l,2),d=u[0],m=u[1],f=Object(r.useCallback)((function(){return m(!1)}),[m]),h=Object(r.useCallback)((function(e){t?(m(!0),lt(t,i,c,e).then((function(){return m(!1)}))):alert("No pathway to download!"),n()}),[t,i,c,m,n]),v=Object(r.useCallback)((function(){return h(!1)}),[h]),y=Object(r.useCallback)((function(){return h(!0)}),[h]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(p.a,{id:"pathway-options-menu",anchorEl:a,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,open:Boolean(a),onClose:n},o.a.createElement(b.a,{onClick:v},"Export Pathway",(null===t||void 0===t?void 0:t.length)&&t.length>1?"s":""),o.a.createElement(b.a,{onClick:y},"Export to CPG")),o.a.createElement(Ut,{handleShowModal:d,handleCloseModal:f,headerTitle:"Pathway Exporting",headerSubtitle:"Please wait while the pathway exports."},o.a.createElement(Vt,null)))},Yt=function(e){var t=e.anchorEl,a=e.closeMenu,n=ce().pathway;return o.a.createElement(Jt,{pathway:n?[n]:null,anchorEl:t,closeMenu:a})},$t=Object(r.memo)(Jt),Xt=function(){var e=v().resetCurrentCriteria,t=Object(r.useState)(null),a=Object(s.a)(t,2),n=a[0],i=a[1],c=ce(),l=c.pathway,p=c.canUndoPathway,b=c.canRedoPathway,f=c.undoPathway,h=c.redoPathway,y=K(),g=Object(u.g)(),E=Object(r.useCallback)((function(e){i(e.currentTarget)}),[]),C=Object(r.useCallback)((function(){i(null)}),[]),O=Object(r.useCallback)((function(){e(),g.push("/builder")}),[g,e]);return o.a.createElement("nav",{className:y.root},o.a.createElement("div",null,o.a.createElement(H.a,{className:y.backButton,onClick:O,"aria-label":"go back"},o.a.createElement(d.a,{icon:m.f,className:y.navigationIcons})),o.a.createElement("span",{className:y.pathwayName},null===l||void 0===l?void 0:l.name)),o.a.createElement("div",null,o.a.createElement(G.a,{placement:"top",title:"Undo",arrow:!0},o.a.createElement("span",null,o.a.createElement(H.a,{onClick:f,disabled:!p,"aria-label":"undo"},o.a.createElement(d.a,{icon:m.F,className:y.navigationIcons})))),o.a.createElement(G.a,{placement:"top",title:"Redo",arrow:!0},o.a.createElement("span",null,o.a.createElement(H.a,{onClick:h,disabled:!b,"aria-label":"redo"},o.a.createElement(d.a,{icon:m.x,className:y.navigationIcons})))),o.a.createElement(H.a,{onClick:E,"aria-controls":"pathway-options-menu","aria-haspopup":"true"},o.a.createElement(d.a,{icon:m.j,className:y.navigationIcons})),o.a.createElement(Yt,{anchorEl:n,closeMenu:C})))},Zt=Object(U.a)((function(e){return{root:{display:"flex",flexDirection:"column",padding:e.variables.spacing.globalPadding,color:e.palette.text.primary,backgroundColor:e.palette.common.gray,width:"33%",minWidth:"550px",overflowY:"scroll"},formControl:{margin:e.spacing(1,0),minWidth:375},referenceDropdown:{display:"flex"},referenceChevron:{fontSize:"2em",marginLeft:"1em",lineHeight:"2.5em",cursor:"pointer","&:hover":{color:e.palette.common.grayLightest}},divider:{width:"100%"},headerLabelStart:{cursor:"default"},displayText:{margin:"0 0 5px 0",fontWeight:900,fontSize:"1em"},sidebarHeader:{display:"flex",justifyContent:"space-between"},sidebarHeaderGroup:{display:"flex",alignItems:"center"},sidebarHeaderButton:{height:"45px",width:"45px",color:e.palette.text.primary},headerLabelGroup:{display:"flex",cursor:"pointer",height:"60px"},headerLabel:{display:"flex",alignItems:"center",fontSize:"1.6em",fontWeight:700,margin:"0 5px"},headerLabelText:{marginBottom:"5px"},editIcon:{fontSize:"0.6em",marginLeft:"10px"},sidebarButtonGroup:{display:"flex",margin:"10px 0"},sidebarButtonGroupExtraMargin:{display:"flex",margin:"20px 0 10px 0"},sidebarButton:{minWidth:180,marginRight:"20px"},sidebarButtonText:{fontStyle:"italic"},outlinedDiv:{display:"flex",flexDirection:"column",alignItems:"flex-start"},outlinedDivError:{borderColor:"".concat(e.palette.error.main," !important"),"&:hover":{borderColor:"".concat(e.palette.error.main," !important")}},toggleSidebar:{display:"inline-flex",alignItems:"center",justifyContent:"center",float:"left",width:"50px",minWidth:"50px",height:"50px",fontSize:"2em",backgroundColor:e.palette.primary.main,color:e.palette.text.primary,"&:hover":{cursor:"pointer"}},cancelButton:{alignSelf:"flex-end",marginTop:"5px",padding:"5px 15px",fontSize:"1em"},editButton:{marginLeft:"1em",alignSelf:"flex-end",marginTop:"5px",padding:"5px 15px",fontSize:"1em",backgroundColor:e.palette.primary.main,borderColor:e.palette.primary.main,"&:hover":{backgroundColor:e.palette.primary.main,borderColor:e.palette.primary.main}},buildCriteriaContainer:{display:"flex",justifyContent:"flex-end"},buildCriteriaText:{marginTop:"0.5em",marginBottom:"1em"},saveButton:{marginLeft:"1em",backgroundColor:e.palette.error.main,borderColor:e.palette.error.main,"&:hover":{backgroundColor:e.palette.error.main}},transitionContainer:{backgroundColor:e.palette.common.grayVeryDark,padding:"5px 15px",margin:"15px 0"},dividerHeader:{width:"100%",textTransform:"uppercase",borderBottom:"1px solid "+e.palette.common.blueLighter,color:e.palette.common.blueLighter,lineHeight:"0.1em",margin:"10px 0 20px",fontWeight:800,paddingLeft:"15px","& span":{background:e.palette.common.gray,padding:"0 10px"}},dialogCloseButton:{float:"right",width:"45px"},dialogContent:{color:e.palette.common.black,fontSize:"16px",display:"flex",marginTop:"-25px"},dialogContentText:{paddingLeft:"10px",lineHeight:"40px"},alertIcon:{color:e.palette.common.red,fontSize:"40px"},connectDropdown:{margin:"auto",display:"flex",flexDirection:"column",flexWrap:"nowrap",alignContent:"center"},connectText:{display:"flex",flexDirection:"row",alignItems:"center",fontSize:"0.95em",fontStyle:"italic"},cancelButtonDropdown:{marginLeft:"auto",border:"none",alignSelf:"center",color:e.palette.common.blueLighter,fontSize:"1em",fontStyle:"italic",textTransform:"none"},criteriaText:{width:"100%"}}}),{name:"Sidebar",index:1}),ea=a(1676),ta=a(1654),aa=a(1678),na=a(1669),ra=a(1667),oa=Object(r.memo)((function(e){var t=e.id,a=e.label,n=e.options,i=e.value,c=e.onChange,l=e.autocomplete,u=void 0===l||l,s=Object(r.useCallback)((function(e){c&&c(e.target.value||"")}),[c]),p=Object(r.useCallback)((function(e,t){c&&t&&c(t.value)}),[c]),f=function(e){return n.find((function(t){return t.value===e}))};return o.a.createElement(o.a.Fragment,null,u?o.a.createElement(ra.a,{fullWidth:!0,onChange:p,value:f(i)||null,popupIcon:o.a.createElement(d.a,{icon:m.c,style:{color:"white"}}),options:n,getOptionLabel:function(e){return e.label},renderOption:function(e){return o.a.createElement("div",{key:e.value,style:{color:"black"}},e.label)},renderInput:function(e){return o.a.createElement(ea.a,Object.assign({error:null==i||""===i},e,{variant:"outlined",label:a}))}}):o.a.createElement(ta.a,{variant:"outlined",fullWidth:!0},o.a.createElement(aa.a,{id:t,htmlFor:"".concat(t,"-select")},a),o.a.createElement(na.a,{id:"".concat(t,"-select"),value:i||"",onChange:s,label:a,error:null==i||""===i,MenuProps:{getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},displayEmpty:!0},n.map((function(e){return o.a.createElement(b.a,{key:e.value,value:e.value},e.label)})))))})),ia=Object(r.createContext)({}),ca=Object(r.memo)((function(e){var t=e.children,a=Object(r.useState)(!1),n=Object(s.a)(a,2),i=n[0],c=n[1],l=Object(r.useState)("Deleted Successfully"),u=Object(s.a)(l,2),d=u[0],m=u[1],p=Object(r.useCallback)((function(){c(!1)}),[c]);return o.a.createElement(ia.Provider,{value:{snackbarText:d,openSnackbar:i,handleCloseSnackbar:p,setSnackbarText:m,setOpenSnackbar:c}},t)})),la=function(){return Object(r.useContext)(ia)},ua=Object(r.memo)((function(){var e=ce().undoPathway,t=la(),a=t.snackbarText,n=t.openSnackbar,i=t.handleCloseSnackbar,c=Object(r.useCallback)((function(){e(),i()}),[e,i]);return o.a.createElement(Rt.a,{anchorOrigin:{vertical:"bottom",horizontal:"right"},open:n,autoHideDuration:1e4,onClose:i,message:a,action:o.a.createElement(o.a.Fragment,null,o.a.createElement(Ht.a,{color:"secondary",size:"small",onClick:c},"UNDO"),o.a.createElement(H.a,{size:"small","aria-label":"close",color:"inherit",onClick:i},o.a.createElement(d.a,{icon:m.C})))})})),sa=function(e){var t=Object(u.h)().nodeId,a=decodeURIComponent(t);return null===e||void 0===e?void 0:e.nodes[a]},da=Object(r.memo)((function(e){var t=e.currentNode,a=ce(),n=a.pathway,i=a.pathwayRef,c=a.setCurrentPathway,l=sa(i.current),u=Zt(),d=Object(r.useState)(!1),p=Object(s.a)(d,2),b=p[0],f=p[1],h=t&&n?Ie(n,t):[],v=h.length>0,y=Object(r.useCallback)((function(e){i.current&&l&&c(gt(i.current,l.key,e)),f(!1)}),[c,l,i]),g=Object(r.useCallback)((function(){f(!b)}),[b]);return o.a.createElement("div",null,!b&&o.a.createElement(ha,{buttonName:"Connect Node",buttonIcon:m.q,buttonText:"Create a transition to an existing node in the pathway.",onClick:g,disabled:!v,hasTooltip:!v,tooltipTitle:"There are no possible nodes to connect to."}),b&&v&&o.a.createElement("div",{className:u.connectDropdown},o.a.createElement(oa,{id:"transitions",label:"Node To Connect To",options:h,onChange:y}),o.a.createElement("div",{className:u.connectText},"Select node from list to add transition.",o.a.createElement(Ht.a,{className:u.cancelButtonDropdown,size:"small",variant:"text",onClick:g},"Cancel"))))})),ma=Object(r.memo)((function(e){var t=e.currentNode,a=ce(),n=a.pathway,i=a.pathwayRef,c=a.setCurrentPathway,l=sa(n),p=Object(r.useState)(!0),b=Object(s.a)(p,2),f=b[0],h=b[1],v=Zt(),y=Object(u.g)(),g=Object(r.useRef)(null),E=Object(r.useCallback)((function(){h(!f)}),[f]),C=Object(r.useCallback)((function(e){l&&i.current&&c(vt(i.current,l.key,e))}),[i,c,l]),O=Object(r.useCallback)((function(){if(l&&i.current){var e=pt(),t=bt(i.current,e);t=gt(t,l.key,e.key),c(t),Ee(l)||Te(i.current.id,e.key,y)}}),[i,c,l,y]);if(!n)return o.a.createElement("div",null,"Error: No pathway");if(!t)return o.a.createElement("div",null,"Error: No current node");if("start"===t.type)return o.a.createElement(o.a.Fragment,null,f&&o.a.createElement("div",{className:v.root,ref:g},o.a.createElement(fa,{node:t,isTransition:!1}),o.a.createElement("h5",{className:v.dividerHeader},o.a.createElement(o.a.Fragment,null)," "),o.a.createElement(ha,{buttonName:"Add Node",buttonIcon:m.u,buttonText:"Add a new transition to a new node in the pathway.",onClick:O})),o.a.createElement("div",{className:v.toggleSidebar,onClick:E},o.a.createElement(d.a,{icon:f?m.f:m.g})),o.a.createElement(ua,null));var j=ye(t),k="start"!==j||0===t.transitions.length;return o.a.createElement(o.a.Fragment,null,f&&o.a.createElement("div",{className:v.root,ref:g},o.a.createElement(fa,{node:t,isTransition:!1}),o.a.createElement("h5",{className:v.dividerHeader},o.a.createElement("span",null,"Details")),"null"===j&&o.a.createElement(oa,{id:"nodeType",label:"Node Type",options:Oe,onChange:C,value:""}),"reference"===j&&o.a.createElement(ga,{changeNodeType:C,currentNode:t}),"action"===j&&o.a.createElement(ya,{changeNodeType:C,currentNode:t}),"branch"===j&&o.a.createElement(oa,{id:"nodeType",label:"Node Type",options:Oe,onChange:C,value:"Observation"}),o.a.createElement("h5",{className:v.dividerHeader},o.a.createElement("span",null,"Transitions")),null===t||void 0===t?void 0:t.transitions.map((function(e){return o.a.createElement(Aa,{key:e.id,transition:e},"branch"===j&&o.a.createElement(Pa,{key:e.id,transition:e,currentNode:t}))})),k&&o.a.createElement(o.a.Fragment,null,o.a.createElement(ha,{buttonName:"Add New Node",buttonIcon:m.u,buttonText:"Add a new transition to a new node in the pathway.",onClick:O}),o.a.createElement(da,{currentNode:t}))),o.a.createElement("div",{className:v.toggleSidebar,onClick:E},o.a.createElement(d.a,{icon:f?m.f:m.g})),o.a.createElement(ua,null))})),pa=a(17),ba=a(1652),fa=Object(r.memo)((function(e){var t=e.node,a=e.isTransition,n=void 0!==a&&a,i=Object(r.useState)(!1),c=Object(s.a)(i,2),l=c[0],p=c[1],b=Object(r.useState)(!1),f=Object(s.a)(b,2),h=f[0],v=f[1],y=Object(r.useState)(!1),g=Object(s.a)(y,2),E=g[0],C=g[1],O=la(),j=O.setSnackbarText,k=O.setOpenSnackbar,w=ce(),x=w.pathway,N=w.pathwayRef,S=w.setCurrentPathway,T=sa(x),I=Object(r.useRef)(null),R=(null===t||void 0===t?void 0:t.label)||"",P=Zt(),L=Object(u.g)(),B=Object(r.useCallback)((function(){if(N.current){var e=ke(N.current.nodes,t.key);Te(N.current.id,e[0],L)}}),[L,N,t.key]),D=Object(r.useCallback)((function(){N.current&&Te(N.current.id,t.key,L)}),[L,N,t.key]),M=Object(r.useCallback)((function(){var e,a,n=null!==(e=null===(a=I.current)||void 0===a?void 0:a.value)&&void 0!==e?e:"";N.current&&S(ft(N.current,t.key,n)),p(!1)}),[N,S,t.key]),A=Object(r.useCallback)((function(){p(!0)}),[]),F=Object(r.useCallback)((function(){if(N.current&&Se(N.current,t.transitions)){var e=ke(N.current.nodes,t.key);S(St(N.current,t.key)),Te(N.current.id,e[0],L),C(!1),j("".concat(t.label," node deleted successfully")),k(!0)}}),[N,S,j,k,t.key,t.label,t.transitions,L]),q=Object(r.useCallback)((function(){T&&N.current&&!Ne(N.current,t.key)&&(S(It(N.current,T.key,t.key)),C(!1),j("Transition from ".concat(T.label," to ").concat(t.label," deleted successfully")),k(!0))}),[N,T,S,j,k,t]),z=Object(r.useCallback)((function(){C(!0)}),[]),W=Object(r.useCallback)((function(){C(!1)}),[]),_=Object(r.useCallback)((function(){v(!0)}),[]),U=Object(r.useCallback)((function(){v(!1)}),[]),K=Object(r.useCallback)((function(e){"Enter"===e.key&&M()}),[M]),Q=!x||!Se(x,t.transitions),V=!x||Ne(x,t.key),J=n?V:Q,Y=n?"Deleting this transition would result in an orphaned node. To delete, first add the child node as a transition to another node, or delete it directly.":"Deleting this node would result in an orphaned descendent node. To delete, first add another transition to the would-be orphaned node from another node, or delete it directly.";return o.a.createElement("div",{className:P.sidebarHeader},o.a.createElement("div",{className:P.sidebarHeaderGroup},"start"!==t.type&&!n&&o.a.createElement(H.a,{className:P.sidebarHeaderButton,onClick:B,"aria-label":"go to parent node"},o.a.createElement(d.a,{icon:m.f})),o.a.createElement("div",{className:P.headerLabelGroup,onClick:A},l&&"start"!==t.type?o.a.createElement(ta.a,{className:P.formControl,fullWidth:!0},o.a.createElement(ba.a,{className:P.headerLabel,type:"text",inputRef:I,onBlur:M,onKeyPress:K,defaultValue:R,autoFocus:!0,onFocus:function(e){return e.target.select()}})):o.a.createElement("div",{className:Object(pa.a)(P.headerLabel,P.headerLabelText,"start"===t.type&&P.headerLabelStart)},R,"Start"!==t.key&&o.a.createElement(d.a,{className:P.editIcon,icon:m.i})))),o.a.createElement("div",{className:P.sidebarHeaderGroup},"start"!==t.type&&o.a.createElement(G.a,{placement:"top",open:!!J&&h,onClose:U,onOpen:_,title:Y,arrow:!0},o.a.createElement("span",null,o.a.createElement(H.a,{className:P.sidebarHeaderButton,onClick:z,"aria-label":n?"delete transition":"delete node",disabled:J},o.a.createElement(d.a,{icon:m.E})))),n&&o.a.createElement(H.a,{className:P.sidebarHeaderButton,onClick:D,"aria-label":"go to transition node"},o.a.createElement(d.a,{icon:m.g}))),o.a.createElement(Da,{nodeLabel:t.label,isTransition:n,open:E,onDelete:n?q:F,onClose:W}))})),ha=Object(r.memo)((function(e){var t=e.buttonName,a=e.buttonIcon,n=e.buttonText,r=e.extraMargin,i=void 0!==r&&r,c=e.onClick,l=e.hasTooltip,u=void 0!==l&&l,s=e.tooltipTitle,m=void 0===s?"":s,p=e.disabled,b=void 0!==p&&p,f=e.buttonColor,h=void 0===f?"primary":f,v=Zt(),y=function(e){var t=e.children;return u?o.a.createElement(G.a,{title:m,placement:"top"},o.a.createElement("span",null,t)):o.a.createElement(o.a.Fragment,null,t)};return o.a.createElement("div",{className:i?v.sidebarButtonGroupExtraMargin:v.sidebarButtonGroup},o.a.createElement(y,null,o.a.createElement(Ht.a,{className:v.sidebarButton,variant:"contained",color:h,startIcon:o.a.createElement(d.a,{icon:a}),onClick:c,disabled:b},t)),o.a.createElement("div",{className:v.sidebarButtonText},n))})),va=[{label:"ICD-9-CM",value:"http://hl7.org/fhir/sid/icd-9-cm"},{label:"ICD-10-CM",value:"http://hl7.org/fhir/sid/icd-10-cm"},{label:"LOINC",value:"http://loinc.org"},{label:"NCI",value:"http://ncimeta.nci.nih.gov"},{label:"RXNORM",value:"http://www.nlm.nih.gov/research/umls/rxnorm"},{label:"SNOMED",value:"http://snomed.info/sct"}],ya=Object(r.memo)((function(e){var t=e.changeNodeType,a=e.currentNode,i=ce(),c=i.pathwayRef,l=i.setCurrentPathway,u=sa(c.current),s=Zt(),p=Object(r.useCallback)((function(e){if(u.action&&c.current){var t=(null===e||void 0===e?void 0:e.target.value)||"",a=Ot(u.action,t);l(yt(c.current,u.key,y(a)))}}),[u,c,l]),b=Object(r.useCallback)((function(e){if(u.action&&c.current){var t=(null===e||void 0===e?void 0:e.target.value)||"",a=kt(u.action,t);l(yt(c.current,u.key,a))}}),[u,c,l]),f=Object(r.useCallback)((function(e){if(u.action&&c.current){var t=(null===e||void 0===e?void 0:e.target.value)||"",a=wt(u.action,t),n=yt(c.current,u.key,y(a));l(n)}}),[u,c,l]),h=Object(r.useCallback)((function(e){if(u.action&&c.current){var t=jt(u.action,e);l(yt(c.current,u.key,y(t)))}}),[u,c,l]),v=Object(r.useCallback)((function(){var e=u;if(e.action&&c.current){var t=xt(e.action,"Example Text"),a=yt(c.current,e.key,t);l(a)}else console.error("No Actions -- Cannot Validate")}),[u,c,l]),y=function(e){return Object(n.a)(e,(function(e){e.resource.medicationCodeableConcept?e.resource.medicationCodeableConcept.coding[0].display="":"CarePlan"===e.resource.resourceType?e.resource.description="":e.resource.code.coding[0].display=""}))},g=function(e){"Enter"===e.key&&v()},E=a.action;if(!E)return o.a.createElement(o.a.Fragment,null);var C=(null===a||void 0===a?void 0:a.key)&&"start"!==a.type,O=E.resource,j="",k="",w="";return"MedicationRequest"===O.resourceType||"ServiceRequest"===O.resourceType?(j=O.code?O.code.coding[0].system:O.medicationCodeableConcept.coding[0].system,k=O.code?O.code.coding[0].code:O.medicationCodeableConcept.coding[0].code,w=O.code?O.code.coding[0].display:O.medicationCodeableConcept.coding[0].display):w=O.description,o.a.createElement(o.a.Fragment,null,C&&o.a.createElement(o.a.Fragment,null,o.a.createElement(oa,{id:"nodeType",label:"Node Type",options:Oe,onChange:t,value:O.resourceType}),("MedicationRequest"===O.resourceType||"ServiceRequest"===O.resourceType)&&o.a.createElement(o.a.Fragment,null,o.a.createElement(oa,{id:"codeSystem",label:"Code System",options:va,onChange:h,value:j}),j&&o.a.createElement(ea.a,{id:"code-input",label:"Code",value:k,onChange:p,variant:"outlined",error:""===k,inputProps:{onKeyPress:g}}),k&&o.a.createElement(o.a.Fragment,null,w?o.a.createElement("div",{className:s.displayText},o.a.createElement(d.a,{icon:m.e})," ",w):o.a.createElement(ha,{buttonName:"Validate",buttonIcon:m.e,buttonText:w||"Check validation of the input system and code",onClick:v}),o.a.createElement(ea.a,{id:"description-input",label:"Description",value:E.description||"",onChange:b,variant:"outlined",error:""===E.description}))),"CarePlan"===O.resourceType&&o.a.createElement(o.a.Fragment,null,o.a.createElement(ea.a,{id:"title-input",label:"Title",value:O.title||"",onChange:f,variant:"outlined",error:null==O.title,inputProps:{onKeyPress:g}}),O.title&&o.a.createElement(ea.a,{id:"description-input",label:"Description",value:E.description||"",onChange:b,variant:"outlined",error:""===E.description}))))})),ga=Object(r.memo)((function(e){var t=e.changeNodeType,a=e.currentNode,n=Object(u.g)(),i=At(),c=i.isLoading,l=i.pathways,s=ce(),p=s.pathway,b=s.pathwayRef,f=s.setCurrentPathway,h=sa(p),v=l.map((function(e){return{label:e.name,value:e.id}})),y=Zt(),g=Object(r.useCallback)((function(){var e=a.referenceId,t=l.find((function(t){return t.id===e}));t&&f(t)}),[a,l,f]),E=Object(r.useCallback)((function(e){var t,a=(null===(t=v.find((function(t){return t.value===e})))||void 0===t?void 0:t.label)||"";h&&b.current&&f(ht(b.current,h.key,e,a))}),[h,v,b,f]),C=(null===a||void 0===a?void 0:a.key)&&"start"!==a.type;return o.a.createElement(o.a.Fragment,null,C&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",null,o.a.createElement(oa,{id:"nodeType",label:"Node Type",options:Oe,onChange:t,value:"Reference"}),o.a.createElement("div",{className:y.referenceDropdown},o.a.createElement(oa,{id:"reference",label:"Pathway Reference",options:v,onChange:E,value:c?"":a.referenceId}),o.a.createElement("div",{className:y.referenceChevron},o.a.createElement(d.a,{icon:m.g,onClick:function(){g(),Te(a.referenceId,"",n)}}))))))})),Ea=a(1655),Ca=a(1666),Oa=a(1670),ja=Object(r.createContext)({}),ka=Object(r.memo)((function(e){var t=e.children,a=Object(r.useState)(""),n=Object(s.a)(a,2),i=n[0],c=n[1],l=Object(r.useState)(""),u=Object(s.a)(l,2),d=u[0],m=u[1],p=Object(r.useState)(""),b=Object(s.a)(p,2),f=b[0],h=b[1],v=Object(r.useState)(0),y=Object(s.a)(v,2),g=y[0],E=y[1],C=Object(r.useState)(0),O=Object(s.a)(C,2),j=O[0],k=O[1],w=Object(r.useCallback)((function(){c(""),m(""),h(""),E(0),k(0)}),[c,m,h,E,k]),x=Object(r.useCallback)((function(e){c("Demographics"),"gender"===e.type?(m("Gender"),h(e.gender)):(m("Age Range"),E(e.min),k(e.max))}),[]);return o.a.createElement(ja.Provider,{value:{selectedElement:i,selectedDemoElement:d,gender:f,minimumAge:g,maximumAge:j,setSelectedElement:c,setSelectedDemoElement:m,setGender:h,setMinimumAge:E,setMaximumAge:k,resetCriteriaBuilder:w,setCriteriaBuilder:x}},t)})),wa=function(){return Object(r.useContext)(ja)},xa=a(304),Na=a(1139),Sa=["Patient","MeetsInclusionCriteria","InPopulation","Recommendation","Rationale","Errors"];function Ta(e,t){var a,n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!(null===(a=e.library)||void 0===a||null===(n=a.identifier)||void 0===n?void 0:n.id))return[];var i=e.library.statements.def,c=i.filter((function(e){return!Sa.includes(e.name)})),l=!!i.find((function(e){return e.resultTypeName}));if(l&&(c=c.filter((function(e){return"{urn:hl7-org:elm-types:r1}Boolean"===e.resultTypeName&&"FunctionDef"!==e.type}))),!c)return alert("No statement found in that file"),[];var u=o?"Criteria Builder (".concat(e.library.identifier.id.substring(0,5),")"):e.library.identifier.id;return c.map((function(a){return Object(g.a)({id:me.a.generate(),label:"".concat(u,": ").concat(a.name),display:a.name,version:e.library.identifier.version,modified:Date.now(),cql:t,statement:a.name},r&&{cqlLibraries:r})}))}function Ia(e){return"string"===typeof e?function(e){return et.convertBasicCQL(e)}(e).then((function(t){return Ta(t,e)})):tt(e).then((function(t){return Object.keys(t).forEach((function(a){var n=e[a],r=t[a];n&&(n.version=r.library.identifier.version)})),Object.keys(t).map((function(a){e[a];var n=Object(xa.a)(e,[a].map(Na.a));return Ta(t[a],e[a].cql,n)})).flat(1)}))}function Ra(e,t,a){return Ia(function(e,t,a){var n=null!==a&&void 0!==a?a:"cql".concat(me.a.generate().replace(/-/g,"a"));return"library ".concat(n," version '1'\nusing FHIR version '4.0.1'\ncontext Patient\n\n    define \"").concat(t,'":\n').concat(e)}(e.cql,t,a)).then((function(t){var a=t[0];return a.builder=e,a}))}var Pa=Object(r.memo)((function(e){var t,a,n,i,c,l,u,p,b,f,h,y=e.transition,g=(e.currentNode,Zt()),E=Ft().criteria,C=Object(r.useRef)(y),O=v(),j=O.buildCriteriaSelected,k=O.setBuildCriteriaSelected,w=O.currentCriteriaNodeId,x=O.setCurrentCriteriaNodeId,N=O.currentCriteria,S=O.setCurrentCriteria,T=O.criteriaName,I=O.setCriteriaName,R=O.resetCurrentCriteria,P=wa(),L=P.resetCriteriaBuilder,B=P.setCriteriaBuilder,D=ce(),M=D.pathwayRef,A=D.setCurrentPathway,F=Object(r.useState)(!1),q=Object(s.a)(F,2),z=q[0],W=q[1],_=Object(r.useState)(!1),H=Object(s.a)(_,2),G=H[0],U=H[1],K=sa(M.current),Q=Object(r.useMemo)((function(){return E.map((function(e){return{value:e.id,label:e.label}}))}),[E]),V=Q.length>0,J=V&&(G||(null===(t=y.condition)||void 0===t?void 0:t.cql)||(null===(a=y.condition)||void 0===a?void 0:a.description)),Y=null===(n=y.condition)||void 0===n?void 0:n.description,$=null!=Y,X=Y&&""!==Y,Z=(null===(i=y.condition)||void 0===i?void 0:i.cql)||(null===(c=y.condition)||void 0===c?void 0:c.description),ee=Z?"DELETE":"CANCEL",te=Z?o.a.createElement(d.a,{icon:m.E}):null,ae=j&&w===y.id,re=null;y.condition&&((null===(h=f=E.find((function(e){var t;return e.id===(null===(t=y.condition)||void 0===t?void 0:t.criteriaSource)})))||void 0===h?void 0:h.builder)&&(re=f.builder));var oe=!ae&&re,ie=Object(r.useCallback)((function(){Z&&K&&M.current?(A(Tt(M.current,K.key,y.id)),U(!1)):U(!G)}),[G,K,M,Z,y.id,A]),le=Object(r.useCallback)((function(e){var t;if(K&&M.current){var a=E.find((function(t){return t.id===e}));if(a){var n=Et(M.current,K.key,C.current.id,(null===(t=C.current.condition)||void 0===t?void 0:t.description)||a.display,a);A(n)}}}),[K,A,M,C,E]),ue=Object(r.useCallback)((function(e){if(K&&M.current){var t=(null===e||void 0===e?void 0:e.target.value)||"";A(Ct(M.current,K.key,y.id,t))}}),[K,y.id,A,M]),se=Object(r.useCallback)((function(e){I((null===e||void 0===e?void 0:e.target.value)||"")}),[I]),de=Object(r.useCallback)((function(){x(y.id),S(null),I(""),j||k(!0),L()}),[j,x,y,k,S,L,I]),me=Object(r.useCallback)((function(){var e,t;x(y.id),S(re),(null===(e=f)||void 0===e?void 0:e.label)&&I(null===(t=f)||void 0===t?void 0:t.label),j||k(!0),re&&B(re)}),[j,f,re,y,x,S,I,k,B]),pe=Object(r.useCallback)((function(){R(),L()}),[R,L]),be=Object(r.useCallback)((function(){var e,t,a,n;K&&M.current&&(null===N||void 0===N?void 0:N.cql)&&(W(!0),(t=N,a=T,n=null===(e=y.condition)||void 0===e?void 0:e.criteriaSource,Ra(t,a,n).then((function(e){return ne(e),e}))).then((function(e){var t=Et(M.current,K.key,C.current.id,T,e);A(t),pe(),W(!1)})))}),[K,A,M,C,N,T,y,pe,W]);return o.a.createElement(o.a.Fragment,null,!J&&!ae&&o.a.createElement(ha,{buttonName:"Select Criteria",buttonIcon:m.B,buttonColor:"secondary",buttonText:"Add previously built or imported criteria logic to branch node.",onClick:ie,disabled:!V,hasTooltip:!V,tooltipTitle:"No criteria to select. Add criteria to use."}),J&&!ae&&!oe&&o.a.createElement(Ba,{label:"Criteria Selector",error:!$||!X},o.a.createElement(o.a.Fragment,null,o.a.createElement(oa,{id:"Criteria",label:"Criteria",options:Q,onChange:le,value:(null===(l=y.condition)||void 0===l?void 0:l.criteriaSource)||void 0}),o.a.createElement(ea.a,{label:"Criteria Display",className:g.criteriaText,value:(null===(u=y.condition)||void 0===u?void 0:u.description)||"",variant:"outlined",onChange:ue,error:!X,helperText:'Use commas "," to separate into multiple lines (up to 3)'})),o.a.createElement(Ht.a,{className:g.cancelButton,color:"inherit",size:"small",variant:"outlined",startIcon:te,onClick:ie},ee)),oe&&o.a.createElement(Ba,{label:"Criteria Builder",error:!1},o.a.createElement(ea.a,{label:"Criteria Name",variant:"outlined",value:null===(p=f)||void 0===p?void 0:p.label,fullWidth:!0,disabled:!0}),o.a.createElement("span",{className:g.buildCriteriaText},null===(b=re)||void 0===b?void 0:b.text),o.a.createElement("div",{className:g.buildCriteriaContainer},o.a.createElement(Ht.a,{className:g.cancelButton,color:"inherit",size:"small",variant:"outlined",startIcon:te,onClick:ie},"DELETE CRITERIA"),o.a.createElement(Ht.a,{className:g.editButton,color:"inherit",size:"small",variant:"outlined",startIcon:o.a.createElement(d.a,{icon:m.i}),onClick:me},"EDIT CRITERIA"))),!J&&!ae&&o.a.createElement(ha,{buttonName:"Build Criteria",buttonColor:"secondary",buttonIcon:m.D,buttonText:"Create new criteria logic to add to branch node.",extraMargin:!0,onClick:de}),ae&&o.a.createElement(Ba,{label:"Criteria Builder",error:!$||!X},o.a.createElement(ea.a,{error:""===T,label:"Criteria Name",variant:"outlined",onChange:se,value:T,fullWidth:!0}),(null===N||void 0===N?void 0:N.text)&&o.a.createElement("span",{className:g.buildCriteriaText},N.text),o.a.createElement("div",{className:g.buildCriteriaContainer},o.a.createElement(Ea.a,{label:o.a.createElement(Ca.a,{fontStyle:"italic"},"Add to reusable criteria"),control:o.a.createElement(Oa.a,{color:"default"}),checked:!0}),o.a.createElement(Ht.a,{color:"inherit",size:"large",variant:"outlined",onClick:pe},"Cancel"),o.a.createElement(Ht.a,{className:g.saveButton,color:"inherit",size:"large",variant:"outlined",startIcon:o.a.createElement(d.a,{icon:m.y}),endIcon:z?o.a.createElement(d.a,{icon:m.z,spin:!0}):null,disabled:""===T||null===N||z,onClick:be},"Save"))))})),La=function(e){var t=e.children;return o.a.createElement(o.a.Fragment,null,t)},Ba=function(e){var t=e.children,a=e.label,n=e.error,r=Zt();return o.a.createElement(ea.a,{variant:"outlined",label:a,multiline:!0,InputLabelProps:{shrink:!0},InputProps:{inputComponent:La,classes:{root:Object(pa.a)(r.outlinedDiv,n&&r.outlinedDivError),notchedOutline:Object(pa.a)(n&&r.outlinedDivError)}},inputProps:{children:t},fullWidth:!0})},Da=Object(r.memo)((function(e){var t=e.open,a=e.nodeLabel,n=e.isTransition,r=e.onClose,i=e.onDelete,c=Zt(),l=ce().pathway,u=sa(l),s=n?o.a.createElement("span",null,"Delete the transition from ",o.a.createElement("strong",null,null===u||void 0===u?void 0:u.label)," to"," ",o.a.createElement("strong",null,a),"? This will not delete either node, just the transition between them."):o.a.createElement("span",null,"Delete the node ",o.a.createElement("strong",null,a),"? This will also remove any transitions to this node.");return o.a.createElement(o.a.Fragment,null,o.a.createElement(qt.a,{open:t,onClose:r,"aria-labelledby":"create-pathway",fullWidth:!0,maxWidth:"md"},o.a.createElement(zt.a,{disableTypography:!0},o.a.createElement(H.a,{"aria-label":"close",onClick:r,className:c.dialogCloseButton},o.a.createElement(d.a,{icon:m.C}))),o.a.createElement(Wt.a,{className:c.dialogContent},o.a.createElement(d.a,{icon:m.l,className:c.alertIcon}),o.a.createElement("p",{className:c.dialogContentText},s)),o.a.createElement(_t.a,null,o.a.createElement(Ht.a,{variant:"text",color:"primary",onClick:r},"Cancel"),o.a.createElement(Ht.a,{variant:"contained",color:"secondary",onClick:i},"Delete"))))})),Ma=a(1656),Aa=Object(r.memo)((function(e){var t=e.transition,a=e.children,n=Zt(),r=ce().pathway,i=(null===t||void 0===t?void 0:t.transition)||"",c=null===r||void 0===r?void 0:r.nodes[i];return o.a.createElement(Ma.a,{raised:!0,className:n.transitionContainer},c&&o.a.createElement(fa,{node:c,isTransition:!0}),a)})),Fa=a(1673),qa=a(1680),za=a(383),Wa=a.n(za),_a=function(){var e=Object(r.useState)({nodes:{},edges:{}}),t=Object(s.a)(e,2),a=t[0],n=t[1];return{coordinates:a,updateCoordinates:Object(r.useCallback)((function(e){var t,a=e.graph,r=e.graphWidth,o=0-a.node("Start").x+r/2,i=0,c={nodes:{},edges:{}},l=Object(be.a)(a.nodes());try{for(l.s();!(t=l.n()).done;){var u=t.value,s=a.node(u);c.nodes[u]=Object(g.a)({},s,{x:s.x-s.width/2+o,y:s.y-s.height/2+16}),i=Math.min(0,i,c.nodes[u].x)}}catch(O){l.e(O)}finally{l.f()}if((i=Math.abs(i))>0){var d,m=Object(be.a)(a.nodes());try{for(m.s();!(d=m.n()).done;){var p=d.value;c.nodes[p].x+=i}}catch(O){m.e(O)}finally{m.f()}}var b,f=Object(be.a)(a.edges());try{for(f.s();!(b=f.n()).done;){var h=b.value,v=a.edge(h),y="".concat(h.v,", ").concat(h.w),E=v.label?{text:v.label,x:v.x+o,y:v.y+16}:null,C=v.points.map((function(e){return{x:(isNaN(e.x)?0:e.x)+o+i,y:(isNaN(e.y)?0:e.y)+16}}));C.length>0&&(C[C.length-1].y-=17.5),c.edges[y]={label:E,start:h.v,end:h.w,points:C}}}catch(O){f.e(O)}finally{f.f()}n(c)}),[])}},Ha=Object(r.createContext)({}),Ga=Object(r.createContext)((function(){})),Ua=Object(r.createContext)({nodes:{},edges:{}}),Ka=function(){var e=new Wa.a.graphlib.Graph;return e.setGraph({}),e.setDefaultEdgeLabel((function(){return{}})),e},Qa=function(e){var t=e.children,a=Object(r.useMemo)(Ka,[]),n=_a(),i=n.coordinates,c=n.updateCoordinates,l=Object(Fa.a)(0),u=Object(s.a)(l,2),d=u[0],m=u[1],p=Object(r.useState)(!0),b=Object(s.a)(p,2),f=b[0],h=b[1],v=Object(r.useCallback)((function(){return h(!0)}),[]),y=Object(r.useMemo)((function(){return{graph:a,reflow:v}}),[a,v]);return Object(r.useEffect)((function(){f&&(Wa.a.layout(a),c({graph:a,graphWidth:d}),h(!1))}),[a,f,h,d,c]),Object(qa.a)((function(){h(!0)}),[d]),o.a.createElement(Ha.Provider,{value:y},o.a.createElement(Ga.Provider,{value:m},o.a.createElement(Ua.Provider,{value:i},t)))},Va=function(){return Object(r.useContext)(Ha)},Ja=function(){return Object(r.useContext)(Ua)},Ya=Object(U.a)((function(e){return{edges:{display:"block",position:"absolute",top:"0",left:"0",overflow:"visible",width:"100%",height:"100%",zIndex:1,"& text":{fontSize:"14px"},"& #arrowhead-inactive polygon":{fill:e.palette.common.blue},"& #arrowhead-active polygon":{fill:e.palette.common.red}},edge:{stroke:function(t){return e.palette.common[(null===t||void 0===t?void 0:t.isActive)?"red":"blue"]}}}}),{name:"DagreGraph-GraphEdges"}),$a=function(e){var t=e.labelText,a=e.isEnabled,n=e.children;return a&&t?o.a.createElement(G.a,{title:t,children:n}):o.a.createElement(o.a.Fragment,null,n)},Xa=function(e){var t=e.label,a=e.points,n=e.isActive,i=Ya({isActive:n}),c=Object(r.useMemo)((function(){return function(e){return e.reduce((function(t,a,n){return n%3===e.length%3?"".concat(t," C ").concat(a.x," ").concat(a.y," ").concat(e[n+1].x," ").concat(e[n+1].y," ").concat(e[n+2].x," ").concat(e[n+2].y):t}),"M ".concat(e[0].x," ").concat(e[0].y," "))}(a)}),[a]),l=null===t||void 0===t?void 0:t.text,u=Object(r.useMemo)((function(){if(null==l)return{lines:[],isTruncated:!1};var e=!1,t=l.split(",");return{lines:(t.length>3?[t[0],t[1],t.slice(2).join(",")]:t).map((function(t){var a=t.trim();return a.length>20?(e=!0,"".concat(a.substring(0,19),"...")):a})),isTruncated:e}}),[l]),s=u.lines,d=u.isTruncated;return o.a.createElement(o.a.Fragment,null,o.a.createElement("path",{d:c,fill:"transparent",className:i.edge,strokeWidth:"2",markerEnd:"url(#arrowhead-".concat(n?"active":"inactive",")")}),t&&o.a.createElement($a,{labelText:l,isEnabled:d},o.a.createElement("text",{x:t.x,y:t.y,dy:"0"},s.map((function(e,a){return o.a.createElement("tspan",{x:t.x,dy:0===a?0:"1.2em",key:e},e)})))))},Za=Object(r.memo)((function(e){var t=e.currentNode,a=Ya(),n=Ja().edges;return o.a.createElement("svg",{className:a.edges},o.a.createElement("defs",null,o.a.createElement("marker",{id:"arrowhead-inactive",markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto"},o.a.createElement("polygon",{points:"0 0, 10 3.5, 0 7"})),o.a.createElement("marker",{id:"arrowhead-active",markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto"},o.a.createElement("polygon",{points:"0 0, 10 3.5, 0 7"}))),Object.entries(n).map((function(e){var a=Object(s.a)(e,2),n=a[0],r=a[1];return o.a.createElement(Xa,{key:n,label:r.label,points:r.points,isActive:r.start===(null===t||void 0===t?void 0:t.key)})})))})),en=a(1657),tn=Object(U.a)((function(e){return{table:{"& tr":{verticalAlign:"top"}},title:{fontWeight:"bold",textAlign:"right",minWidth:"80px"},description:{paddingLeft:e.spacing(2),fontStyle:"italic",overflowWrap:"break-word"},externalLink:{color:e.palette.common.blue,marginLeft:e.spacing(1),"&:hover, &:focus":{color:e.palette.common.grayDark}}}}),{name:"NodeDetails"}),an=function(e){var t=e.title,a=e.description,n=tn();return a?o.a.createElement("tr",null,o.a.createElement("td",{className:n.title},t),o.a.createElement("td",{className:n.description},a)):null},nn=function(){return o.a.createElement(an,{title:"Type",description:"Observation"})},rn=function(e){var t,a,n,r,i,c=e.actionNode,l=tn();if(null===c.action)return null;var u=c.action.resource,s=void 0!==u.medicationCodeableConcept?null===u||void 0===u||null===(t=u.medicationCodeableConcept)||void 0===t?void 0:t.coding:null===u||void 0===u||null===(a=u.code)||void 0===a?void 0:a.coding,p=Ce[u.resourceType]?Ce[u.resourceType]:u.resourceType;return o.a.createElement(o.a.Fragment,null,o.a.createElement(an,{title:"Description",description:c.action.description}),o.a.createElement(an,{key:"Type",title:"Type",description:p}),o.a.createElement(an,{key:"System",title:"System",description:(null===s||void 0===s||null===(n=s[0])||void 0===n?void 0:n.system)&&o.a.createElement(o.a.Fragment,null,s[0].system,o.a.createElement("a",{href:s[0].system,target:"_blank",rel:"noopener noreferrer"},o.a.createElement(d.a,{icon:m.m,className:l.externalLink})))}),o.a.createElement(an,{key:"Code",title:"Code",description:null===s||void 0===s||null===(r=s[0])||void 0===r?void 0:r.code}),o.a.createElement(an,{key:"Display",title:"Display",description:null===s||void 0===s||null===(i=s[0])||void 0===i?void 0:i.display}),o.a.createElement(an,{key:"Title",title:"Title",description:u.title}))},on=function(e){var t=e.referenceNode;return o.a.createElement(o.a.Fragment,null,o.a.createElement(an,{title:"Type",description:"Reference"}),o.a.createElement(an,{title:"Pathway",description:t.referenceLabel}))},cn=Object(r.memo)((function(e){var t=e.pathwayNode,a=tn(),n=ye(t);return null==n?null:o.a.createElement("table",{className:a.table},o.a.createElement("tbody",null,"branch"===n&&o.a.createElement(nn,null),"reference"===n&&o.a.createElement(on,{referenceNode:t}),"action"===n&&o.a.createElement(rn,{actionNode:t})))})),ln=Object(U.a)((function(e){return{icon:{marginRight:e.spacing(1),fontSize:"0.9rem"}}}),{name:"DagreGraph-NodeIcon"}),un=Object(r.memo)((function(e){var t,a=e.isStartNode,n=e.nodeType,r=e.resourceType,i=ln();return a?t=m.t:"action"===n&&r?"MedicationRequest"===r?t=m.v:"ServiceRequest"===r?t=m.A:"CarePlan"===r&&(t=m.a):"branch"===n?t=m.s:"reference"===n&&(t=m.q),t?o.a.createElement(d.a,{icon:t,className:i.icon}):null})),sn=Object(U.a)((function(e){return{node:{position:"absolute",width:"auto",minWidth:function(e){return e.isExpanded?"400px":"100px"},maxWidth:"600px",minHeight:"50px",display:"flex",alignItems:"stretch",flexDirection:"column",border:function(t){var a=t.isActionable;return"1px solid ".concat(e.palette.common[a?"red":"blue"])},backgroundColor:e.palette.common.white,zIndex:2,overflow:"hidden"},nodeTitle:{padding:e.spacing(2),flex:"1",display:"flex",alignItems:"center",justifyContent:"center",color:e.palette.common.white,backgroundColor:function(t){var a=t.isActionable;return e.palette.common[a?"red":"blue"]}},nodeContent:{padding:e.spacing(2)},clickable:{cursor:"pointer"}}}),{name:"DagreGraph-Node"}),dn=function(e){var t=e.condition;return t?{label:t.description,width:25,height:20}:{}},mn=function(e){var t,a=null!==(t=null===e||void 0===e?void 0:e.getBoundingClientRect())&&void 0!==t?t:{width:0,height:0};return{width:Math.ceil(a.width),height:Math.ceil(a.height)}},pn=Object(r.memo)((function(e){var t,a=e.nodeKey,n=e.pathwayNode,i=e.isActionable,c=e.isExpanded,l=e.onClick,u=e.xCoordinate,s=e.yCoordinate,d=e.openNode,m=sn({isExpanded:c,isActionable:i}),p=Object(r.useCallback)((function(){l&&l(a)}),[l,a]),b=Object(r.useRef)(null),f=Va(),h=f.graph,v=f.reflow,y=Object(r.useMemo)((function(){return{top:"".concat(s,"px"),left:"".concat(u,"px")}}),[u,s]),E=ye(n),C=n.action,O=n.label,j=n.transitions;return Object(en.a)((function(){var e=mn(b.current),t=e.width,n=e.height;h.setNode(a,{width:t,height:n}),j.forEach((function(e){h.setEdge(a,e.transition,dn(e))}))}),(function(){h.removeNode(a)})),Object(qa.a)((function(){if(b.current){var e=mn(b.current),t=e.width,n=e.height,r=h.node(a);r.width===t&&r.height===n||(h.setNode(a,Object(g.a)({},r,{width:t,height:n})),v())}})),Object(qa.a)((function(){var e,t=new Set(j.map((function(e){return e.transition})));null===(e=h.outEdges(a))||void 0===e||e.forEach((function(e){var n=e.w;t.has(n)||h.removeEdge(a,n)})),j.forEach((function(e){h.setEdge(a,e.transition,dn(e))})),v()}),[a,j]),Object(qa.a)((function(){C&&d(a)}),[C,a]),o.a.createElement("div",{className:m.node,style:y,ref:b},o.a.createElement("div",{className:Object(pa.a)(m.nodeTitle,l&&m.clickable),onClick:p},o.a.createElement(un,{resourceType:C?null===(t=C.resource)||void 0===t?void 0:t.resourceType:void 0,nodeType:E,isStartNode:"start"===n.type}),O),c&&o.a.createElement("div",{className:m.nodeContent},o.a.createElement(cn,{pathwayNode:n})))})),bn=a(170),fn=function(){var e=Object(r.useState)({lastSelectedNode:null}),t=Object(s.a)(e,2),a=t[0],n=t[1];return{expanded:a,toggleExpanded:Object(r.useCallback)((function(e){n("Start"===e?function(t){return Object(g.a)({},t,{lastSelectedNode:e})}:function(t){var a;return Object(g.a)({},t,(a={},Object(bn.a)(a,e,t[e]&&t.lastSelectedNode!==e?t[e]:!t[e]),Object(bn.a)(a,"lastSelectedNode",e),a))})}),[]),openNode:Object(r.useCallback)((function(e){n((function(t){var a;return t[e]&&t.lastSelectedNode===e?t:Object(g.a)({},t,(a={},Object(bn.a)(a,e,!0),Object(bn.a)(a,"lastSelectedNode",e),a))}))}),[]),closeNode:Object(r.useCallback)((function(e){n((function(t){return t[e]?Object(g.a)({},t,Object(bn.a)({},e,!1)):t}))}),[])}},hn=function(){var e=Object(u.h)().id,t=Object(u.g)();return Object(r.useCallback)((function(a){var n="/builder/".concat(encodeURIComponent(e),"/node/").concat(encodeURIComponent(a));n!==t.location.pathname&&t.push(n)}),[t,e])},vn=Object(r.memo)((function(e){var t,a=e.interactive,n=e.currentNode,i=ce().pathway,c=fn(),l=c.expanded,u=c.toggleExpanded,d=c.openNode,m=Va().reflow,p=Ja().nodes,b=hn(),f=v().resetCurrentCriteria,h=Object(r.useCallback)((function(e){b(e),u(e),f()}),[b,u,f]),y=Object.entries(null!==(t=null===i||void 0===i?void 0:i.nodes)&&void 0!==t?t:{});return Object(qa.a)((function(){m()}),[y.length]),o.a.createElement(o.a.Fragment,null,y.map((function(e){var t,r=Object(s.a)(e,2),i=r[0],c=r[1],u=null!==(t=p[i])&&void 0!==t?t:{x:-999,y:-999};return o.a.createElement(pn,{key:i,nodeKey:i,pathwayNode:c,isActionable:c.key===(null===n||void 0===n?void 0:n.key),isExpanded:Boolean(l[i]),onClick:a?h:void 0,xCoordinate:u.x,yCoordinate:u.y,openNode:d})})))})),yn=a(1129),gn=a.n(yn),En=Object(U.a)({root:{position:"relative",minWidth:"100%",minHeight:"100%"}},{name:"DagreGraph-GraphRoot"}),Cn=function(e){var t=e.children,a=En(),n=Object(r.useRef)(null),i=Object(r.useContext)(Ga),c=Ja().nodes,l=Object(r.useMemo)((function(){return Math.ceil(150+(void 0!==c?Object.values(c).map((function(e){return e.x+e.width})).reduce((function(e,t){return Math.max(e,t)}),0):0))}),[c]),u=Object(r.useMemo)((function(){return Math.ceil(150+(void 0!==c?Object.values(c).map((function(e){return e.y+e.height})).reduce((function(e,t){return Math.max(e,t)}),0):0))}),[c]),s=Object(r.useMemo)((function(){return{width:"".concat(l,"px"),height:"".concat(u,"px")}}),[l,u]);return Object(r.useEffect)((function(){var e=n.current;if(null===e||void 0===e?void 0:e.parentElement){var t=e.parentElement.getBoundingClientRect().width;i(Math.ceil(t));var a=new gn.a(e.parentElement,(function(){var t,a,n=(null!==(t=null===e||void 0===e||null===(a=e.parentElement)||void 0===a?void 0:a.getBoundingClientRect())&&void 0!==t?t:{width:0}).width;i(Math.ceil(n))}));return function(){a.detach()}}}),[n,i]),o.a.createElement("div",{ref:n,className:a.root,style:s},t)},On=Object(r.memo)((function(e){var t=e.interactive,a=void 0===t||t,n=e.currentNode;return o.a.createElement(Qa,null,o.a.createElement(Cn,null,o.a.createElement(vn,{interactive:a,currentNode:n}),o.a.createElement(Za,{currentNode:n})))})),jn=Object(U.a)((function(e){return{root:{display:"flex",flexDirection:"column",padding:e.variables.spacing.globalPadding},elementContainer:{padding:"1em",marginRight:"10px",border:"0.1em solid",borderRadius:"0.2em",fontWeight:500,width:"auto",backgroundColor:e.palette.common.grayLightest},elementSelect:{display:"flex",alignItems:"center"},addElementLabel:{marginLeft:"1em",minWidth:"120px"},headerText:{marginRight:"10px",fontStyle:"italic",fontSize:"0.8em"},elementField:{display:"flex",alignItems:"center"},elementFieldLabel:{fontWeight:"bold",marginRight:"1em"}}}),{name:"CriteriaBuilder"}),kn=Object(r.memo)((function(){var e=wa(),t=e.selectedElement,a=e.selectedDemoElement,n=e.gender,i=e.minimumAge,c=e.maximumAge,l=e.setSelectedElement,u=e.setSelectedDemoElement,s=e.setGender,p=e.setMinimumAge,b=e.setMaximumAge,f=e.resetCriteriaBuilder,h=jn(),y=v().setCurrentCriteria,g=Object(r.useCallback)((function(e){p(parseInt(null===e||void 0===e?void 0:e.target.value)||0)}),[p]),E=Object(r.useCallback)((function(e){b(parseInt(null===e||void 0===e?void 0:e.target.value)||0)}),[b]),C=Object(r.useCallback)((function(){f(),y(null)}),[f,y]),O="The patient's gender is ".concat(n),j="The patient's age is between ".concat(i," years and ").concat(c," years");return Object(r.useEffect)((function(){var e="AgeInYears() >= ".concat(i," and AgeInYears() < ").concat(c);"Age Range"===a&&y(i>=0&&c>0&&i<c?{cql:e,text:j,type:"age",min:i,max:c}:null)}),[a,i,c,j,y]),Object(r.useEffect)((function(){var e="Patient.gender.value ~ '".concat(n,"'");"Gender"===a&&y(""!==n?{cql:e,text:O,type:"gender",gender:n}:null)}),[a,n,O,y]),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:h.headerText},"Specify criteria to identify a target population that should receive a recommendation from this artifact. Examples might include an age range, gender, presence of a certain condition, or lab results within a specific range."),o.a.createElement("div",{className:h.elementContainer},(""===t||""===a)&&o.a.createElement("div",{className:h.elementSelect},o.a.createElement("div",{className:h.addElementLabel},o.a.createElement(d.a,{icon:m.u})," Add element"),o.a.createElement(oa,{id:"Choose Element Type",label:"Choose Element Type",options:[{value:"Demographics",label:"Demographics"}],onChange:l,value:t}),t&&o.a.createElement(oa,{id:"Select ".concat(t," element"),label:"Select ".concat(t," element"),options:[{value:"Age Range",label:"Age Range"},{value:"Gender",label:"Gender"}],onChange:u,value:a})),!(""===t||""===a)&&o.a.createElement(o.a.Fragment,null,o.a.createElement("span",null,a),o.a.createElement(H.a,{onClick:C},o.a.createElement(d.a,{icon:m.C})),o.a.createElement("hr",null),"Gender"===a&&o.a.createElement(o.a.Fragment,null,o.a.createElement("span",null,O),o.a.createElement(oa,{id:"Select Gender",label:"Gender",options:[{label:"Male",value:"Male"},{label:"Female",value:"Female"},{label:"Other",value:"Other"},{label:"Unknown",value:"Unknown"}],onChange:s,value:n})),"Age Range"===a&&o.a.createElement(o.a.Fragment,null,o.a.createElement("span",null,j),o.a.createElement("div",{className:h.elementField},o.a.createElement("span",{className:h.elementFieldLabel},"Minimum Age:"),o.a.createElement(ea.a,{type:"number",value:i,onChange:g})),o.a.createElement("div",{className:h.elementField},o.a.createElement("span",{className:h.elementFieldLabel},"Maximum Age:"),o.a.createElement(ea.a,{type:"number",value:c,onChange:E}))))))})),wn=a(32),xn={borderRadius:"0%",marginLeft:"1px",width:"50px",height:"50px"},Nn=Object(U.a)((function(e){return{root:{display:"flex",flexDirection:"column",height:"100vh"},main:{flex:"1",display:"flex",alignItems:"stretch",overflowY:"auto"},graph:{"overflow-y":"auto",flex:"1"},graphHeader:{display:"flex",height:"50px",backgroundColor:e.palette.common.white,marginLeft:"1px"},graphHeaderText:{height:"50px",display:"flex",width:"100%",backgroundColor:e.palette.primary.main,alignItems:"center",color:e.palette.common.white,fontSize:"1.4em",paddingLeft:"1.5em"},toggleButton:{"&-on":Object(g.a)({},xn,{backgroundColor:e.palette.primary.main,"&:hover":{backgroundColor:Object(wn.a)(e.palette.primary.main,.1)}}),"&-off":Object(g.a)({},xn,{backgroundColor:e.palette.text.primary,"&:hover":{backgroundColor:Object(wn.a)(e.palette.text.primary,.1)}})},toggleIcon:{transform:"rotate(90deg) scaleY(-1)",color:e.palette.common.white}}}),{name:"Builder",index:1}),Sn=function(){var e=Object(u.h)().nodeId;return decodeURIComponent(e)},Tn=Object(r.memo)((function(){var e=Nn(),t=Sn(),a=ce().pathway,n=v().currentCriteriaNodeId,i=D("dark"),c=Object(r.useState)(!0),l=Object(s.a)(c,2),u=l[0],p=l[1],b=null;(null===a||void 0===a?void 0:a.nodes[t])?b=a.nodes[t]:a&&(b=a.nodes.Start);var f=Object(r.useCallback)((function(){p(!u)}),[u]);return Object(r.useEffect)((function(){u||""!==n||p(!0)}),[n,u]),o.a.createElement("div",{className:e.root},o.a.createElement("div",null,o.a.createElement(W,null),o.a.createElement(Xt,null)),a&&o.a.createElement("div",{className:e.main},o.a.createElement(y.a,{theme:i},o.a.createElement(ma,{currentNode:b})),o.a.createElement("div",{className:e.graph},""!==n&&o.a.createElement("div",{className:e.graphHeader},o.a.createElement("div",{className:e.graphHeaderText},o.a.createElement("span",null,"Criteria Builder")),o.a.createElement(H.a,{className:"".concat(e.toggleButton,"-").concat(u?"on":"off"),onClick:f},o.a.createElement(d.a,{className:e.toggleIcon,icon:m.w}))),""!==n&&u?o.a.createElement(kn,null):o.a.createElement(On,{currentNode:b}))))})),In=function(){var e=Object(u.h)().id;return decodeURIComponent(e)},Rn=Object(r.memo)((function(){var e=In(),t=Sn(),a=Mt(),n=a.setAlertText,i=a.setOpenAlert,c=X.a.get("pathwaysBackend"),l=ce(),s=l.pathway,d=l.pathwayRef,m=l.resetCurrentPathway,p=Object(_.d)("pathway",(function(){return fetch("".concat(c,"/pathway/").concat(e)).then((function(e){return e.json()}))})),b=p.isLoading,f=p.error,h=p.data;return Object(r.useEffect)((function(){var e,t=h;(null===(e=d.current)||void 0===e?void 0:e.id)!==(null===t||void 0===t?void 0:t.id)&&m(t)}),[h,d,m]),b&&!f?o.a.createElement(Vt,null):f?(n("Connection to server lost. Please save your work then restart the server."),i(!0),o.a.createElement(Tn,null)):h?t&&(null===s||void 0===s?void 0:s.nodes[t])?o.a.createElement(Tn,null):o.a.createElement(u.a,{to:"/builder/".concat(e,"/node/Start")}):o.a.createElement(u.a,{to:"/builder"})})),Pn=Object(r.createContext)({}),Ln=function(e){var t=e.children,a=Object(r.useState)(null),n=Object(s.a)(a,2),i=n[0],c=n[1];return o.a.createElement(Pn.Provider,{value:{user:i,setUser:c}},t)},Bn=a(243),Dn=Object(U.a)((function(e){return{root:{display:"flex",flexDirection:"column"},label:{padding:"0.2em 2em",textTransform:"none",fontSize:"1.2em",fontWeight:100}}}),{name:"Tabs",index:1}),Mn=Object(r.memo)((function(e){var t=e.tabs,a=Dn();return o.a.createElement("div",{className:a.root},o.a.createElement(Bn.d,null,o.a.createElement(Bn.b,null,t.map((function(e){return o.a.createElement(Bn.a,{key:me.a.generate()},o.a.createElement(Ht.a,{classes:{label:a.label}},e.label))}))),t.map((function(e){return o.a.createElement(Bn.c,{key:me.a.generate()},e.component)}))))})),An=a(1658),Fn=a(1659),qn=a(1660),zn=a(1661),Wn=a(1662),_n=a(1663),Hn=a(1664),Gn=Object(U.a)((function(e){return{root:{display:"flex",flexDirection:"column",padding:e.variables.spacing.globalPadding},createPathwayButton:{alignSelf:"flex-end",marginLeft:"20px"},pathwayList:{marginTop:"1em"},pathwaysListButton:{marginRight:"1em"},dialogCloseButton:{float:"right",width:"45px"},buttonRow:{display:"flex",justifyContent:"flex-end"},tableTop:{display:"flex",justifyContent:"space-between"},selectionOptions:{display:"flex",paddingLeft:"4px",justifyContent:"space-between",alignItems:"flex-end"},selectionIcon:{color:e.palette.primary.main},deleteIcon:{color:e.palette.secondary.main}}}),{name:"PathwaysList",index:1}),Un=Object(r.memo)((function(e){var t,a,i=e.open,c=e.onClose,l=e.editPathway,p=!l,b=Gn(),f=Object(u.g)(),h=Object(_.e)(),v=Object(r.useRef)(null),y=Object(r.useRef)(null),g=Object(r.useCallback)((function(e){f.push("/builder/".concat(encodeURIComponent(e),"/node/Start")),c()}),[f,c]),E=Object(_.c)(te,{onSettled:function(){return h.invalidateQueries("pathways")}}),C=Object(s.a)(E,1)[0],O=Object(_.c)(te,{onSettled:function(){return h.invalidateQueries("pathways")}}),j=Object(s.a)(O,1)[0],k=Object(r.useCallback)((function(e){var t,a,n,r;e.preventDefault();var o=me.a.generate(),i=null!==(t=null===(a=v.current)||void 0===a?void 0:a.value)&&void 0!==t?t:"",c=null!==(n=null===(r=y.current)||void 0===r?void 0:r.value)&&void 0!==n?n:"";C(ot(i,c,o)),g(o)}),[C,g]),w=Object(r.useCallback)((function(e){var t,a;if(e.preventDefault(),l&&((null===(t=v.current)||void 0===t?void 0:t.value)!==l.name||(null===(a=y.current)||void 0===a?void 0:a.value)!==l.description)){var r=Object(n.a)(l,(function(e){var t,a;(null===(t=v.current)||void 0===t?void 0:t.value)&&(e.name=v.current.value),(null===(a=y.current)||void 0===a?void 0:a.value)&&(e.description=y.current.value)}));j(r)}c()}),[j,l,c]);if(l){t=l.name;var x=l.description;x&&""!==x&&(a=x)}return o.a.createElement(qt.a,{open:i,onClose:c,"aria-labelledby":"create-pathway",fullWidth:!0,maxWidth:"md"},o.a.createElement(zt.a,{disableTypography:!0},o.a.createElement(H.a,{"aria-label":"close",onClick:c,className:b.dialogCloseButton},o.a.createElement(d.a,{icon:m.C}))),o.a.createElement("form",{onSubmit:p?k:w},o.a.createElement(Wt.a,null,o.a.createElement(ea.a,{variant:"outlined",autoFocus:!0,label:"Pathway Name",fullWidth:!0,required:p,inputRef:v,defaultValue:p?void 0:t}),o.a.createElement(ea.a,{variant:"outlined",label:"Pathway Description",fullWidth:!0,inputRef:y,defaultValue:p?void 0:a,multiline:!0})),o.a.createElement(_t.a,null,o.a.createElement(Ht.a,{variant:"contained",color:"primary",startIcon:p&&o.a.createElement(d.a,{icon:m.u}),type:"submit"},p?"Create":"Save"))))})),Kn=a(1641),Qn=a(1645),Vn=a(146),Jn=a.n(Vn),Yn=function(e){var t=e.type,a=e.onClick;return o.a.createElement("button",{className:"".concat(Jn.a.largeActionButton," button ").concat("decline"===t&&Jn.a.largeDecline),type:"button",onClick:a},t[0].toUpperCase()+t.slice(1))},$n=function(e){var t=e.type,a=e.onClick;return o.a.createElement("div",{className:"".concat("accept"===t?Jn.a.accept:Jn.a.decline," ").concat(Jn.a.smallActionButton),onClick:a,"data-testid":t},o.a.createElement(d.a,{icon:"accept"===t?m.d:m.C}))},Xn=function(e){var t=e.type,a=e.onClick;return o.a.createElement("div",{className:"".concat("accept"===t?Jn.a.accept:Jn.a.decline," ").concat(Jn.a.mediumActionButton),onClick:a,"data-testid":t},o.a.createElement(d.a,{icon:"accept"===t?m.d:m.C}),{accept:"Submit",decline:"Cancel"}[t])},Zn=Object(r.memo)((function(e){var t=e.type,a=e.size,n=e.onClick;switch(a){case"small":return o.a.createElement($n,{type:t,onClick:n});case"large":return o.a.createElement(Yn,{type:t,onClick:n});case"medium":return o.a.createElement(Xn,{type:t,onClick:n})}})),er=Object(U.a)((function(e){return{container:{display:"inline-block"},paper:{display:"flex",flexDirection:"row",alignItems:"center",borderRadius:"10px",border:"5px solid rgba(74, 74, 74, 0.5)",backgroundColor:e.palette.common.gray,color:e.palette.common.white,padding:"0.5em",mozBackgroundClip:"padding",webkitBackgroundVlip:"padding",backgroundClip:"padding-box"},displayText:{marginRight:"4em",whiteSpace:"nowrap"},buttons:{display:"flex",alignItems:"center",justifyContent:"center",minWidth:"2.5em",minHeight:"2em",cursor:"pointer",borderRadius:"15%",marginRight:"0.5em"}}}),{name:"ConfirmationPopover"}),tr=o.a.forwardRef((function(e,t){var a=e.children,n=e.displayText,i=e.onConfirm,c=e.onDecline,l=Object(xa.a)(e,["children","displayText","onConfirm","onDecline"]),u=er(),d=Object(r.useState)(!1),m=Object(s.a)(d,2),p=m[0],b=m[1],f=Object(r.useState)(null),h=Object(s.a)(f,2),v=h[0],y=h[1],E=Object(r.useCallback)((function(e){y(e.currentTarget),b(!0)}),[]),C=Object(r.useCallback)((function(){i&&i(),b(!1),y(null)}),[i]),O=Object(r.useCallback)((function(){c&&c(),b(!1),y(null)}),[c]);return o.a.createElement("div",{className:u.container},o.a.createElement(Qn.a,{onClickAway:O},o.a.Children.only(a)?o.a.createElement("div",{className:u.container,onClick:E},o.a.Children.map(a,(function(e){return o.a.cloneElement(e,Object(g.a)({ref:t},l))}))):o.a.createElement("div",Object.assign({onClick:E,className:u.container},l,{ref:t}),a)),o.a.createElement(Kn.a,{classes:{paper:u.paper},open:p,anchorEl:v,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},o.a.createElement("div",{className:u.displayText}," ",n," "),o.a.createElement("div",{className:u.buttons},o.a.createElement(Zn,{size:"small",type:"accept",onClick:C}),o.a.createElement(Zn,{size:"small",type:"decline",onClick:O}))))})),ar=Object(r.memo)(tr),nr=Object(r.memo)((function(e){var t=e.deleteId,a=e.deleteMethod,n=e.deleteType,i=e.deleteName,c="Are you sure"+(n&&a?" that you would like to delete the "+i+" "+n+" ?":"?"),l=Object(r.useCallback)((function(){a(t)}),[t,a]);return o.a.createElement(ar,{onConfirm:l,displayText:c},o.a.createElement(Ht.a,{color:"secondary",size:"small",startIcon:o.a.createElement(d.a,{icon:m.E})},"Delete"))})),rr=Object(r.memo)((function(e){var t=e.itemSelected,a=e.handleSelectClick,n=Gn(),i=Object(_.e)(),c=At().pathways,u=ce().setCurrentPathway,p=Object(r.useState)(!1),b=Object(s.a)(p,2),f=b[0],h=b[1],v=Object(r.useState)(),y=Object(s.a)(v,2),g=y[0],E=y[1],C=Object(r.useState)(null),O=Object(s.a)(C,2),j=O[0],k=O[1],w=Object(r.useCallback)((function(e){h(!0),E(e)}),[]),x=Object(r.useCallback)((function(){h(!1)}),[]),N=Object(r.useCallback)((function(e){k(e.currentTarget);var t=c.filter((function(t){return t.id===e.currentTarget.id}));t.length&&u(t[0])}),[c,u]),S=Object(r.useCallback)((function(){k(null)}),[]),T=Object(_.c)(ee,{onSettled:function(){i.invalidateQueries("pathways"),i.invalidateQueries("pathway")}}),I=Object(s.a)(T,1)[0],R=Object(r.useCallback)((function(e){I(e)}),[I]);return o.a.createElement("div",null,o.a.createElement(An.a,{className:n.pathwayList},o.a.createElement(Fn.a,{"aria-label":"pathway list"},o.a.createElement(qn.a,null,o.a.createElement(zn.a,null,o.a.createElement(Wn.a,{padding:"checkbox"}),o.a.createElement(Wn.a,null,"Pathway Name"),o.a.createElement(Wn.a,null,"Status"),o.a.createElement(Wn.a,null,"Last Updated"),o.a.createElement(Wn.a,null))),o.a.createElement(_n.a,null,c.map((function(e){return o.a.createElement(zn.a,{key:e.id},o.a.createElement(Wn.a,{padding:"checkbox"},o.a.createElement(Oa.a,{checked:t(e.id),onChange:a(e.id)})),o.a.createElement(Wn.a,{component:"th",scope:"row"},o.a.createElement(Hn.a,{component:l.b,to:"/builder/".concat(encodeURIComponent(e.id)),color:"primary",underline:"none"},e.name)),o.a.createElement(Wn.a,null,"draft"),o.a.createElement(Wn.a,null,"2 days ago"),o.a.createElement(Wn.a,{align:"right"},o.a.createElement(Ht.a,{className:n.pathwaysListButton,color:"primary",size:"small",startIcon:o.a.createElement(d.a,{icon:m.i}),onClick:function(){return w(e)}},"Edit Info"),o.a.createElement(Ht.a,{id:e.id,className:n.pathwaysListButton,color:"primary",size:"small",startIcon:o.a.createElement(d.a,{icon:m.n}),onClick:N},"Export"),o.a.createElement(nr,{deleteType:"pathway",deleteName:e.name,deleteId:e.id,deleteMethod:R})))}))))),o.a.createElement(Yt,{anchorEl:j,closeMenu:S}),o.a.createElement(Un,{open:f,onClose:x,editPathway:g}))})),or=Object(U.a)((function(e){return{dialogCloseButton:{float:"right",width:"45px"},input:{display:"none"},chooseFileInput:{display:"flex",alignItems:"center"},inputButton:{whiteSpace:"nowrap",marginRight:"1em"},fileName:{fontStyle:"italic"}}}),{name:"FileImportModal",index:1}),ir=Object(r.memo)((function(e){var t=e.open,a=e.onClose,n=e.onSelectFile,i=e.allowedFileType,c=e.loading,l=void 0!==c&&c,u=or(),p=Object(r.useState)(""),b=Object(s.a)(p,2),f=b[0],h=b[1],v=Object(r.useRef)(null),y=Object(r.useCallback)((function(e){var t;e.preventDefault();var a=null===v||void 0===v||null===(t=v.current)||void 0===t?void 0:t.files;n(a),h("")}),[n]),g=Object(r.useCallback)((function(){var e,t;(null===v||void 0===v||null===(e=v.current)||void 0===e||null===(t=e.files)||void 0===t?void 0:t[0])&&h(v.current.files[0].name)}),[v]);return o.a.createElement(qt.a,{open:t,onClose:a,"aria-labelledby":"import-pathway",fullWidth:!0,maxWidth:"sm"},o.a.createElement(zt.a,{disableTypography:!0},o.a.createElement(H.a,{"aria-label":"close",onClick:a,className:u.dialogCloseButton},o.a.createElement(d.a,{icon:m.C}))),o.a.createElement("form",{onSubmit:y},o.a.createElement(Wt.a,null,o.a.createElement("div",{className:u.chooseFileInput},o.a.createElement(ba.a,{id:"choose-file-input",className:u.input,inputRef:v,type:"file",inputProps:{accept:i},onChange:g}),o.a.createElement("label",{htmlFor:"choose-file-input"},o.a.createElement(Ht.a,{className:u.inputButton,variant:"contained",color:"primary",component:"span"},"Choose File")),o.a.createElement("div",{className:u.fileName},f?o.a.createElement("span",null,f):o.a.createElement("span",null,"Choose file to import.")))),o.a.createElement(_t.a,null,o.a.createElement(Ht.a,{variant:"contained",color:"primary",startIcon:o.a.createElement(d.a,{icon:m.p}),endIcon:l?o.a.createElement(d.a,{icon:m.z,spin:!0}):null,type:"submit",disabled:l},"Import"))))})),cr=function(e){var t=Object(r.useState)(new Set),a=Object(s.a)(t,2),o=a[0],i=a[1],c=Object(r.useMemo)((function(){return o.size}),[o.size]),l=Object(r.useMemo)((function(){return e.length}),[e.length]),u=Object(r.useMemo)((function(){return c>0&&c<l}),[c,l]),d=Object(r.useMemo)((function(){return l>0&&c===l}),[c,l]);return Object(r.useEffect)((function(){var t=Array.from(o).filter((function(t){return!e.includes(t)}));t.length>0&&i(Object(n.a)((function(e){t.forEach((function(t){return e.delete(t)}))})))}),[e,o]),{indeterminate:u,checked:d,handleSelectAllClick:Object(r.useCallback)((function(t){t.target.checked?i(new Set(e)):i(new Set)}),[e]),itemSelected:Object(r.useCallback)((function(e){return o.has(e)}),[o]),handleSelectClick:Object(r.useCallback)((function(e){return function(t){t.target.checked?i(Object(n.a)((function(t){t.add(e)}))):i(Object(n.a)((function(t){t.delete(e)})))}}),[]),selected:o,setSelected:i,numSelected:c}},lr=Object(r.memo)((function(){var e=Gn(),t=Object(_.e)(),a=Ft().criteria,n=At(),i=n.isLoading,c=n.pathways,l=Object(r.useState)(!1),u=Object(s.a)(l,2),p=u[0],b=u[1],f=Object(r.useState)(!1),h=Object(s.a)(f,2),v=h[0],y=h[1],g=Object(r.useState)(null),E=Object(s.a)(g,2),C=E[0],O=E[1],j=Object(r.useState)(!1),k=Object(s.a)(j,2),w=k[0],x=k[1],N=cr(i?[]:c.map((function(e){return e.id}))),S=N.indeterminate,T=N.checked,I=N.handleSelectAllClick,R=N.itemSelected,P=N.handleSelectClick,L=N.selected,B=N.numSelected,D=Object(r.useCallback)((function(){b(!0)}),[]),M=Object(r.useCallback)((function(){b(!1)}),[]),A=Object(r.useCallback)((function(){return y(!0)}),[]),F=Object(r.useCallback)((function(){return y(!1)}),[]),q=Object(_.c)(te,{onSettled:function(){return t.invalidateQueries("pathways")}}),z=Object(s.a)(q,1)[0],W=Object(_.c)(ne,{onSettled:function(){return t.invalidateQueries("criteria")}}),U=Object(s.a)(W,1)[0],K=Object(r.useCallback)((function(e,t){var n=a.map((function(e){return e.label}));return Ia(e).then((function(e){e.length>0?e.forEach((function(e){n.includes(e.label)||(t.push(e),U(e))})):alert("No valid criteria were found in the provided file")}))}),[a,U]),Q=Object(r.useCallback)(function(){var e=Object(se.a)(ue.a.mark((function e(t){var a,n;return ue.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],n=[],t.library.forEach((function(e){return n.push(K(e,a))})),e.abrupt("return",Promise.all(n).then((function(){return a})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[K]),V=Object(r.useCallback)((function(e){e?(x(!0),re(e[0],(function(e){var t;if(null===(t=e.target)||void 0===t?void 0:t.result){var n=e.target.result,r=JSON.parse(n);Q(r).then((function(e){var t=it(r,[].concat(Object(pe.a)(a),Object(pe.a)(e))).newPathway;z(t),F(),x(!1)}))}}))):F()}),[a,z,Q,F]),J=Object(r.useCallback)((function(){O(null)}),[]),Y=Object(_.c)(ee,{onSettled:function(){return t.invalidateQueries("pathways")}}),$=Object(s.a)(Y,1)[0],X=Object(r.useCallback)((function(){L.forEach((function(e){$(e)}))}),[$,L]),Z=Object(r.useState)([]),ae=Object(s.a)(Z,2),oe=ae[0],ie=ae[1],ce=Object(r.useCallback)((function(e){ie(c.filter((function(e){return L.has(e.id)}))),O(e.currentTarget)}),[c,L]);return o.a.createElement("div",{className:e.root},o.a.createElement("div",{className:e.tableTop},o.a.createElement("div",{className:e.selectionOptions},o.a.createElement(G.a,{placement:"top",title:"Select All",arrow:!0},o.a.createElement(Oa.a,{indeterminate:S,checked:T,onChange:I})),B>0&&o.a.createElement(o.a.Fragment,null,o.a.createElement(G.a,{placement:"top",title:"Export",arrow:!0},o.a.createElement(H.a,{size:"small",onClick:ce},o.a.createElement(d.a,{icon:m.n,className:e.selectionIcon}))),o.a.createElement(G.a,{placement:"top",title:"Move to",arrow:!0},o.a.createElement(H.a,{size:"small"},o.a.createElement(d.a,{icon:m.o,className:e.selectionIcon}))),o.a.createElement(G.a,{placement:"top",title:"Delete",arrow:!0},o.a.createElement(ar,{onConfirm:X,displayText:"Are you sure that you would like to delete the selected pathway".concat(B>1?"s":"","?")},o.a.createElement(H.a,{size:"small"},o.a.createElement(d.a,{icon:m.E,className:e.deleteIcon})))))),o.a.createElement("div",{className:e.buttonRow},o.a.createElement(Ht.a,{className:e.createPathwayButton,variant:"contained",color:"primary",startIcon:o.a.createElement(d.a,{icon:m.p}),onClick:A},"Import Pathway"),o.a.createElement(Ht.a,{className:e.createPathwayButton,variant:"contained",color:"primary",startIcon:o.a.createElement(d.a,{icon:m.u}),onClick:D},"Create Pathway"))),o.a.createElement(ir,{open:v,onClose:F,onSelectFile:V,allowedFileType:".json",loading:w}),o.a.createElement(Un,{open:p,onClose:M}),o.a.createElement($t,{pathway:oe,anchorEl:C,closeMenu:J}),i&&o.a.createElement(Vt,null),!i&&c&&o.a.createElement(rr,{handleSelectClick:P,itemSelected:R}))})),ur=a(303),sr=a.n(ur),dr=Object(U.a)((function(e){return{root:{display:"flex",flexDirection:"column",padding:e.variables.spacing.globalPadding},buttonRow:{display:"flex",justifyContent:"flex-end"},buildCriteriaButton:{alignSelf:"flex-end",marginLeft:"20px"},criteriaList:{marginTop:"1em"},editButton:{marginRight:"1em"},dialogCloseButton:{float:"right",width:"45px"},input:{display:"none"},chooseFileInput:{display:"flex",alignItems:"center"},inputButton:{whiteSpace:"nowrap",marginRight:"1em"},fileName:{fontStyle:"italic"},tableTop:{display:"flex",justifyContent:"space-between"},selectionOptions:{display:"flex",paddingLeft:"4px",justifyContent:"space-between",alignItems:"flex-end"},selectionIcon:{color:e.palette.primary.main},deleteIcon:{color:e.palette.secondary.main}}}),{name:"CriteriaList",index:1}),mr=Object(r.memo)((function(e){var t=e.itemSelected,a=e.handleSelectClick,n=dr(),i=Object(_.e)(),c=Ft().criteria,l=Object(_.c)(ae,{onSettled:function(){return i.invalidateQueries("criteria")}}),u=Object(s.a)(l,1)[0],p=Object(r.useCallback)((function(e){u(e)}),[u]);return o.a.createElement(An.a,{className:n.criteriaList},o.a.createElement(Fn.a,{"aria-label":"criteria list"},o.a.createElement(qn.a,null,o.a.createElement(zn.a,null,o.a.createElement(Wn.a,{padding:"checkbox"}),o.a.createElement(Wn.a,null,"Criteria Name"),o.a.createElement(Wn.a,null,"Version"),o.a.createElement(Wn.a,null,"Added"),o.a.createElement(Wn.a,null))),o.a.createElement(_n.a,null,c.map((function(e){return o.a.createElement(zn.a,{key:e.id},o.a.createElement(Wn.a,{padding:"checkbox"},o.a.createElement(Oa.a,{checked:t(e.id),onChange:a(e.id)})),o.a.createElement(Wn.a,{component:"th",scope:"row"},e.label),o.a.createElement(Wn.a,null,e.version),o.a.createElement(Wn.a,null,(r=e.modified,sr()(r).fromNow())),o.a.createElement(Wn.a,{align:"right"},o.a.createElement(Ht.a,{className:n.editButton,color:"primary",size:"small",startIcon:o.a.createElement(d.a,{icon:m.i})},"Edit"),o.a.createElement(nr,{deleteType:"criterion",deleteName:e.label,deleteId:e.id,deleteMethod:p})));var r})))))})),pr=Object(r.memo)((function(){var e=dr(),t=Object(_.e)(),a=Ft(),n=a.isLoading,i=a.criteria,c=Object(r.useState)(!1),l=Object(s.a)(c,2),u=l[0],p=l[1],b=cr(n?[]:i.map((function(e){return e.id}))),f=b.indeterminate,h=b.checked,v=b.handleSelectAllClick,y=b.itemSelected,g=b.handleSelectClick,E=b.selected,C=b.setSelected,O=b.numSelected,j=Object(r.useCallback)((function(){p(!0)}),[]),k=Object(r.useCallback)((function(){p(!1)}),[]),w=Object(_.c)(ne,{onSettled:function(){return t.invalidateQueries("criteria")}}),x=Object(s.a)(w,1)[0],N=Object(r.useCallback)((function(e){Ia(e).then((function(e){e.length?e.forEach((function(e){return x(e)})):alert("No valid criteria were found in the provided file")}))}),[x]),S=Object(r.useCallback)((function(e){e&&re(e[0],(function(t){var a;if(null===(a=t.target)||void 0===a?void 0:a.result){var n=t.target.result;if(e[0].name.endsWith(".cql"))N(n);else if(e[0].name.endsWith(".zip")){var r={};rt.a.loadAsync(e[0]).then(function(){var e=Object(se.a)(ue.a.mark((function e(t){var a,n,o,i;return ue.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Object.values(t.files),n=0;case 2:if(!(n<a.length)){e.next=13;break}if((o=a[n]).name.endsWith(".cql")){e.next=6;break}return e.abrupt("continue",10);case 6:return e.next=8,o.async("string");case 8:i=e.sent,r[o.name]={cql:i};case 10:n++,e.next=2;break;case 13:N(r);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}else alert("Unable to read that file")})),k()}),[k,N]),T=Object(_.c)(ae,{onSettled:function(){return t.invalidateQueries("criteria")}}),I=Object(s.a)(T,1)[0],R=Object(r.useCallback)((function(){E.forEach((function(e){I(e),C(new Set)}))}),[E,C,I]);return o.a.createElement("div",{className:e.root},o.a.createElement("div",{className:e.tableTop},o.a.createElement("div",{className:e.selectionOptions},o.a.createElement(G.a,{placement:"top",title:"Select All",arrow:!0},o.a.createElement(Oa.a,{indeterminate:f,checked:h,onChange:v})),O>0&&o.a.createElement(o.a.Fragment,null,o.a.createElement(G.a,{placement:"top",title:"Delete",arrow:!0},o.a.createElement(ar,{onConfirm:R,displayText:"Are you sure that you would like to delete the selected ".concat(O>1?"criteria":"criterion","?")},o.a.createElement(H.a,{size:"small"},o.a.createElement(d.a,{icon:m.E,className:e.deleteIcon})))))),o.a.createElement("div",{className:e.buttonRow},o.a.createElement(Ht.a,{className:e.buildCriteriaButton,variant:"contained",color:"primary",startIcon:o.a.createElement(d.a,{icon:m.p}),onClick:j},"Import Library"),o.a.createElement(Ht.a,{className:e.buildCriteriaButton,variant:"contained",color:"primary",startIcon:o.a.createElement(d.a,{icon:m.D})},"Build Criteria"))),o.a.createElement(ir,{open:u,onClose:k,onSelectFile:S,allowedFileType:".cql, .zip"}),n&&o.a.createElement(Vt,null),!n&&i&&o.a.createElement(mr,{handleSelectClick:g,itemSelected:y}))})),br=new _.a,fr=Object(r.memo)((function(){return o.a.createElement(_.b,{queryCache:br},o.a.createElement(Ln,null,o.a.createElement(ie,null,o.a.createElement(Dt,null,o.a.createElement(ca,null,o.a.createElement(h,null,o.a.createElement(ka,null,o.a.createElement(l.a,null,o.a.createElement(u.d,null,o.a.createElement(u.b,{path:"/builder/:id/node/:nodeId"},o.a.createElement(Rn,null)),o.a.createElement(u.b,{path:"/builder/:id"},o.a.createElement(Rn,null)),o.a.createElement(u.b,{path:"/"},o.a.createElement(W,null),o.a.createElement(Mn,{tabs:[{label:"Pathway",component:o.a.createElement(lr,null)},{label:"Criteria",component:o.a.createElement(pr,null)}]})))))))))))})),hr=a(1137),vr=Object(r.memo)((function(){var e=Object(r.useState)(""),t=Object(s.a)(e,2),a=t[0],n=t[1],i=function(e,t){var a={id:e+"_"+t,label:"",penwidth:1};return'"'+e+'" -> "'+t+'" ['+Object.keys(a).map((function(e){return"".concat(e,' = "').concat(a[e],'"')})).join(", ")+"]"},c=function(e,t){var a={id:e,shape:"record",style:"rounded,filled",fillcolor:"White",penwidth:"2",fontcolor:"Black",label:t.replace(/"/g,"")};return'"'+e+'" ['+Object.keys(a).map((function(e){return"".concat(e,' = "').concat(a[e],'"')})).join(", ")+"]"},l="";try{l=function(e){var t=JSON.parse(e),a=[],n="digraph G {";return n+=t.entry?function(e,t){return e.entry.map((function(e){var a=e.resource;if(a&&a.id&&a.resourceType){var n=a.id,r=a.resourceType;if("PlanDefinition"===r){var o=a,l=o.action.map((function(e){var t,a=null===(t=e.definitionCanonical)||void 0===t?void 0:t.split("/").pop();return a?i(n,a):""})).join("\n");if(t.push(l),o.library){var u=o.library.map((function(e){return i(n,e)})).join("\n");t.push(u)}}else if("ActivityDefinition"===r){var s=a;r+=": ".concat(s.id," \\n").concat(s.description)}else if("Library"===r){var d=a;r+=": ".concat(d.id," \\n").concat(d.title)}return c(a.id,r)}return""})).join("\n")}(t,a):function(e,t){if(e.contained){var a=e.contained.map((function(e){if(e.id&&e.resourceType){var a=e.id,n=e.resourceType;if("RequestGroup"===n){var r=e;if(n+=": ".concat(r.id),r.action){var o=r.action.map((function(e){var t,n=null===(t=e.resource)||void 0===t?void 0:t.reference;return n?i(a,n.substring(1)):""})).join("\n");t.push(o)}}else if("MedicationRequest"===n)n+=": ".concat(e.id);else if("CarePlan"===n){var l=e;if(n+=": ".concat(l.id),l&&l.activity){var u=l.activity.map((function(e){var t,a,n;return(null===(t=e.reference)||void 0===t?void 0:t.reference)&&l.id?i(l.id,null===(a=e.reference)||void 0===a||null===(n=a.reference)||void 0===n?void 0:n.substring(1)):""})).join("\n");t.push(u)}}return c(a,n)}return""})).join("\n"),n=c(e.resourceType,"Main CarePlan");if(e.activity){var r=e.activity.map((function(t){var a,n,r;return(null===(a=t.reference)||void 0===a?void 0:a.reference)?i(e.resourceType,null===(n=t.reference)||void 0===n||null===(r=n.reference)||void 0===r?void 0:r.substring(1)):""})).join("\n");t.push(r),a+="\n".concat(n)}return a}return""}(t,a),n+=a.join("\n"),n+="}"}(a)}catch(u){console.log("Invalid JSON: Please paste a CPG bundle into the textbox"),l=""}return o.a.createElement("div",null,o.a.createElement("textarea",{value:a,onChange:function(e){var t=e.target.value;n(t)}}),l&&o.a.createElement(hr.a,{dot:l,options:{width:"2000",zoom:!0}}))})),yr=Object(U.a)((function(e){return{landing:{display:"flex",flexDirection:"column",minHeight:"100vh"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",height:"7em",backgroundColor:e.palette.common.grayLightest,padding:"0 4em"},logoLink:{display:"block"},logo:{height:"5em"},headerButtons:{display:"flex",justifyContent:"flex-end"},authButton:{padding:"30px",fontSize:"1.5em","& span":{fontFamily:["Roboto Condensed","sans-serif"].join(","),fontWeight:400,lineHeight:"0.2em"}},signupButton:{backgroundColor:e.palette.common.red,color:e.palette.common.white,marginRight:"20px",marginLeft:"auto","&:hover":{backgroundColor:e.palette.common.redDark}},loginButton:{backgroundColor:e.palette.common.white,border:"1px solid",borderColor:e.palette.common.grayBlueDark,color:e.palette.common.grayBlueDark,"&:hover":{color:e.palette.common.grayVeryDark}},tryItButton:{height:"60px",width:"200px",marginBottom:"1em","& button":{backgroundColor:e.palette.common.red,color:e.palette.common.white,boxShadow:"4px 4px 12px 0 rgba(0,0,0,0.50)",fontSize:"2.5em",height:"100%",width:"100%"},"& button:hover":{backgroundColor:e.palette.common.redDark},"& button span":{fontFamily:["Roboto Condensed","sans-serif"].join(","),fontWeight:400,textTransform:"none",lineHeight:"0.2em"}},landingBody:{display:"flex",alignItems:"center",justifyContent:"space-around",flex:"1",margin:"4em"},landingContent:{display:"flex",flexDirection:"column",marginRight:"10em"},text:{fontFamily:["Roboto Condensed","sans-serif"].join(","),fontWeight:300,lineHeight:"1.2em"},mainText:{fontSize:"4em",color:e.palette.common.grayBlueDark,marginBottom:"0.5em"},subText:{fontSize:"2.5em",color:e.palette.common.grayLighter,marginBottom:"2em",width:"80%"},link:{fontWeight:500,color:e.palette.common.blue,"&:hover":{color:e.palette.common.blueDark}},socialMedia:{display:"flex",color:e.palette.common.grayDark},iconGithub:{fontSize:"3em"},iconEmail:{marginLeft:"5px",color:e.palette.common.white,"& svg":{fontSize:"1.8em",padding:"5px"}},iconEmailCircle:{display:"flex",alignItems:"center",justifyContent:"space-around",backgroundColor:e.palette.common.grayDark,borderRadius:"50%",width:"42px",height:"42px"},exampleImage:{width:"50%",maxWidth:"800px"},footer:{display:"flex",justifyContent:"flex-end",alignItems:"center",backgroundColor:e.palette.common.grayLightest,padding:"0.5em 4em"},footerLogo:{display:"flex"},mitreLogo:{marginRight:"20px",height:"60px"},mcodeLogo:{height:"30px"}}}),{name:"Auth",index:1}),gr=a(1677),Er=a(1665),Cr=Object(U.a)((function(e){return{textInput:{margin:"10px 0"},input:{width:"100%","& input::placeholder":{color:e.palette.common.grayDark,fontStyle:"italic"}},icon:{color:e.palette.common.grayBlueDark,marginRight:"20px"}}}),{name:"TextInput",index:1}),Or=Object(r.memo)((function(e){var t=e.id,a=e.placeholder,n=void 0===a?"":a,r=e.icon,i=e.type,c=void 0===i?"text":i,l=e.helperText,u=void 0===l?"":l,s=Cr();return o.a.createElement("div",{className:s.textInput},o.a.createElement(gr.a,{id:t,type:c,placeholder:n||"",className:s.input,startAdornment:o.a.createElement(Er.a,{position:"start",className:s.icon},o.a.createElement(d.a,{icon:r}))}),u)})),jr=Object(r.memo)((function(e){var t=e.open,a=e.onClose,n=e.onSignup,i=e.onReset,c=Object(r.useCallback)((function(){}),[]),l=o.a.createElement(o.a.Fragment,null,"Don't have an account?"," ",o.a.createElement(Ht.a,{variant:"text",color:"primary",onClick:n},"Sign up.")),u=o.a.createElement(o.a.Fragment,null,o.a.createElement("label",null,"Forgot your password?"),o.a.createElement(Ht.a,{variant:"text",color:"primary",onClick:i},"Request a reset link."));return o.a.createElement(Ut,{handleShowModal:t,handleCloseModal:a,handleSaveModal:c,headerTitle:"Log in",headerSubtitle:"Log in to access your account and manage your clinical pathways",footerText:l,submitButtonText:"Log in"},o.a.createElement(o.a.Fragment,null,o.a.createElement(Or,{id:"email",placeholder:"Email",type:"email",icon:m.k}),o.a.createElement(Or,{id:"password",placeholder:"Password",type:"password",icon:m.r,helperText:u})))})),kr=Object(r.memo)((function(e){var t=e.open,a=e.onClose,n=e.onLogin,r=e.onLinkSent,i=o.a.createElement(o.a.Fragment,null,"Already know your password?"," ",o.a.createElement(Ht.a,{variant:"text",color:"primary",onClick:n},"Log in."));return o.a.createElement(Ut,{handleShowModal:t,handleCloseModal:a,handleSaveModal:r,headerTitle:"Reset password",headerSubtitle:"Enter your email address you're using for your account below and we'll send you a password reset link",footerText:i,submitButtonText:"Reset"},o.a.createElement(o.a.Fragment,null,o.a.createElement(Or,{id:"email",placeholder:"Email",type:"email",icon:m.k})))})),wr=Object(r.memo)((function(e){var t=e.open,a=e.onClose;return o.a.createElement(Ut,{handleShowModal:t,handleCloseModal:a,handleSaveModal:a,headerTitle:"Link sent",headerSubtitle:"A password reset link was successfully sent. Please check your email to set your new password.",submitButtonText:"Close"})})),xr=Object(r.memo)((function(e){var t=e.open,a=e.onClose,n=e.onPasswordReset;return o.a.createElement(Ut,{handleShowModal:t,handleCloseModal:a,handleSaveModal:n,headerTitle:"Reset password",headerSubtitle:"Enter your new password for your account",submitButtonText:"Reset"},o.a.createElement(o.a.Fragment,null,o.a.createElement(Or,{id:"password",placeholder:"Password",type:"password",icon:m.r}),o.a.createElement(Or,{id:"confirm-password",placeholder:"Confirm password",type:"password",icon:m.r})))})),Nr=Object(r.memo)((function(e){var t=e.open,a=e.onClose,n=e.onLogin;return o.a.createElement(Ut,{handleShowModal:t,handleCloseModal:a,handleSaveModal:n,headerTitle:"Password reset",headerSubtitle:"Your password was successfully reset! You can now use your new password to log in.",submitButtonText:"Log in"})})),Sr=Object(r.memo)((function(e){var t=e.open,a=e.onClose,n=e.onLogin,i=Object(r.useCallback)((function(){}),[]),c=o.a.createElement(o.a.Fragment,null,"Already signed up?"," ",o.a.createElement(Ht.a,{variant:"text",color:"primary",onClick:n},"Log in."));return o.a.createElement(Ut,{handleShowModal:t,handleCloseModal:a,handleSaveModal:i,headerTitle:"Sign up",headerSubtitle:"Create an account to start building your own clinical pathways",footerText:c,submitButtonText:"Sign up"},o.a.createElement(o.a.Fragment,null,o.a.createElement(Or,{id:"email",placeholder:"Email",type:"email",icon:m.k}),o.a.createElement(Or,{id:"organization",placeholder:"Organization (optional)",icon:m.b}),o.a.createElement(Or,{id:"password",placeholder:"Password",type:"password",icon:m.r}),o.a.createElement(Or,{id:"confirm-password",placeholder:"Confirm Password",type:"password",icon:m.r})))})),Tr=function(e){var t=e.openLogin,a=e.openSignup,n=e.openReset,r=e.openLinkSent,i=e.openNewPassword,c=e.openPasswordReset,l=e.switchToLogin,u=e.switchToReset,s=e.switchToSignup,d=e.switchToLinkSent,m=e.switchToPasswordReset,p=e.closeLoginModal,b=e.closeSignupModal,f=e.closeResetModal,h=e.closeLinkSentModal,v=e.closeNewPasswordModal,y=e.closePasswordResetModal;return o.a.createElement(o.a.Fragment,null,o.a.createElement(jr,{open:t,onClose:p,onSignup:s,onReset:u}),o.a.createElement(Sr,{open:a,onClose:b,onLogin:l}),o.a.createElement(kr,{open:n,onClose:f,onLogin:l,onLinkSent:d}),o.a.createElement(wr,{open:r,onClose:h}),o.a.createElement(xr,{open:i,onClose:v,onPasswordReset:m}),o.a.createElement(Nr,{open:c,onClose:y,onLogin:l}))},Ir=Object(r.createContext)({}),Rr=Object(r.memo)((function(e){var t=e.children,a=Object(r.useState)(!1),n=Object(s.a)(a,2),i=n[0],c=n[1],l=Object(r.useState)(!1),u=Object(s.a)(l,2),d=u[0],m=u[1],p=Object(r.useState)(!1),b=Object(s.a)(p,2),f=b[0],h=b[1],v=Object(r.useState)(!1),y=Object(s.a)(v,2),g=y[0],E=y[1],C=Object(r.useState)(!1),O=Object(s.a)(C,2),j=O[0],k=O[1],w=Object(r.useState)(!1),x=Object(s.a)(w,2),N=x[0],S=x[1],T=Object(r.useCallback)((function(){m(!1),h(!1),c(!0),S(!1)}),[]),I=Object(r.useCallback)((function(){m(!1),c(!1),h(!0)}),[]),R=Object(r.useCallback)((function(){c(!1),h(!1),m(!0)}),[]),P=Object(r.useCallback)((function(){h(!1),E(!0)}),[]),L=Object(r.useCallback)((function(){S(!0),k(!1)}),[]),B=Object(r.useCallback)((function(){c(!0)}),[]),D=Object(r.useCallback)((function(){c(!1)}),[]),M=Object(r.useCallback)((function(){m(!0)}),[]),A=Object(r.useCallback)((function(){m(!1)}),[]),F=Object(r.useCallback)((function(){h(!1)}),[]),q=Object(r.useCallback)((function(){E(!1)}),[]),z=Object(r.useCallback)((function(){k(!1)}),[]),W=Object(r.useCallback)((function(){S(!1)}),[]);return o.a.createElement(Ir.Provider,{value:{openLoginModal:B,closeLoginModal:D,openSignupModal:M,closeSignupModal:A}},o.a.createElement(Tr,{openLogin:i,openSignup:d,openReset:f,openLinkSent:g,openNewPassword:j,openPasswordReset:N,switchToLogin:T,switchToReset:I,switchToSignup:R,switchToLinkSent:P,switchToPasswordReset:L,closeLoginModal:D,closeSignupModal:A,closeResetModal:F,closeLinkSentModal:q,closeNewPasswordModal:z,closePasswordResetModal:W}),t)})),Pr=function(){return Object(r.useContext)(Ir)},Lr=Object(r.memo)((function(){var e=yr(),t=Pr(),a=t.openLoginModal,n=t.openSignupModal;return o.a.createElement("div",{className:e.landing},o.a.createElement(Mr,{openLogin:a,openSignup:n}),o.a.createElement(zr,null),o.a.createElement(Ur,null))})),Br=a(1131),Dr=a.n(Br),Mr=Object(r.memo)((function(e){var t=e.openLogin,a=e.openSignup,n=yr(),r=v().resetCurrentCriteria;return o.a.createElement("header",{className:n.header},o.a.createElement(l.b,{to:"/",onClick:r,className:n.logoLink},o.a.createElement("img",{src:Dr.a,alt:"logo",className:n.logo})),o.a.createElement("div",{className:n.headerButtons},o.a.createElement(Ht.a,{className:Object(pa.a)(n.authButton,n.signupButton),onClick:a},"SIGN UP"),o.a.createElement(Ht.a,{className:Object(pa.a)(n.authButton,n.loginButton),onClick:t},"LOGIN")))})),Ar=a(1133),Fr=a(1132),qr=a.n(Fr),zr=Object(r.memo)((function(){var e=yr();return o.a.createElement("div",{className:e.landingBody},o.a.createElement("div",{className:e.landingContent},o.a.createElement("div",{className:Object(pa.a)(e.text,e.mainText)},"A simple app to build customized clinical pathways"),o.a.createElement("div",{className:Object(pa.a)(e.text,e.subText)},"using"," ",o.a.createElement("a",{href:"https://mcodeinitiative.org/",className:e.link,target:"_blank",rel:"noopener noreferrer"},"mCODE"),", a standardized data model around cancer"),o.a.createElement(l.b,{to:"/demo",className:e.tryItButton},o.a.createElement(Ht.a,null,"Try It")),o.a.createElement("div",{className:e.socialMedia},o.a.createElement("a",{href:"https://github.com/mcode/pathway-builder",target:"_blank",rel:"noopener noreferrer"},o.a.createElement(H.a,{className:e.iconGithub},o.a.createElement(d.a,{icon:Ar.a}))),o.a.createElement(H.a,{className:e.iconEmail},o.a.createElement("div",{className:e.iconEmailCircle},o.a.createElement(d.a,{icon:m.k}))))),o.a.createElement(o.a.Fragment,null,o.a.createElement("img",{src:qr.a,alt:"pathway",className:e.exampleImage})))})),Wr=a(1134),_r=a.n(Wr),Hr=a(1135),Gr=a.n(Hr),Ur=Object(r.memo)((function(){var e=yr();return o.a.createElement("footer",{className:e.footer},o.a.createElement("a",{href:"https://www.mitre.org/",target:"_blank",rel:"noopener noreferrer",className:e.footerLogo},o.a.createElement("img",{src:_r.a,alt:"mitre logo",className:e.mitreLogo})),o.a.createElement("a",{href:"https://mcodeinitiative.org/",target:"_blank",rel:"noopener noreferrer",className:e.footerLogo},o.a.createElement("img",{src:Gr.a,alt:"mcode logo",className:e.mcodeLogo})))})),Kr=(a(1602),Object(U.a)((function(e){return{root:{color:e.palette.common.white,backgroundColor:e.palette.secondary.main,padding:"15px 0px 15px 35px"},icon:{marginRight:"10px"},underline:{textDecoration:"underline","&:hover":{cursor:"pointer"}}}}))),Qr=function(){var e=Kr(),t=Pr(),a=t.openLoginModal,n=t.openSignupModal;return o.a.createElement("div",{className:e.root},o.a.createElement(d.a,{icon:m.l,className:e.icon}),"You are currently viewing syntheic demo data. Any changes made will not be saved. To create your own pathways,"," ",o.a.createElement("span",{className:e.underline,onClick:a},"login")," ","or"," ",o.a.createElement("span",{className:e.underline,onClick:n},"sign up"),".")},Vr=Object(r.memo)((function(){var e=v().resetCurrentCriteria,t=Object(r.useState)(null),a=Object(s.a)(t,2),n=a[0],i=a[1],c=B(),u=Object(r.useCallback)((function(e){i(e.currentTarget)}),[]),f=Object(r.useCallback)((function(){i(null)}),[]),h=Object(r.useCallback)((function(){c(),f()}),[c,f]);return o.a.createElement(o.a.Fragment,null,o.a.createElement("header",{className:z.a.header},o.a.createElement(l.b,{to:"/",className:z.a.homeLink,onClick:e},o.a.createElement("img",{src:F.a,alt:"logo",className:z.a.logo})),o.a.createElement("button",{onClick:u,"aria-controls":"options-menu","aria-haspopup":"true"},o.a.createElement(d.a,{icon:m.h})),o.a.createElement(p.a,{id:"options-menu",anchorEl:n,keepMounted:!0,open:Boolean(n),onClose:f},o.a.createElement(b.a,{onClick:h},"Toggle Theme"))),o.a.createElement(Qr,null))}));function Jr(e){return fetch(e,{headers:{Accept:"application/json"}})}function Yr(e,t,a){return fetch(e,a).then((function(e){return t?e.text():e.json()}))}var $r=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=Object(r.useState)({status:"loading"}),n=Object(s.a)(a,2),o=n[0],i=n[1];return Object(r.useEffect)((function(){Jr(e).then((function(e){return e.json()})).then((function(a){return a.map((function(a){return Yr(e+"/"+a,t)}))})).then((function(e){return Promise.all(e)})).then((function(e){return i({status:"loaded",payload:e})})).catch((function(e){return i({status:"error",error:e})}))}),[e,t]),o};var Xr=function(e){var t=Object(r.useState)(e),a=Object(s.a)(t,2),n=a[0],o=a[1],i=Object(r.useRef)(n);return Object(r.useEffect)((function(){i.current=n}),[n]),[n,i,o]},Zr=Object(r.createContext)({}),eo=Object(r.memo)((function(e){var t=e.children,a=Object(r.useState)([]),n=Object(s.a)(a,2),i=n[0],c=n[1],l="".concat(X.a.get("demoCriteria"),"default_criteria.json");Object(r.useEffect)((function(){fetch(l,{headers:{Accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){return c(e)}))}),[l]);var u=Object(r.useCallback)((function(e){Ia(e).then((function(t){t.length>0?c((function(a){return a.find((function(t){return t.cql===e}))?a:[].concat(Object(pe.a)(a),Object(pe.a)(t))})):alert("No valid criteria were found in the provided file")}))}),[]),d=Object(r.useCallback)((function(e){var t=new FileReader;t.onload=function(){var t=Object(se.a)(ue.a.mark((function t(a){var n,r,o,i,c,l,s,d,m,p;return ue.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(null===(n=a.target)||void 0===n?void 0:n.result)){t.next=29;break}if(r=a.target.result,!e.name.endsWith(".cql")){t.next=6;break}u(r),t.next=27;break;case 6:if(!e.name.endsWith(".zip")){t.next=27;break}return o={},t.next=10,rt.a.loadAsync(e);case 10:i=t.sent,c=Object.values(i.files),l=0;case 13:if(!(l<c.length)){t.next=26;break}if(s=c[l],(d=s.name).endsWith(".cql")&&!d.startsWith("__MACOSX/")){t.next=18;break}return t.abrupt("continue",23);case 18:return t.next=20,s.async("string");case 20:m=t.sent,p=s.name.slice(0,-4),o[p]={cql:m};case 23:l++,t.next=13;break;case 26:u(o);case 27:t.next=30;break;case 29:alert("Unable to read that file");case 30:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),t.readAsText(e)}),[u]),m=Object(r.useCallback)((function(e){c((function(t){return t.filter((function(t){return t.id!==e}))}))}),[]),p=Object(r.useCallback)((function(e,t,a){return Ra(e,t).then((function(e){if(a){var t=i.find((function(e){return e.id===a}));t&&(e.id=t.id,c((function(a){return[].concat(Object(pe.a)(a.filter((function(e){return e.id!==t.id}))),[e])})))}else c((function(t){return[].concat(Object(pe.a)(t),[e])}));return e}))}),[i]);return o.a.createElement(Zr.Provider,{value:{criteria:i,addCriteria:d,addCqlCriteria:u,deleteCriteria:m,addBuilderCriteria:p}},t)})),to=function(){return Object(r.useContext)(Zr)},ao=Object(r.createContext)({}),no=Object(r.memo)((function(e){var t=e.children,a=Xr([]),n=Object(s.a)(a,3),i=n[0],c=n[1],l=n[2],u=$r(X.a.get("demoPathwaysService")),d=u.payload,m=to().addCqlCriteria,p=Object(r.useCallback)((function(e){l((function(t){return[].concat(Object(pe.a)(t),[e])}))}),[l]),b=Object(r.useCallback)((function(e){e.library.forEach((function(e){return m(e)}))}),[m]),f=Object(r.useCallback)((function(e){var t=new FileReader;t.onload=function(e){var t;if(null===(t=e.target)||void 0===t?void 0:t.result){var a=e.target.result,n=JSON.parse(a);l((function(e){return e.map((function(e){return e.id})).includes(n.id)?(alert("Pathway with that id already exists!"),e):(b(n),[].concat(Object(pe.a)(e),[n]))}))}else alert("Unable to read that file")},t.readAsText(e)}),[b,l]),h=Object(r.useCallback)((function(e){l((function(t){return t.filter((function(t){return t.id!==e}))}))}),[l]),v=Object(r.useCallback)((function(e){var t=c.current.findIndex((function(t){return t.id===e.id}));l((function(a){return[].concat(Object(pe.a)(a.slice(0,t)),[e],Object(pe.a)(a.slice(t+1)))}))}),[c,l]);switch(Object(r.useEffect)((function(){d&&l(d)}),[d,l]),u.status){case"error":return o.a.createElement("div",null,"Error loading pathways");default:return o.a.createElement(ao.Provider,{value:{pathways:i,addPathway:p,addPathwayFromFile:f,deletePathway:h,updatePathway:v,status:u.status}},t)}})),ro=function(){return Object(r.useContext)(ao)},oo=Object(r.createContext)({}),io=Object(r.memo)((function(e){var t=e.children,a=V(null),n=Object(s.a)(a,8),i=n[0],c=n[1],l=n[2],u=n[3],d=n[4],m=n[5],p=n[6],b=n[7],f=to().criteria,h=ro().updatePathway,v=Object(r.useCallback)((function(){d()}),[d]),y=Object(r.useCallback)((function(){m()}),[m]),g=Object(r.useCallback)((function(e){p(e)}),[p]),E=Object(r.useCallback)((function(e){b(e)}),[b]);return Object(r.useEffect)((function(){i&&h(i)}),[i,h]),Object(r.useEffect)((function(){if(i){var e=it(i,f),t=e.updated,a=e.newPathway;t&&g(a)}}),[f,i,g]),o.a.createElement(oo.Provider,{value:{pathway:i,pathwayRef:c,canUndoPathway:l,canRedoPathway:u,undoPathway:v,redoPathway:y,resetCurrentPathway:g,setCurrentPathway:E}},o.a.createElement(J.a,{keyName:"control+z,command+z",onKeyDown:v},o.a.createElement(J.a,{keyName:"control+y,command+y",onKeyDown:y},t)))})),co=function(){return Object(r.useContext)(oo)},lo=function(e){var t=e.pathway,a=e.allPathways,n=e.criteria,i=e.anchorEl,c=e.closeMenu,l=Object(r.useState)(!1),u=Object(s.a)(l,2),d=u[0],m=u[1],f=Object(r.useCallback)((function(){return m(!1)}),[m]),h=Object(r.useCallback)((function(e){t?(m(!0),lt(t,a,n,e).then((function(){return m(!1)}))):alert("No pathway to download!"),c()}),[t,a,n,m,c]),v=Object(r.useCallback)((function(){return h(!1)}),[h]),y=Object(r.useCallback)((function(){return h(!0)}),[h]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(p.a,{id:"pathway-options-menu",anchorEl:i,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,open:Boolean(i),onClose:c},o.a.createElement(b.a,{onClick:v},"Export Pathway",(null===t||void 0===t?void 0:t.length)&&t.length>1?"s":""),o.a.createElement(b.a,{onClick:y},"Export to CPG")),o.a.createElement(Ut,{handleShowModal:d,handleCloseModal:f,headerTitle:"Pathway Exporting",headerSubtitle:"Please wait while the pathway exports."},o.a.createElement(Vt,null)))},uo=function(e){var t=e.anchorEl,a=e.closeMenu,n=co().pathway,r=ro().pathways,i=to().criteria;return o.a.createElement(lo,{pathway:n?[n]:null,allPathways:r,criteria:i,anchorEl:t,closeMenu:a})},so=Object(r.memo)(lo),mo=function(){var e=v().resetCurrentCriteria,t=Object(r.useState)(null),a=Object(s.a)(t,2),n=a[0],i=a[1],c=co(),l=c.pathway,p=c.canUndoPathway,b=c.canRedoPathway,f=c.undoPathway,h=c.redoPathway,y=K(),g=Object(u.g)(),E=Object(r.useCallback)((function(e){i(e.currentTarget)}),[]),C=Object(r.useCallback)((function(){i(null)}),[]),O=Object(r.useCallback)((function(){e(),g.push("/demo")}),[g,e]);return o.a.createElement("nav",{className:y.root},o.a.createElement("div",null,o.a.createElement(H.a,{className:y.backButton,onClick:O,"aria-label":"go back"},o.a.createElement(d.a,{icon:m.f,className:y.navigationIcons})),o.a.createElement("span",{className:y.pathwayName},null===l||void 0===l?void 0:l.name)),o.a.createElement("div",null,o.a.createElement(G.a,{placement:"top",title:"Undo",arrow:!0},o.a.createElement("span",null,o.a.createElement(H.a,{onClick:f,disabled:!p,"aria-label":"undo"},o.a.createElement(d.a,{icon:m.F,className:y.navigationIcons})))),o.a.createElement(G.a,{placement:"top",title:"Redo",arrow:!0},o.a.createElement("span",null,o.a.createElement(H.a,{onClick:h,disabled:!b,"aria-label":"redo"},o.a.createElement(d.a,{icon:m.x,className:y.navigationIcons})))),o.a.createElement(H.a,{onClick:E,"aria-controls":"pathway-options-menu","aria-haspopup":"true"},o.a.createElement(d.a,{icon:m.j,className:y.navigationIcons})),o.a.createElement(uo,{anchorEl:n,closeMenu:C})))},po=Object(r.memo)((function(e){var t=e.currentNode,a=co(),n=a.pathway,i=a.pathwayRef,c=a.setCurrentPathway,l=sa(n),u=Zt(),d=Object(r.useState)(!1),p=Object(s.a)(d,2),b=p[0],f=p[1],h=t&&n?Ie(n,t):[],v=h.length>0,y=Object(r.useCallback)((function(e){i.current&&l&&c(gt(i.current,l.key,e)),f(!1)}),[c,l,i]),g=Object(r.useCallback)((function(){f(!b)}),[b]);return o.a.createElement("div",null,!b&&o.a.createElement(ha,{buttonName:"Connect Node",buttonIcon:m.q,buttonText:"Create a transition to an existing node in the pathway.",onClick:g,disabled:!v,hasTooltip:!v,tooltipTitle:"There are no possible nodes to connect to."}),b&&v&&o.a.createElement("div",{className:u.connectDropdown},o.a.createElement(oa,{id:"transitions",label:"Node To Connect To",options:h,onChange:y}),o.a.createElement("div",{className:u.connectText},"Select node from list to add transition.",o.a.createElement(Ht.a,{className:u.cancelButtonDropdown,size:"small",variant:"text",onClick:g},"Cancel"))))})),bo=Object(r.memo)((function(e){var t=e.currentNode,a=co(),n=a.pathway,i=a.pathwayRef,c=a.setCurrentPathway,l=sa(n),p=Object(r.useState)(!0),b=Object(s.a)(p,2),f=b[0],h=b[1],v=Zt(),y=Object(u.g)(),g=Object(r.useRef)(null),E=Object(r.useCallback)((function(){h(!f)}),[f]),C=Object(r.useCallback)((function(e){l&&i.current&&c(vt(i.current,l.key,e))}),[i,c,l]),O=Object(r.useCallback)((function(){if(l&&i.current){var e=pt(),t=bt(i.current,e);t=gt(t,l.key,e.key),c(t),Ee(l)||Te(i.current.id,e.key,y,!0)}}),[i,c,l,y]);if(!n)return o.a.createElement("div",null,"Error: No pathway");if(!t)return o.a.createElement("div",null,"Error: No current node");if("start"===t.type)return o.a.createElement(o.a.Fragment,null,f&&o.a.createElement("div",{className:v.root,ref:g},o.a.createElement(fo,{node:t,isTransition:!1}),o.a.createElement("h5",{className:v.dividerHeader},o.a.createElement(o.a.Fragment,null)," "),o.a.createElement(ha,{buttonName:"Add Node",buttonIcon:m.u,buttonText:"Add a new transition to a new node in the pathway.",onClick:O})),o.a.createElement("div",{className:v.toggleSidebar,onClick:E},o.a.createElement(d.a,{icon:f?m.f:m.g})),o.a.createElement(ua,null));var j=ye(t),k="start"!==j||0===t.transitions.length;return o.a.createElement(o.a.Fragment,null,f&&o.a.createElement("div",{className:v.root,ref:g},o.a.createElement(fo,{node:t,isTransition:!1}),o.a.createElement("h5",{className:v.dividerHeader},o.a.createElement("span",null,"Details")),"null"===j&&o.a.createElement(oa,{id:"nodeType",label:"Node Type",options:Oe,onChange:C,value:""}),"reference"===j&&o.a.createElement(yo,{changeNodeType:C,currentNode:t}),"action"===j&&o.a.createElement(vo,{changeNodeType:C,currentNode:t}),"branch"===j&&o.a.createElement(oa,{id:"nodeType",label:"Node Type",options:Oe,onChange:C,value:"Observation"}),o.a.createElement("h5",{className:v.dividerHeader},o.a.createElement("span",null,"Transitions")),null===t||void 0===t?void 0:t.transitions.map((function(e){return o.a.createElement(Eo,{key:e.id,transition:e},"branch"===j&&o.a.createElement(go,{key:e.id,transition:e,currentNode:t}))})),k&&o.a.createElement(o.a.Fragment,null,o.a.createElement(ha,{buttonName:"Add New Node",buttonIcon:m.u,buttonText:"Add a new transition to a new node in the pathway.",onClick:O}),o.a.createElement(po,{currentNode:t}))),o.a.createElement("div",{className:v.toggleSidebar,onClick:E},o.a.createElement(d.a,{icon:f?m.f:m.g})),o.a.createElement(ua,null))})),fo=Object(r.memo)((function(e){var t=e.node,a=e.isTransition,n=void 0!==a&&a,i=Object(r.useState)(!1),c=Object(s.a)(i,2),l=c[0],p=c[1],b=Object(r.useState)(!1),f=Object(s.a)(b,2),h=f[0],v=f[1],y=Object(r.useState)(!1),g=Object(s.a)(y,2),E=g[0],C=g[1],O=la(),j=O.setSnackbarText,k=O.setOpenSnackbar,w=co(),x=w.pathway,N=w.pathwayRef,S=w.setCurrentPathway,T=sa(x),I=Object(r.useRef)(null),R=(null===t||void 0===t?void 0:t.label)||"",P=Zt(),L=Object(u.g)(),B=Object(r.useCallback)((function(){if(N.current){var e=ke(N.current.nodes,t.key);Te(N.current.id,e[0],L,!0)}}),[L,N,t.key]),D=Object(r.useCallback)((function(){N.current&&Te(N.current.id,t.key,L,!0)}),[L,N,t.key]),M=Object(r.useCallback)((function(){var e,a,n=null!==(e=null===(a=I.current)||void 0===a?void 0:a.value)&&void 0!==e?e:"";N.current&&S(ft(N.current,t.key,n)),p(!1)}),[N,S,t.key]),A=Object(r.useCallback)((function(){p(!0)}),[]),F=Object(r.useCallback)((function(){if(N.current&&Se(N.current,t.transitions)){var e=ke(N.current.nodes,t.key);S(St(N.current,t.key)),Te(N.current.id,e[0],L,!0),C(!1),j("".concat(t.label," node deleted successfully")),k(!0)}}),[N,S,j,k,t.key,t.label,t.transitions,L]),q=Object(r.useCallback)((function(){T&&N.current&&!Ne(N.current,t.key)&&(S(It(N.current,T.key,t.key)),C(!1),j("Transition from ".concat(T.label," to ").concat(t.label," deleted successfully")),k(!0))}),[N,T,S,j,k,t]),z=Object(r.useCallback)((function(){C(!0)}),[]),W=Object(r.useCallback)((function(){C(!1)}),[]),_=Object(r.useCallback)((function(){v(!0)}),[]),U=Object(r.useCallback)((function(){v(!1)}),[]),K=Object(r.useCallback)((function(e){"Enter"===e.key&&M()}),[M]),Q=!x||!Se(x,t.transitions),V=!x||Ne(x,t.key),J=n?V:Q,Y=n?"Deleting this transition would result in an orphaned node. To delete, first add the child node as a transition to another node, or delete it directly.":"Deleting this node would result in an orphaned descendent node. To delete, first add another transition to the would-be orphaned node from another node, or delete it directly.";return o.a.createElement("div",{className:P.sidebarHeader},o.a.createElement("div",{className:P.sidebarHeaderGroup},"start"!==t.type&&!n&&o.a.createElement(H.a,{className:P.sidebarHeaderButton,onClick:B,"aria-label":"go to parent node"},o.a.createElement(d.a,{icon:m.f})),o.a.createElement("div",{className:P.headerLabelGroup,onClick:A},l&&"start"!==t.type?o.a.createElement(ta.a,{className:P.formControl,fullWidth:!0},o.a.createElement(ba.a,{className:P.headerLabel,type:"text",inputRef:I,onBlur:M,onKeyPress:K,defaultValue:R,autoFocus:!0,onFocus:function(e){return e.target.select()}})):o.a.createElement("div",{className:Object(pa.a)(P.headerLabel,P.headerLabelText,"start"===t.type&&P.headerLabelStart)},R,"Start"!==t.key&&o.a.createElement(d.a,{className:P.editIcon,icon:m.i})))),o.a.createElement("div",{className:P.sidebarHeaderGroup},"start"!==t.type&&o.a.createElement(G.a,{placement:"top",open:!!J&&h,onClose:U,onOpen:_,title:Y,arrow:!0},o.a.createElement("span",null,o.a.createElement(H.a,{className:P.sidebarHeaderButton,onClick:z,"aria-label":n?"delete transition":"delete node",disabled:J},o.a.createElement(d.a,{icon:m.E})))),n&&o.a.createElement(H.a,{className:P.sidebarHeaderButton,onClick:D,"aria-label":"go to transition node"},o.a.createElement(d.a,{icon:m.g}))),o.a.createElement(Da,{nodeLabel:t.label,isTransition:n,open:E,onDelete:n?q:F,onClose:W}))})),ho=[{label:"ICD-9-CM",value:"http://hl7.org/fhir/sid/icd-9-cm"},{label:"ICD-10-CM",value:"http://hl7.org/fhir/sid/icd-10-cm"},{label:"LOINC",value:"http://loinc.org"},{label:"NCI",value:"http://ncimeta.nci.nih.gov"},{label:"RXNORM",value:"http://www.nlm.nih.gov/research/umls/rxnorm"},{label:"SNOMED",value:"http://snomed.info/sct"}],vo=Object(r.memo)((function(e){var t=e.currentNode,a=e.changeNodeType,i=co(),c=i.pathway,l=i.pathwayRef,u=i.setCurrentPathway,s=sa(c),p=Zt(),b=Object(r.useCallback)((function(e){var t=s;if(t.action&&l.current){var a=(null===e||void 0===e?void 0:e.target.value)||"",n=Ot(t.action,a);u(yt(l.current,t.key,g(n)))}}),[s,l,u]),f=Object(r.useCallback)((function(e){var t=s;if(t.action&&l.current){var a=(null===e||void 0===e?void 0:e.target.value)||"",n=kt(t.action,a);u(yt(l.current,t.key,n))}}),[s,l,u]),h=Object(r.useCallback)((function(e){var t=s;if(t.action&&l.current){var a=(null===e||void 0===e?void 0:e.target.value)||"",n=wt(t.action,a),r=yt(l.current,t.key,g(n));u(r)}}),[s,l,u]),v=Object(r.useCallback)((function(e){var t=s;if(t.action&&l.current){var a=jt(t.action,e);u(yt(l.current,t.key,g(a)))}}),[s,l,u]),y=Object(r.useCallback)((function(){var e=s;if(e.action&&l.current){var t=xt(e.action,"Example Text"),a=yt(l.current,e.key,t);u(a)}else console.error("No Actions -- Cannot Validate")}),[s,l,u]),g=function(e){return Object(n.a)(e,(function(e){e.resource.medicationCodeableConcept?e.resource.medicationCodeableConcept.coding[0].display="":"CarePlan"===e.resource.resourceType?e.resource.description="":e.resource.code.coding[0].display=""}))},E=function(e){"Enter"===e.key&&y()},C=t.action;if(!C)return o.a.createElement(o.a.Fragment,null);var O=(null===t||void 0===t?void 0:t.key)&&"start"!==t.type,j=C.resource,k="",w="",x="";return"MedicationRequest"===j.resourceType||"ServiceRequest"===j.resourceType?(k=j.code?j.code.coding[0].system:j.medicationCodeableConcept.coding[0].system,w=j.code?j.code.coding[0].code:j.medicationCodeableConcept.coding[0].code,x=j.code?j.code.coding[0].display:j.medicationCodeableConcept.coding[0].display):x=j.description,o.a.createElement(o.a.Fragment,null,O&&o.a.createElement(o.a.Fragment,null,o.a.createElement(oa,{id:"nodeType",label:"Node Type",options:Oe,onChange:a,value:j.resourceType}),("MedicationRequest"===j.resourceType||"ServiceRequest"===j.resourceType)&&o.a.createElement(o.a.Fragment,null,o.a.createElement(oa,{id:"codeSystem",label:"Code System",options:ho,onChange:v,value:k}),k&&o.a.createElement(ea.a,{id:"code-input",label:"Code",value:w,onChange:b,variant:"outlined",error:""===w,inputProps:{onKeyPress:E}}),w&&o.a.createElement(o.a.Fragment,null,x?o.a.createElement("div",{className:p.displayText},o.a.createElement(d.a,{icon:m.e})," ",x):o.a.createElement(ha,{buttonName:"Validate",buttonIcon:m.e,buttonText:x||"Check validation of the input system and code",onClick:y}),o.a.createElement(ea.a,{id:"description-input",label:"Description",value:C.description||"",onChange:f,variant:"outlined",error:""===C.description}))),"CarePlan"===j.resourceType&&o.a.createElement(o.a.Fragment,null,o.a.createElement(ea.a,{id:"title-input",label:"Title",value:j.title||"",onChange:h,variant:"outlined",error:null==j.title,inputProps:{onKeyPress:E}}),j.title&&o.a.createElement(ea.a,{id:"description-input",label:"Description",value:C.description||"",onChange:f,variant:"outlined",error:""===C.description}))))})),yo=Object(r.memo)((function(e){var t=e.currentNode,a=e.changeNodeType,n=ro(),i=n.pathways,c=n.updatePathway,l=co(),s=l.pathway,p=l.pathwayRef,b=l.setCurrentPathway,f=sa(s),h=Object(u.g)(),v=i.map((function(e){return{label:e.name,value:e.id}})),y=Zt(),g=Object(r.useCallback)((function(){var e=t.referenceId,a=i.find((function(t){return t.id===e}));a&&b(a)}),[t,i,b]),E=Object(r.useCallback)((function(e){var t,a=(null===(t=v.find((function(t){return t.value===e})))||void 0===t?void 0:t.label)||"";f&&p.current&&c(ht(p.current,f.key,e,a))}),[f,v,p,c]),C=(null===t||void 0===t?void 0:t.key)&&"start"!==t.type;return o.a.createElement(o.a.Fragment,null,C&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",null,o.a.createElement(oa,{id:"nodeType",label:"Node Type",options:Oe,onChange:a,value:"Reference"}),o.a.createElement("div",{className:y.referenceDropdown},o.a.createElement(oa,{id:"reference",label:"Pathway Reference",options:v,onChange:E,value:t.referenceId}),o.a.createElement("div",{className:y.referenceChevron},o.a.createElement(d.a,{icon:m.g,onClick:function(){g(),Te(t.referenceId,"",h,!0)}}))))))})),go=Object(r.memo)((function(e){var t,a,n,i,c,l,u,p,b,f,h,y=e.transition,g=(e.currentNode,to()),E=g.criteria,C=g.addBuilderCriteria,O=v(),j=O.buildCriteriaSelected,k=O.setBuildCriteriaSelected,w=O.currentCriteriaNodeId,x=O.setCurrentCriteriaNodeId,N=O.currentCriteria,S=O.setCurrentCriteria,T=O.criteriaName,I=O.setCriteriaName,R=O.resetCurrentCriteria,P=wa(),L=P.resetCriteriaBuilder,B=P.setCriteriaBuilder,D=co(),M=D.pathwayRef,A=D.setCurrentPathway,F=sa(M.current),q=Object(r.useMemo)((function(){return E.map((function(e){return{value:e.id,label:e.label}}))}),[E]),z=q.length>0,W=Zt(),_=Object(r.useState)(!1),H=Object(s.a)(_,2),G=H[0],U=H[1],K=Object(r.useState)(!1),Q=Object(s.a)(K,2),V=Q[0],J=Q[1],Y=null===(t=y.condition)||void 0===t?void 0:t.description,$=null!=Y,X=Y&&""!==Y,Z=(null===(a=y.condition)||void 0===a?void 0:a.cql)||(null===(n=y.condition)||void 0===n?void 0:n.description),ee=Z?"DELETE":"CANCEL",te=Z?o.a.createElement(d.a,{icon:m.E}):null,ae=z&&(V||(null===(i=y.condition)||void 0===i?void 0:i.cql)||(null===(c=y.condition)||void 0===c?void 0:c.description)),ne=Object(r.useRef)(y),re=j&&w===y.id,oe=null;y.condition&&((null===(h=f=E.find((function(e){var t;return e.id===(null===(t=y.condition)||void 0===t?void 0:t.criteriaSource)})))||void 0===h?void 0:h.builder)&&(oe=f.builder));var ie=!re&&oe,ce=Object(r.useCallback)((function(){Z&&F&&M.current?(A(Tt(M.current,F.key,y.id)),J(!1)):J(!V)}),[V,F,M,Z,y.id,A]),le=Object(r.useCallback)((function(e){var t;if(F&&M.current){var a=E.find((function(t){return t.id===e}));if(a){var n=Et(M.current,F.key,ne.current.id,(null===(t=ne.current.condition)||void 0===t?void 0:t.description)||a.display,a);A(n)}}}),[F,A,M,ne,E]),ue=Object(r.useCallback)((function(e){if(F&&M.current){var t=(null===e||void 0===e?void 0:e.target.value)||"";A(Ct(M.current,F.key,y.id,t))}}),[F,y.id,A,M]),se=Object(r.useCallback)((function(e){I((null===e||void 0===e?void 0:e.target.value)||"")}),[I]),de=Object(r.useCallback)((function(){x(y.id),S(null),I(""),j||k(!0),L()}),[j,x,y,k,S,L,I]),me=Object(r.useCallback)((function(){var e,t;x(y.id),S(oe),(null===(e=f)||void 0===e?void 0:e.label)&&I(null===(t=f)||void 0===t?void 0:t.label),j||k(!0),oe&&B(oe)}),[j,f,oe,y,x,S,I,k,B]),pe=Object(r.useCallback)((function(){R(),L()}),[R,L]),be=Object(r.useCallback)((function(){var e;F&&M.current&&(null===N||void 0===N?void 0:N.cql)&&(U(!0),C(N,T,null===(e=y.condition)||void 0===e?void 0:e.criteriaSource).then((function(e){var t=Et(M.current,F.key,ne.current.id,T,e);A(t),pe(),U(!1)})))}),[F,A,M,ne,N,T,y,pe,C,U]);return o.a.createElement(o.a.Fragment,null,!ae&&!re&&o.a.createElement(ha,{buttonName:"Select Criteria",buttonIcon:m.B,buttonColor:"secondary",buttonText:"Add previously built or imported criteria logic to branch node.",onClick:ce,disabled:!z,hasTooltip:!z,tooltipTitle:"No criteria to select. Add criteria to use."}),ae&&!re&&!ie&&o.a.createElement(Ba,{label:"Criteria Selector",error:!$||!X},o.a.createElement(o.a.Fragment,null,o.a.createElement(oa,{id:"Criteria",label:"Criteria",options:q,onChange:le,value:(null===(l=y.condition)||void 0===l?void 0:l.criteriaSource)||void 0}),o.a.createElement(ea.a,{label:"Criteria Display",className:W.criteriaText,value:(null===(u=y.condition)||void 0===u?void 0:u.description)||"",variant:"outlined",onChange:ue,error:!X,helperText:'Use commas "," to separate into multiple lines (up to 3)'})),o.a.createElement(Ht.a,{className:W.cancelButton,color:"inherit",size:"small",variant:"outlined",startIcon:te,onClick:ce},ee)),ie&&o.a.createElement(Ba,{label:"Criteria Builder",error:!1},o.a.createElement(ea.a,{label:"Criteria Name",variant:"outlined",value:null===(p=f)||void 0===p?void 0:p.label,fullWidth:!0,disabled:!0}),o.a.createElement("span",{className:W.buildCriteriaText},null===(b=oe)||void 0===b?void 0:b.text),o.a.createElement("div",{className:W.buildCriteriaContainer},o.a.createElement(Ht.a,{className:W.cancelButton,color:"inherit",size:"small",variant:"outlined",startIcon:te,onClick:ce},"DELETE CRITERIA"),o.a.createElement(Ht.a,{className:W.editButton,color:"inherit",size:"small",variant:"outlined",startIcon:o.a.createElement(d.a,{icon:m.i}),onClick:me},"EDIT CRITERIA"))),!ae&&!re&&o.a.createElement(ha,{buttonName:"Build Criteria",buttonColor:"secondary",buttonIcon:m.D,buttonText:"Create new criteria logic to add to branch node.",extraMargin:!0,onClick:de}),re&&o.a.createElement(Ba,{label:"Criteria Builder",error:!$||!X},o.a.createElement(ea.a,{error:""===T,label:"Criteria Name",variant:"outlined",onChange:se,value:T,fullWidth:!0}),(null===N||void 0===N?void 0:N.text)&&o.a.createElement("span",{className:W.buildCriteriaText},N.text),o.a.createElement("div",{className:W.buildCriteriaContainer},o.a.createElement(Ea.a,{label:o.a.createElement(Ca.a,{fontStyle:"italic"},"Add to reusable criteria"),control:o.a.createElement(Oa.a,{color:"default"}),checked:!0}),o.a.createElement(Ht.a,{color:"inherit",size:"large",variant:"outlined",onClick:pe},"Cancel"),o.a.createElement(Ht.a,{className:W.saveButton,color:"inherit",size:"large",variant:"outlined",startIcon:o.a.createElement(d.a,{icon:m.y}),endIcon:G?o.a.createElement(d.a,{icon:m.z,spin:!0}):null,disabled:""===T||null===N||G,onClick:be},"Save"))))})),Eo=Object(r.memo)((function(e){var t=e.transition,a=e.children,n=Zt(),r=co().pathway,i=(null===t||void 0===t?void 0:t.transition)||"",c=null===r||void 0===r?void 0:r.nodes[i];return o.a.createElement(Ma.a,{raised:!0,className:n.transitionContainer},c&&o.a.createElement(fo,{node:c,isTransition:!0}),a)})),Co=function(){var e=Object(u.h)().id,t=Object(u.g)();return Object(r.useCallback)((function(a){var n="/demo/builder/".concat(encodeURIComponent(e),"/node/").concat(encodeURIComponent(a));n!==t.location.pathname&&t.push(n)}),[t,e])},Oo=Object(r.memo)((function(e){var t,a=e.interactive,n=e.currentNode,i=co().pathway,c=fn(),l=c.expanded,u=c.toggleExpanded,d=c.openNode,m=Va().reflow,p=Ja().nodes,b=Co(),f=v().resetCurrentCriteria,h=Object(r.useCallback)((function(e){b(e),u(e),f()}),[b,u,f]),y=Object.entries(null!==(t=null===i||void 0===i?void 0:i.nodes)&&void 0!==t?t:{});return Object(qa.a)((function(){m()}),[y.length]),o.a.createElement(o.a.Fragment,null,y.map((function(e){var t,r=Object(s.a)(e,2),i=r[0],c=r[1],u=null!==(t=p[i])&&void 0!==t?t:{x:-999,y:-999};return o.a.createElement(pn,{key:i,nodeKey:i,pathwayNode:c,isActionable:c.key===(null===n||void 0===n?void 0:n.key),isExpanded:Boolean(l[i]),onClick:a?h:void 0,xCoordinate:u.x,yCoordinate:u.y,openNode:d})})))})),jo=Object(r.memo)((function(e){var t=e.interactive,a=void 0===t||t,n=e.currentNode;return o.a.createElement(Qa,null,o.a.createElement(Cn,null,o.a.createElement(Oo,{interactive:a,currentNode:n}),o.a.createElement(Za,{currentNode:n})))})),ko=Object(r.memo)((function(){var e=Nn(),t=Sn(),a=co().pathway,n=v().currentCriteriaNodeId,i=D("dark"),c=Object(r.useState)(!0),l=Object(s.a)(c,2),u=l[0],p=l[1],b=null;(null===a||void 0===a?void 0:a.nodes[t])?b=a.nodes[t]:a&&(b=a.nodes.Start);var f=Object(r.useCallback)((function(){p(!u)}),[u]);return Object(r.useEffect)((function(){u||""!==n||p(!0)}),[n,u]),o.a.createElement("div",{className:e.root},o.a.createElement("div",null,o.a.createElement(Vr,null),o.a.createElement(mo,null)),a&&o.a.createElement("div",{className:e.main},o.a.createElement(y.a,{theme:i},o.a.createElement(bo,{currentNode:b})),o.a.createElement("div",{className:e.graph},""!==n&&o.a.createElement("div",{className:e.graphHeader},o.a.createElement("div",{className:e.graphHeaderText},o.a.createElement("span",null,"Criteria Builder")),o.a.createElement(H.a,{className:"".concat(e.toggleButton,"-").concat(u?"on":"off"),onClick:f},o.a.createElement(d.a,{className:e.toggleIcon,icon:m.w}))),""!==n&&u?o.a.createElement(kn,null):o.a.createElement(jo,{currentNode:b}))))})),wo=Object(r.memo)((function(){var e=In(),t=Sn(),a=ro().pathways,n=co(),i=n.pathwayRef,c=n.setCurrentPathway,l=n.resetCurrentPathway,s=Object(r.useMemo)((function(){return a.findIndex((function(t){return t.id===e}))}),[e,a]),d=a[s];return Object(r.useEffect)((function(){var e;d&&(null===i||void 0===i||null===(e=i.current)||void 0===e?void 0:e.id)===d.id?c(d):d&&l(d)}),[d,i,c,l]),null==d?null:t?o.a.createElement(ko,null):o.a.createElement(u.a,{to:"/demo/builder/".concat(e,"/node/Start")})})),xo=Object(r.memo)((function(e){var t,a,i=e.open,c=e.onClose,l=e.editPathway,s=!l,p=Gn(),b=Object(u.g)(),f=Object(r.useRef)(null),h=Object(r.useRef)(null),v=ro(),y=v.addPathway,g=v.updatePathway,E=Object(r.useCallback)((function(e){b.push("/demo/builder/".concat(encodeURIComponent(e),"/node/Start")),c()}),[b,c]),C=Object(r.useCallback)((function(e){var t,a,n,r;e.preventDefault();var o=me.a.generate(),i=null!==(t=null===(a=f.current)||void 0===a?void 0:a.value)&&void 0!==t?t:"",c=null!==(n=null===(r=h.current)||void 0===r?void 0:r.value)&&void 0!==n?n:"";y(ot(i,c,o)),E(o)}),[y,E]),O=Object(r.useCallback)((function(e){var t,a;if(e.preventDefault(),l&&((null===(t=f.current)||void 0===t?void 0:t.value)!==l.name||(null===(a=h.current)||void 0===a?void 0:a.value)!==l.description)){var r=Object(n.a)(l,(function(e){var t,a;(null===(t=f.current)||void 0===t?void 0:t.value)&&(e.name=f.current.value),(null===(a=h.current)||void 0===a?void 0:a.value)&&(e.description=h.current.value)}));g(r)}c()}),[g,l,c]);if(l){t=l.name;var j=l.description;j&&""!==j&&(a=j)}return o.a.createElement(qt.a,{open:i,onClose:c,"aria-labelledby":"create-pathway",fullWidth:!0,maxWidth:"md"},o.a.createElement(zt.a,{disableTypography:!0},o.a.createElement(H.a,{"aria-label":"close",onClick:c,className:p.dialogCloseButton},o.a.createElement(d.a,{icon:m.C}))),o.a.createElement("form",{onSubmit:s?C:O},o.a.createElement(Wt.a,null,o.a.createElement(ea.a,{variant:"outlined",autoFocus:!0,label:"Pathway Name",fullWidth:!0,required:s,inputRef:f,defaultValue:s?void 0:t}),o.a.createElement(ea.a,{variant:"outlined",label:"Pathway Description",fullWidth:!0,inputRef:h,defaultValue:s?void 0:a,multiline:!0})),o.a.createElement(_t.a,null,o.a.createElement(Ht.a,{variant:"contained",color:"primary",startIcon:s&&o.a.createElement(d.a,{icon:m.u}),type:"submit"},s?"Create":"Save"))))})),No=Object(r.memo)((function(e){var t=e.itemSelected,a=e.handleSelectClick,n=Gn(),i=ro(),c=i.pathways,u=i.deletePathway,p=co().setCurrentPathway,b=Object(r.useState)(!1),f=Object(s.a)(b,2),h=f[0],v=f[1],y=Object(r.useState)(),g=Object(s.a)(y,2),E=g[0],C=g[1],O=Object(r.useState)(null),j=Object(s.a)(O,2),k=j[0],w=j[1],x=Object(r.useCallback)((function(e){v(!0),C(e)}),[]),N=Object(r.useCallback)((function(){v(!1)}),[]),S=Object(r.useCallback)((function(e){w(e.currentTarget);var t=c.filter((function(t){return t.id===e.currentTarget.id}));t.length&&p(t[0])}),[c,p]),T=Object(r.useCallback)((function(){w(null)}),[]),I=Object(r.useCallback)((function(e){u(e)}),[u]);return o.a.createElement("div",null,o.a.createElement(An.a,{className:n.pathwayList},o.a.createElement(Fn.a,{"aria-label":"pathway list"},o.a.createElement(qn.a,null,o.a.createElement(zn.a,null,o.a.createElement(Wn.a,{padding:"checkbox"}),o.a.createElement(Wn.a,null,"Pathway Name"),o.a.createElement(Wn.a,null,"Status"),o.a.createElement(Wn.a,null,"Last Updated"),o.a.createElement(Wn.a,null))),o.a.createElement(_n.a,null,c.map((function(e){return o.a.createElement(zn.a,{key:e.id},o.a.createElement(Wn.a,{padding:"checkbox"},o.a.createElement(Oa.a,{checked:t(e.id),onChange:a(e.id)})),o.a.createElement(Wn.a,{component:"th",scope:"row"},o.a.createElement(Hn.a,{component:l.b,to:"/demo/builder/".concat(encodeURIComponent(e.id)),color:"primary",underline:"none"},e.name)),o.a.createElement(Wn.a,null,"draft"),o.a.createElement(Wn.a,null,"2 days ago"),o.a.createElement(Wn.a,{align:"right"},o.a.createElement(Ht.a,{className:n.pathwaysListButton,color:"primary",size:"small",startIcon:o.a.createElement(d.a,{icon:m.i}),onClick:function(){return x(e)}},"Edit Info"),o.a.createElement(Ht.a,{id:e.id,className:n.pathwaysListButton,color:"primary",size:"small",startIcon:o.a.createElement(d.a,{icon:m.n}),onClick:S},"Export"),o.a.createElement(nr,{deleteType:"pathway",deleteName:e.name,deleteId:e.id,deleteMethod:I})))}))))),o.a.createElement(uo,{anchorEl:k,closeMenu:T}),o.a.createElement(xo,{open:h,onClose:N,editPathway:E}))})),So=Object(r.memo)((function(){var e=Gn(),t=Object(r.useState)(!1),a=Object(s.a)(t,2),n=a[0],i=a[1],c=ro(),l=c.status,u=c.pathways,p=c.deletePathway,b=Object(r.useState)(!1),f=Object(s.a)(b,2),h=f[0],v=f[1],y=Object(r.useState)(null),g=Object(s.a)(y,2),E=g[0],C=g[1],O=Object(r.useMemo)((function(){return u.map((function(e){return e.id}))}),[u]),j=cr(O),k=j.indeterminate,w=j.checked,x=j.handleSelectAllClick,N=j.itemSelected,S=j.handleSelectClick,T=j.selected,I=j.numSelected,R=to().criteria,P=ro().addPathwayFromFile,L=Object(r.useCallback)((function(){i(!0)}),[]),B=Object(r.useCallback)((function(){i(!1)}),[]),D=Object(r.useCallback)((function(e){(null===e||void 0===e?void 0:e.length)&&P(e[0])}),[P]),M=Object(r.useCallback)((function(){C(null)}),[]),A=Object(r.useCallback)((function(){return v(!0)}),[]),F=Object(r.useCallback)((function(){return v(!1)}),[]),q=Object(r.useCallback)((function(){T.forEach((function(e){p(e)}))}),[p,T]),z=Object(r.useState)([]),W=Object(s.a)(z,2),_=W[0],U=W[1],K=Object(r.useCallback)((function(e){U(u.filter((function(e){return T.has(e.id)}))),C(e.currentTarget)}),[u,T]);return o.a.createElement("div",{className:e.root},o.a.createElement("div",{className:e.tableTop},o.a.createElement("div",{className:e.selectionOptions},o.a.createElement(G.a,{placement:"top",title:"Select All",arrow:!0},o.a.createElement(Oa.a,{indeterminate:k,checked:w,onChange:x})),I>0&&o.a.createElement(o.a.Fragment,null,o.a.createElement(G.a,{placement:"top",title:"Export",arrow:!0},o.a.createElement(H.a,{size:"small",onClick:K},o.a.createElement(d.a,{icon:m.n,className:e.selectionIcon}))),o.a.createElement(G.a,{placement:"top",title:"Move to",arrow:!0},o.a.createElement(H.a,{size:"small"},o.a.createElement(d.a,{icon:m.o,className:e.selectionIcon}))),o.a.createElement(G.a,{placement:"top",title:"Delete",arrow:!0},o.a.createElement(ar,{onConfirm:q,displayText:"Are you sure that you would like to delete the selected pathway".concat(I>1?"s":"","?")},o.a.createElement(H.a,{size:"small"},o.a.createElement(d.a,{icon:m.E,className:e.deleteIcon})))))),o.a.createElement("div",{className:e.buttonRow},o.a.createElement(Ht.a,{className:e.createPathwayButton,variant:"contained",color:"primary",startIcon:o.a.createElement(d.a,{icon:m.p}),onClick:A},"Import Pathway"),o.a.createElement(Ht.a,{className:e.createPathwayButton,variant:"contained",color:"primary",startIcon:o.a.createElement(d.a,{icon:m.u}),onClick:L},"Create Pathway"))),o.a.createElement(ir,{open:h,onClose:F,onSelectFile:D,allowedFileType:".json"}),o.a.createElement(xo,{open:n,onClose:B}),o.a.createElement(so,{pathway:_,allPathways:u,criteria:R,anchorEl:E,closeMenu:M}),"loading"===l?o.a.createElement(Vt,null):o.a.createElement(No,{handleSelectClick:S,itemSelected:N}))})),To=Object(r.memo)((function(e){var t=e.itemSelected,a=e.handleSelectClick,n=dr(),i=to(),c=i.criteria,l=i.deleteCriteria,u=Object(r.useCallback)((function(e){l(e)}),[l]);return o.a.createElement(An.a,{className:n.criteriaList},o.a.createElement(Fn.a,{"aria-label":"criteria list"},o.a.createElement(qn.a,null,o.a.createElement(zn.a,null,o.a.createElement(Wn.a,{padding:"checkbox"}),o.a.createElement(Wn.a,null,"Criteria Name"),o.a.createElement(Wn.a,null,"Version"),o.a.createElement(Wn.a,null,"Added"),o.a.createElement(Wn.a,null))),o.a.createElement(_n.a,null,c.map((function(e){return o.a.createElement(zn.a,{key:e.id},o.a.createElement(Wn.a,{padding:"checkbox"},o.a.createElement(Oa.a,{checked:t(e.id),onChange:a(e.id)})),o.a.createElement(Wn.a,{component:"th",scope:"row"},e.label),o.a.createElement(Wn.a,null,e.version),o.a.createElement(Wn.a,null,(r=e.modified,sr()(r).fromNow())),o.a.createElement(Wn.a,{align:"right"},o.a.createElement(Ht.a,{className:n.editButton,color:"primary",size:"small",startIcon:o.a.createElement(d.a,{icon:m.i})},"Edit"),o.a.createElement(nr,{deleteType:"criterion",deleteName:e.label,deleteId:e.id,deleteMethod:u})));var r})))))})),Io=Object(r.memo)((function(){var e=dr(),t=ro().status,a=to(),n=a.criteria,i=a.addCriteria,c=a.deleteCriteria,l=Object(r.useState)(!1),u=Object(s.a)(l,2),p=u[0],b=u[1],f=Object(r.useMemo)((function(){return n.map((function(e){return e.id}))}),[n]),h=cr(f),v=h.indeterminate,y=h.checked,g=h.handleSelectAllClick,E=h.itemSelected,C=h.handleSelectClick,O=h.selected,j=h.setSelected,k=h.numSelected,w=Object(r.useCallback)((function(){b(!0)}),[]),x=Object(r.useCallback)((function(){b(!1)}),[]),N=Object(r.useCallback)((function(e){(null===e||void 0===e?void 0:e.length)&&i(e[0]),x()}),[i,x]),S=Object(r.useCallback)((function(){O.forEach((function(e){c(e),j(new Set)}))}),[c,O,j]);return o.a.createElement("div",{className:e.root},o.a.createElement("div",{className:e.tableTop},o.a.createElement("div",{className:e.selectionOptions},o.a.createElement(G.a,{placement:"top",title:"Select All",arrow:!0},o.a.createElement(Oa.a,{indeterminate:v,checked:y,onChange:g})),k>0&&o.a.createElement(o.a.Fragment,null,o.a.createElement(G.a,{placement:"top",title:"Delete",arrow:!0},o.a.createElement(ar,{onConfirm:S,displayText:"Are you sure that you would like to delete the selected ".concat(k>1?"criteria":"criterion","?")},o.a.createElement(H.a,{size:"small"},o.a.createElement(d.a,{icon:m.E,className:e.deleteIcon})))))),o.a.createElement("div",{className:e.buttonRow},o.a.createElement(Ht.a,{className:e.buildCriteriaButton,variant:"contained",color:"primary",startIcon:o.a.createElement(d.a,{icon:m.p}),onClick:w},"Import Library"),o.a.createElement(Ht.a,{className:e.buildCriteriaButton,variant:"contained",color:"primary",startIcon:o.a.createElement(d.a,{icon:m.D})},"Build Criteria"))),o.a.createElement(ir,{open:p,onClose:x,onSelectFile:N,allowedFileType:".cql, .zip"}),"loading"===t?o.a.createElement(Vt,null):o.a.createElement(To,{handleSelectClick:C,itemSelected:E}))})),Ro=Object(r.memo)((function(){return o.a.createElement(M,{theme:"light"},o.a.createElement(Ln,null,o.a.createElement(eo,null,o.a.createElement(no,null,o.a.createElement(io,null,o.a.createElement(ca,null,o.a.createElement(h,null,o.a.createElement(ka,null,o.a.createElement(l.a,null,o.a.createElement(u.d,null,o.a.createElement(u.b,{path:"/demo/builder/:id/node/:nodeId"},o.a.createElement(wo,null)),o.a.createElement(u.b,{path:"/demo/builder/:id"},o.a.createElement(wo,null)),o.a.createElement(u.b,{path:"/demo"},o.a.createElement(Vr,null),o.a.createElement(Mn,{tabs:[{label:"Pathway",component:o.a.createElement(So,null)},{label:"Criteria",component:o.a.createElement(Io,null)}]}))))))))))))}));c.a.render(o.a.createElement(M,{theme:"light"},o.a.createElement(Rr,null,o.a.createElement(l.a,null,o.a.createElement(u.d,null,o.a.createElement(u.b,{exact:!0,path:"/",component:Lr}),o.a.createElement(u.b,{path:"/builder",component:fr}),o.a.createElement(u.b,{path:"/demo",component:Ro}),o.a.createElement(u.b,{path:"/viz/",component:vr}))))),document.getElementById("root"))},171:function(e,t,a){e.exports={logo:"Header_logo__3T0lc",homeLink:"Header_homeLink__2ew4r"}},297:function(e,t,a){e.exports=a.p+"static/media/camino-logo-dark.c8fc712a.png"},382:function(e,t,a){e.exports={root:"Loading_root__3b6qy"}},94:function(e,t,a){"use strict";(function(e){var n=a(52),r=a(164),o=a(208),i=new(function(){function t(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(r.a)(this,t),this.config=e.CONFIG?Object(n.a)({},e.CONFIG,{},a):Object(n.a)({},a)}return Object(o.a)(t,[{key:"get",value:function(e,t){var a=e.split("."),n=this.config,r=null;for(var o in a){n=r=n[a[o]]}return r||t}},{key:"add",value:function(e){e&&(this.config=Object(n.a)({},this.config,{},e))}}]),t}());t.a=i}).call(this,a(119))}},[[1159,1,2]]]);
//# sourceMappingURL=main.032d47be.chunk.js.map