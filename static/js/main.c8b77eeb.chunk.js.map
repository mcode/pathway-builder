{"version":3,"sources":["components/ExpandedNode/ExpandedNode.module.scss","components/Header/Header.module.scss","components/elements/Loading/Loading.module.scss","camino-logo-dark.png","components/Graph/Graph.module.scss","components/Services/Services.tsx","components/CriteriaProvider.tsx","styles/theme.tsx","components/ThemeProvider.tsx","components/Header/Header.tsx","utils/builder.ts","components/Navigation/styles.tsx","components/Navigation/Navigation.tsx","components/PathwayProvider.tsx","components/Sidebar/styles.tsx","components/Sidebar/Sidebar.tsx","components/Sidebar/SidebarHeader.tsx","components/Sidebar/SidebarButton.tsx","components/elements/DropDown/DropDown.tsx","components/Sidebar/BranchNodeEditor.tsx","engine/cql-to-elm.ts","components/Sidebar/ActionNodeEditor.tsx","components/Sidebar/NullNode.tsx","components/Sidebar/BranchTransition.tsx","components/Sidebar/OutlinedDiv.tsx","visualization/layout.ts","utils/nodeUtils.ts","components/ExpandedNode/ExpandedNode.tsx","components/Node/Node.tsx","components/Arrow/styles.tsx","components/Arrow/Arrow.tsx","components/Graph/Graph.tsx","components/Builder/styles.tsx","components/Builder/Builder.tsx","components/BuilderRoute.tsx","components/UserProvider.tsx","components/Tabs/styles.tsx","components/Tabs/Tabs.tsx","components/elements/Loading/Loading.tsx","components/PathwaysList/styles.tsx","components/PathwaysList/PathwayModal.tsx","components/PathwaysList/PathwaysTable.tsx","components/PathwaysList/PathwaysList.tsx","components/CriteriaList/styles.tsx","components/CriteriaList/CriteriaTable.tsx","components/CriteriaList/ImportCriteriaModal.tsx","components/CriteriaList/CriteriaList.tsx","components/App.tsx","index.js","utils/ConfigManager.js","components/Node/Node.module.scss"],"names":["module","exports","useGetService","url","useState","status","result","setResult","useEffect","fetch","headers","Accept","getObject","then","response","json","listOfFiles","map","f","options","typedFetch","listOfPromises","Promise","all","list","payload","catch","error","CriteriaContext","createContext","jsonToCriteria","rawElm","elm","JSON","parse","library","identifier","defaultStatementNames","statements","def","find","includes","name","id","shortid","generate","label","version","modified","Date","now","alert","CriteriaProvider","memo","children","criteria","setCriteria","buildCriteriaNodeId","setBuildCriteriaNodeId","config","get","defaultCriteria","forEach","jsonCriterion","criterion","stringify","push","addCriteria","useCallback","file","reader","FileReader","onload","event","target","newCriteria","currentCriteria","readAsText","deleteCriteria","filter","updateBuildCriteriaNodeId","Provider","value","useCriteriaContext","useContext","variables","spacing","globalPadding","colors","white","black","blue","red","gray","grayMedium","grayBlue","grayLighter","grayDark","green","typography","fontFamily","join","materialUiOverridesBase","MuiButton","root","borderRadius","backgroundColor","color","fontWeight","iconSizeMedium","fontSize","iconSizeSmall","MuiTableHead","MuiTableCell","head","padding","borderBottom","MuiFormControl","margin","MuiFormLabel","fontStyle","MuiInputBase","input","transitionDelay","transitionProperty","MuiOutlinedInput","MuiSelect","icon","MuiPaper","rounded","MuiDialogTitle","MuiDialogContent","MuiDialogActions","materialUiOverridesDark","borderColor","notchedOutline","MuiMenuItem","paletteBase","primary","main","secondary","common","background","default","text","grey","800","lightTheme","createMuiTheme","palette","overrides","darkTheme","deepmerge","projectorTheme","getTheme","theme","useProjector","ThemeContext","ThemeProvider","setUseProjector","muiTheme","toggleTheme","currentUseProjector","anchorEl","setAnchorEl","openMenu","currentTarget","closeMenu","handleToggleTheme","className","styles","header","to","homeLink","onClick","src","logo","alt","aria-controls","aria-haspopup","faCog","Menu","keepMounted","open","Boolean","onClose","MenuItem","downloadPathway","pathway","pathwayString","schemaIdentifier","usings","localIdentifier","uri","localId","locator","context","expression","type","operand","dataType","valueSets","codes","codeSystems","pathwayToExport","preconditions","precondition","undefined","nodes","Object","keys","nodeKey","node","key","mergeElm","elmStatement","getElmStatement","transitions","transition","condition","description","action","navigational","setNavigationalElm","exportPathway","pathwayBlob","Blob","window","URL","createObjectURL","a","document","createElement","href","download","click","revokeObjectURL","additionalElm","using","include","path","valueSet","code","codesystem","createNode","nodeTypeIsUndefined","addNode","setNodeNodeType","nodeType","makeNodeAction","cql","makeNodeBranch","setNodeAction","addTransition","startNodeKey","endNodeKey","getNodeType","makeStyles","display","alignItems","height","justifyContent","backButton","width","navigationIcons","cursor","pathwayName","marginLeft","index","Navigation","useStyles","history","useHistory","handleGoBack","IconButton","aria-label","faChevronLeft","faEllipsisH","getContentAnchorEl","anchorOrigin","vertical","horizontal","PathwayContext","PathwayProvider","pathways","setPathways","service","servicePayload","addPathway","currentPathways","deletePathway","updatePathway","newPathway","findIndex","slice","usePathwayContext","flexDirection","minWidth","overflowY","float","formControl","divider","headerLabelStart","displayText","sidebarHeader","sidebarHeaderGroup","sidebarHeaderButton","headerLabelGroup","headerLabel","headerLabelText","marginBottom","editIcon","sidebarButtonGroup","sidebarButton","marginRight","sidebarButtonText","outlinedDiv","outlinedDivError","toggleSidebar","cancelButton","alignSelf","marginTop","buildCriteriaContainer","saveButton","headerElement","currentNode","isExpanded","setIsExpanded","sidebarContainerElement","useRef","currentNodeKey","changeNodeType","redirectToNode","encodeURIComponent","location","pathname","addPathwayNode","newNode","current","style","innerHeight","clientHeight","ref","isTransition","faChevronRight","showInput","setShowInput","inputRef","currentNodeLabel","goToParentNode","goToNode","openNodeOptions","changeNodeLabel","setNodeLabel","handleShowInput","handleKeyPress","FormControl","fullWidth","Input","onBlur","onKeyPress","defaultValue","autoFocus","onFocus","select","clsx","faEdit","buttonName","buttonIcon","buttonText","Button","variant","startIcon","onChange","handleSetSelected","InputLabel","htmlFor","Select","MenuProps","transformOrigin","displayEmpty","option","nodeTypeOptions","selectNodeType","handleAddTransition","faPlus","actionTypeOptions","codeSystemOptions","addActionCQL","method","body","convertBasicCQL","resource","cqlId","replace","codesystemStatement","system","returnStatement","resourceType","retrieveStatement","defineStatement","coding","medicationCodeableConcept","escape","title","console","createCQL","setActionNodeElm","changeCode","resetDisplay","changeDescription","actionId","setActionDescription","changeTitle","selectActionType","actionType","selectCodeSystem","codeSystem","validateFunction","length","onEnter","e","changeNodeTypeEnabled","displayAddButtons","TextField","inputProps","faCheckCircle","criteriaOptions","c","transitionKey","transitionNode","useCriteriaSelected","setUseCriteriaSelected","criteriaDescription","criteriaIsValid","criteriaDisplayIsValid","hasCriteria","faTrashAlt","displayCriteria","buildCriteriaSelected","setBuildCriteriaSelected","criteriaName","setCriteriaName","handleUseCriteria","transitionId","removeTransitionCondition","selectCriteriaSource","criteriaSource","criteriaLabel","foundTransition","setTransitionCondition","setCriteriaDisplay","criteriaDisplay","setTransitionConditionDescription","handleCriteriaName","handleBuildCriteria","handleBuildCriteriaCancel","size","faTools","FormControlLabel","Box","control","Checkbox","faSave","disabled","InputComponent","multiline","InputLabelProps","shrink","InputProps","inputComponent","classes","graphLayoutProvider","layout","nodeDimensions","nodeKeys","g","dagre","graphlib","Graph","setGraph","setDefaultEdgeLabel","nodeDimension","setNode","setEdge","nodeCoordinates","startNodeShift","x","y","edges","edge","edgeName","v","w","start","end","points","p","layoutDagre","rank","NaN","horizontalPosition","parents","canMove","initializeNodes","graph","assignRankToChildren","assignHorizontalPositionToNode","assignHorizontalPositionToNodesInRank","coordinates","NODE_HEIGHT","produceCoordinates","hPos","isNaN","i","hasOverlap","direction","Math","ceil","NODE_WIDTH","parentsOnHigherRank","parentKey","parent","floor","splice","childNode","spreadChildrenEvenly","sum","reduce","b","nodesInRank","nodesOverlap","otherNode","nodesEqual","child","indexOf","assignRankToNode","err","layoutCustom","isActionNode","isBranchNode","resourceNameConversion","MedicationRequest","ServiceRequest","CarePlan","ExpandedNode","actionNode","isAction","isActionable","ExpandedNodeMemo","ExpandedNodeField","descTitle","desc","returnElements","rel","faExternalLinkAlt","externalLink","renderAction","branch","infoTable","Node","forwardRef","pathwayNode","xCoordinate","yCoordinate","expanded","hasMetadata","setHasMetadata","onClickHandler","top","left","isCurrentNode","isTransitionOfCurrentBranch","some","topLevelClasses","expandedNodeClass","actionable","childActionable","childNotActionable","expandedNode","NodeIcon","faPlay","faPrescriptionBottleAlt","faSyringe","faBookMedical","faMicroscope","StatusIcon","faTimesCircle","arrow","stroke","strokeWidth","currentBranchArrow","arrowhead","fill","currentBranchArrowhead","ArrowPath","arrowheadId","widthOffset","pointsWithOffset","remainder","pathString","acc","point","arr","d","markerEnd","Arrow","isCurrentBranchArrow","edgeNameNoWhitespace","markerWidth","markerHeight","refX","refY","orient","interactive","expandCurrentNode","graphElement","nodeRefs","parentElement","clientWidth","parentWidth","setParentWidth","getGraphLayout","nodeElement","Array","from","graphLayout","setLayout","maxHeight","useMemo","values","max","minX","min","toAdd","maxWidth","curr","lastSelectedNode","setExpanded","toggleExpanded","prevNode","cancel","ResizeSensor","GraphMemo","pathwayId","useParams","nodeId","position","xmlns","zIndex","overflow","toggleButtonCss","graphHeader","graphHeaderText","paddingLeft","toggleButton","darken","toggleIcon","transform","graphContainerElement","useTheme","showCriteriaBuilder","setShowCriteriaBuilder","toggleShowCriteria","faProjectDiagram","decodeURIComponent","pathwayIndex","UserContext","UserProvider","user","setUser","textTransform","tabs","tab","component","faSpinner","spin","createPathwayButton","pathwayList","pathwaysListButton","dialogCloseButton","editPathway","createNewPathwayMeta","pathwayNameRef","pathwayDescRef","closeModal","handleCreateNewPathway","preventDefault","Start","createNewPathway","handleUpdatePathway","metaDescription","Dialog","aria-labelledby","DialogTitle","disableTypography","faTimes","onSubmit","DialogContent","required","DialogActions","setOpen","editablePathway","setEditablePathway","openEditPathwayModal","closeEditPathwayModal","TableContainer","Table","TableHead","TableRow","TableCell","TableBody","scope","Link","RouterLink","underline","align","faFileDownload","openNewPathwayModal","closeNewPathwayModal","buttonRow","buildCriteriaButton","criteriaList","editButton","chooseFileInput","inputButton","whiteSpace","fileName","datetime","moment","fromNow","setFileName","importFileRef","selectFile","files","handleChooseFile","accept","faFileImport","openImportModal","closeImportModal","ReactDOM","render","getElementById","this","global","CONFIG","parts","split","conf"],"mappings":"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","file":"static/js/main.c8b77eeb.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"infoTable\":\"ExpandedNode_infoTable__3v2tx\",\"descTitle\":\"ExpandedNode_descTitle__15ki8\",\"desc\":\"ExpandedNode_desc__3Xdkf\",\"externalLink\":\"ExpandedNode_externalLink__1Mr1x\",\"defaultTextButton\":\"ExpandedNode_defaultTextButton__2Bvq6\",\"commentsForm\":\"ExpandedNode_commentsForm__3Q20Y\",\"footer\":\"ExpandedNode_footer__FOCYI\",\"comments\":\"ExpandedNode_comments__9q-JW\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"logo\":\"Header_logo__3T0lc\",\"homeLink\":\"Header_homeLink__2ew4r\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"Loading_root__3b6qy\"};","module.exports = __webpack_public_path__ + \"static/media/camino-logo-dark.c8fc712a.png\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"Graph_root__1SJOc\"};","import { useState, useEffect } from 'react';\nimport { Service } from 'pathways-objects';\n\nfunction getObject(url: string): Promise<Response> {\n  return fetch(url, {\n    headers: {\n      Accept: 'application/json'\n    }\n  });\n}\n\nfunction typedFetch<T>(url: string, options?: object): Promise<T> {\n  return fetch(url, options).then(response => response.json() as Promise<T>);\n}\n\nfunction useGetService<T>(url: string): Service<Array<T>> {\n  const [result, setResult] = useState<Service<Array<T>>>({\n    status: 'loading'\n  });\n\n  useEffect(() => {\n    getObject(url)\n      .then(response => response.json() as Promise<string[]>)\n      .then(listOfFiles => listOfFiles.map(f => typedFetch<T>(url + '/' + f)))\n      .then(listOfPromises => Promise.all(listOfPromises))\n      .then(list => setResult({ status: 'loaded', payload: list }))\n      .catch(error => setResult({ status: 'error', error }));\n  }, [url]);\n\n  return result;\n}\n\nexport default useGetService;\n","import React, {\n  createContext,\n  ReactNode,\n  FC,\n  useState,\n  memo,\n  useContext,\n  useCallback,\n  useEffect\n} from 'react';\nimport shortid from 'shortid';\nimport { ElmStatement } from 'elm-model';\nimport config from 'utils/ConfigManager';\nimport useGetService from './Services';\nimport { ServiceLoaded } from 'pathways-objects';\n\ninterface Criteria {\n  id: string;\n  label: string;\n  version: string;\n  modified: number;\n  elm: object;\n}\n\ninterface CriteriaContextInterface {\n  criteria: Criteria[];\n  buildCriteriaNodeId: string;\n  addCriteria: (file: File) => void;\n  deleteCriteria: (id: string) => void;\n  updateBuildCriteriaNodeId: (id: string) => void;\n}\n\nexport const CriteriaContext = createContext<CriteriaContextInterface>(\n  {} as CriteriaContextInterface\n);\n\ninterface CriteriaProviderProps {\n  children: ReactNode;\n}\n\nfunction jsonToCriteria(rawElm: string): Criteria | undefined {\n  const elm = JSON.parse(rawElm);\n  if (!elm.library?.identifier) {\n    alert('Please upload ELM file');\n    return;\n  }\n  const defaultStatementNames = [\n    'Patient',\n    'MeetsInclusionCriteria',\n    'InPopulation',\n    'Recommendation',\n    'Rationale',\n    'Errors'\n  ];\n  const elmStatements: ElmStatement[] = elm.library.statements.def;\n  const elmStatement = elmStatements.find(def => !defaultStatementNames.includes(def.name));\n  if (!elmStatement) {\n    alert('No elm statement found in that file');\n    return;\n  }\n  const newCriteria: Criteria = {\n    id: shortid.generate(),\n    label: elm.library.identifier.id,\n    version: elm.library.identifier.version,\n    modified: Date.now(),\n    elm: elm\n  };\n  return newCriteria;\n}\n\nexport const CriteriaProvider: FC<CriteriaProviderProps> = memo(({ children }) => {\n  const [criteria, setCriteria] = useState<Criteria[]>([]);\n  const [buildCriteriaNodeId, setBuildCriteriaNodeId] = useState<string>('');\n  const service = useGetService<Criteria>(config.get('demoCriteria'));\n  const payload = (service as ServiceLoaded<Criteria[]>).payload;\n\n  useEffect(() => {\n    const defaultCriteria: Criteria[] = [];\n    if (payload) {\n      payload.forEach(jsonCriterion => {\n        const criterion = jsonToCriteria(JSON.stringify(jsonCriterion));\n        if (criterion) defaultCriteria.push(criterion);\n      });\n    }\n    setCriteria(defaultCriteria);\n  }, [payload]);\n\n  const addCriteria = useCallback((file: File) => {\n    const reader = new FileReader();\n    reader.onload = (event: ProgressEvent<FileReader>): void => {\n      if (event.target?.result) {\n        const rawElm = event.target.result as string;\n        const newCriteria = jsonToCriteria(rawElm);\n        if (newCriteria) setCriteria(currentCriteria => [...currentCriteria, newCriteria]);\n      } else alert('Unable to read that file');\n    };\n    reader.readAsText(file);\n  }, []);\n\n  const deleteCriteria = useCallback((id: string) => {\n    setCriteria(currentCriteria => currentCriteria.filter(criteria => criteria.id !== id));\n  }, []);\n\n  const updateBuildCriteriaNodeId = useCallback(\n    (id: string) => {\n      setBuildCriteriaNodeId(id);\n    },\n    [setBuildCriteriaNodeId]\n  );\n\n  return (\n    <CriteriaContext.Provider\n      value={{\n        criteria,\n        buildCriteriaNodeId,\n        addCriteria,\n        deleteCriteria,\n        updateBuildCriteriaNodeId\n      }}\n    >\n      {children}\n    </CriteriaContext.Provider>\n  );\n});\n\nexport const useCriteriaContext = (): CriteriaContextInterface => useContext(CriteriaContext);\n","import { createMuiTheme } from '@material-ui/core/styles';\nimport deepmerge from 'deepmerge';\n\ndeclare module '@material-ui/core/styles/createMuiTheme' {\n  interface Theme {\n    variables: {\n      spacing: {\n        globalPadding: string;\n      };\n    };\n  }\n  // allow configuration using `createMuiTheme`\n  interface ThemeOptions {\n    variables?: {\n      spacing?: {\n        globalPadding?: string;\n      };\n    };\n  }\n}\n\nconst variables = {\n  spacing: {\n    globalPadding: '2em'\n  }\n};\n\nconst colors = {\n  white: '#fff',\n  black: '#222',\n  blue: '#5d89a1',\n  red: '#d95d77',\n  gray: '#4a4a4a',\n  grayMedium: '#bbbdc0',\n  grayBlue: '#cbd5df',\n  grayLighter: '#eaeef2',\n  grayDark: '#444',\n  green: '#2fa874'\n};\n\nconst typography = {\n  fontFamily: [\n    'Open Sans',\n    '-apple-system',\n    'BlinkMacSystemFont',\n    'Segoe UI',\n    'Roboto',\n    'Oxygen',\n    'Ubuntu',\n    'Cantarell',\n    'Fira Sans',\n    'Droid Sans',\n    'Helvetica Neue',\n    'sans-serif'\n  ].join(',')\n};\n\nconst materialUiOverridesBase = {\n  MuiButton: {\n    root: {\n      borderRadius: 0,\n      '&.Mui-disabled': {\n        backgroundColor: colors.grayMedium,\n        color: colors.white\n      }\n    },\n    label: {\n      fontWeight: 600\n    },\n    iconSizeMedium: {\n      '& > *:first-child': {\n        fontSize: 14\n      }\n    },\n    iconSizeSmall: {\n      '& > *:first-child': {\n        fontSize: 14\n      }\n    }\n  },\n  MuiTableHead: {\n    root: {\n      backgroundColor: colors.grayLighter\n    }\n  },\n  MuiTableCell: {\n    root: {\n      fontSize: '1em'\n    },\n    head: {\n      padding: '5px 16px',\n      borderBottom: 'none'\n    }\n  },\n  MuiFormControl: {\n    root: {\n      margin: '10px 0'\n    }\n  },\n  MuiFormLabel: {\n    root: {\n      fontStyle: 'italic',\n      '&.Mui-error': {\n        color: colors.white\n      }\n    }\n  },\n  MuiInputBase: {\n    root: {\n      fontWeight: 600\n    },\n    input: {\n      '&::selection': {\n        color: colors.white,\n        backgroundColor: colors.grayDark\n      },\n      '&:-webkit-autofill': {\n        transitionDelay: '9999s',\n        transitionProperty: 'background-color, color'\n      }\n    }\n  },\n  MuiOutlinedInput: {\n    root: {\n      borderRadius: '0'\n    }\n  },\n  MuiSelect: {\n    icon: {\n      fontSize: '2em'\n    }\n  },\n  MuiPaper: {\n    rounded: {\n      borderRadius: '0'\n    }\n  },\n  MuiDialogTitle: {\n    root: {\n      padding: '1em'\n    }\n  },\n  MuiDialogContent: {\n    root: {\n      padding: '0 4em'\n    }\n  },\n  MuiDialogActions: {\n    root: {\n      padding: '2em 4em'\n    }\n  }\n};\n\nconst materialUiOverridesDark = {\n  MuiFormControl: {\n    root: {\n      '&:hover': {\n        borderColor: colors.white\n      }\n    }\n  },\n  MuiFormLabel: {\n    root: {\n      color: colors.white,\n      '&$focused': {\n        color: colors.white\n      }\n    }\n  },\n  MuiInputBase: {\n    root: {\n      color: colors.white,\n      '&:hover': {\n        borderColor: colors.white,\n        backgroundColor: colors.grayDark\n      }\n    }\n  },\n  MuiOutlinedInput: {\n    root: {\n      '&:hover': {\n        borderColor: colors.white\n      },\n      '&:hover $notchedOutline': {\n        borderColor: colors.white\n      },\n      '&$focused $notchedOutline': {\n        borderColor: colors.white\n      }\n    },\n    notchedOutline: {\n      borderColor: colors.white\n    }\n  },\n  MuiSelect: {\n    icon: {\n      color: colors.white\n    }\n  },\n  MuiMenuItem: {\n    root: {\n      color: colors.grayDark\n    }\n  }\n};\n\nconst paletteBase = {\n  primary: {\n    main: colors.blue\n  },\n  secondary: {\n    main: colors.red\n  },\n  error: {\n    main: colors.red\n  },\n  common: colors,\n  background: {\n    default: colors.grayLighter\n  },\n  text: {\n    primary: colors.gray,\n    secondary: colors.gray\n  },\n  grey: {\n    800: '#4a4a4a'\n  }\n};\n\nconst lightTheme = createMuiTheme({\n  typography: { ...typography },\n  palette: { ...paletteBase },\n  overrides: { ...materialUiOverridesBase },\n  variables: { ...variables }\n});\n\nconst darkTheme = createMuiTheme({\n  typography: { ...typography },\n  palette: deepmerge(paletteBase, {\n    text: {\n      primary: colors.white,\n      secondary: colors.white\n    }\n  }),\n  overrides: deepmerge(materialUiOverridesBase, materialUiOverridesDark),\n  variables: { ...variables }\n});\n\nconst projectorTheme = createMuiTheme({\n  typography: { ...typography },\n  palette: deepmerge(paletteBase, {\n    background: {\n      default: colors.grayBlue\n    },\n    text: {\n      primary: colors.black,\n      secondary: colors.black\n    }\n  }),\n  overrides: { ...materialUiOverridesBase },\n  variables: { ...variables }\n});\n\nexport default lightTheme;\nexport { lightTheme, darkTheme, projectorTheme };\n","import React, {\n  FC,\n  memo,\n  createContext,\n  useState,\n  useCallback,\n  useContext,\n  ReactNode\n} from 'react';\nimport { ThemeProvider as MuiThemeProvider, Theme } from '@material-ui/core/styles';\nimport { lightTheme, darkTheme, projectorTheme } from '../styles/theme';\n\ninterface ThemeProviderProps {\n  theme: string;\n  children: ReactNode;\n}\n\ninterface ThemeContextInterface {\n  toggleTheme: () => void;\n  useProjector: boolean;\n}\n\nconst getTheme = ({ theme, useProjector }: { theme: string; useProjector: boolean }): Theme => {\n  if (useProjector) {\n    switch (theme) {\n      case 'dark':\n        // TODO: replace with dark projector theme\n        return darkTheme;\n\n      default:\n        return projectorTheme;\n    }\n  }\n\n  switch (theme) {\n    case 'dark':\n      return darkTheme;\n\n    default:\n      return lightTheme;\n  }\n};\n\nexport const ThemeContext = createContext({} as ThemeContextInterface);\nexport const useThemeToggle = (): (() => void) => {\n  const { toggleTheme } = useContext(ThemeContext);\n  return toggleTheme;\n};\nexport const useTheme = (theme: string): Theme => {\n  const { useProjector } = useContext(ThemeContext);\n  return getTheme({ theme, useProjector });\n};\n\nconst ThemeProvider: FC<ThemeProviderProps> = memo(({ theme = 'light', children }) => {\n  const [useProjector, setUseProjector] = useState(false);\n  const muiTheme = getTheme({ theme, useProjector });\n\n  const toggleTheme = useCallback(() => {\n    setUseProjector(currentUseProjector => !currentUseProjector);\n  }, []);\n\n  return (\n    <MuiThemeProvider theme={muiTheme}>\n      <ThemeContext.Provider value={{ useProjector, toggleTheme }}>\n        {children}\n      </ThemeContext.Provider>\n    </MuiThemeProvider>\n  );\n});\n\nexport default ThemeProvider;\n","import React, { FC, memo, useCallback, useState, MouseEvent } from 'react';\nimport { Link } from 'react-router-dom';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCog } from '@fortawesome/free-solid-svg-icons';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\n\nimport { useCriteriaContext } from 'components/CriteriaProvider';\nimport { useThemeToggle } from '../ThemeProvider';\n\nimport logo from 'camino-logo-dark.png';\nimport styles from './Header.module.scss';\n\nconst Header: FC = () => {\n  const { updateBuildCriteriaNodeId } = useCriteriaContext();\n  const [anchorEl, setAnchorEl] = useState<null | HTMLElement>(null);\n  const toggleTheme = useThemeToggle();\n\n  const openMenu = useCallback((event: MouseEvent<HTMLButtonElement>): void => {\n    setAnchorEl(event.currentTarget);\n  }, []);\n\n  const closeMenu = useCallback((): void => {\n    setAnchorEl(null);\n  }, []);\n\n  const handleToggleTheme = useCallback((): void => {\n    toggleTheme();\n    closeMenu();\n  }, [toggleTheme, closeMenu]);\n\n  return (\n    <header className={styles.header}>\n      <Link to=\"/\" className={styles.homeLink} onClick={(): void => updateBuildCriteriaNodeId('')}>\n        <img src={logo} alt=\"logo\" className={styles.logo} />\n      </Link>\n\n      <button onClick={openMenu} aria-controls=\"options-menu\" aria-haspopup=\"true\">\n        <FontAwesomeIcon icon={faCog} />\n      </button>\n\n      <Menu\n        id=\"options-menu\"\n        anchorEl={anchorEl}\n        keepMounted\n        open={Boolean(anchorEl)}\n        onClose={closeMenu}\n      >\n        <MenuItem onClick={handleToggleTheme}>Toggle Theme</MenuItem>\n      </Menu>\n    </header>\n  );\n};\n\nexport default memo(Header);\n","import { Pathway, Precondition, PathwayNode, Transition, Action, ActionNode } from 'pathways-model';\nimport { ElmLibrary, ElmStatement } from 'elm-model';\nimport shortid from 'shortid';\nimport { MedicationRequest, ServiceRequest } from 'fhir-objects';\n\nexport function createNewPathway(name: string, description?: string, pathwayId?: string): Pathway {\n  return {\n    id: pathwayId ?? shortid.generate(),\n    name: name,\n    description: description ?? '',\n    library: '',\n    preconditions: [],\n    nodes: {\n      Start: {\n        key: 'Start',\n        label: 'Start',\n        transitions: []\n      }\n    }\n  };\n}\n\nexport function downloadPathway(pathway: Pathway): void {\n  const pathwayString = exportPathway(pathway);\n  // Create blob from pathwayString to save to file system\n  const pathwayBlob = new Blob([pathwayString], {\n    type: 'application/json'\n  });\n  // Temporarily create hidden <a> tag to download pathwayBlob\n  // File name is set to <pathway-name>.json\n  const url = window.URL.createObjectURL(pathwayBlob);\n  const a = document.createElement('a');\n  a.href = url;\n  a.download = `${pathway.name}.json`;\n  a.click();\n  window.URL.revokeObjectURL(url);\n}\n\nexport function exportPathway(pathway: Pathway): string {\n  const elm: ElmLibrary = {\n    library: {\n      identifier: {\n        id: pathway.id,\n        version: '1.0.0'\n      },\n      schemaIdentifier: {\n        id: 'urn:hl7-org:elm',\n        version: 'r1'\n      },\n      usings: {\n        def: [\n          {\n            localIdentifier: 'System',\n            uri: 'urn:hl7-org:elm-types:r1'\n          },\n          {\n            localId: '1',\n            locator: '3:1-3:26',\n            localIdentifier: 'FHIR',\n            uri: 'http://hl7.org/fhir',\n            version: '4.0.0'\n          }\n        ]\n      },\n      statements: {\n        def: [\n          {\n            locator: '13:1-13:15',\n            name: 'Patient',\n            context: 'Patient',\n            expression: {\n              type: 'SingletonFrom',\n              operand: {\n                locator: '13:1-13:15',\n                dataType: '{http://hl7.org/fhir}Patient',\n                type: 'Retrieve'\n              }\n            }\n          }\n        ]\n      },\n      includes: { def: [] },\n      valueSets: { def: [] },\n      codes: { def: [] },\n      codeSystems: { def: [] }\n    }\n  };\n\n  const pathwayToExport: Pathway = {\n    ...pathway,\n    // Strip id from each precondition\n    preconditions: pathway.preconditions.map((precondition: Precondition) => ({\n      ...precondition,\n      id: undefined\n    })),\n    nodes: { ...pathway.nodes }\n  };\n\n  Object.keys(pathwayToExport.nodes).forEach((nodeKey: string) => {\n    const node = pathway.nodes[nodeKey];\n    if ('elm' in node && node.elm && node.key) {\n      mergeElm(elm, node.elm);\n      const elmStatement = getElmStatement(node.elm);\n      elmStatement.name = node.key;\n      elm.library.statements.def.push(elmStatement);\n    }\n\n    pathwayToExport.nodes[nodeKey] = {\n      ...pathwayToExport.nodes[nodeKey],\n      // Strip key from each node\n      key: undefined,\n      elm: undefined,\n      // Strip id from each node.transition\n      transitions: node.transitions.map((transition: Transition) => {\n        if (transition.condition?.elm) {\n          // Add tranistion.condition.elm to elm\n          mergeElm(elm, transition.condition.elm);\n          const elmStatement = getElmStatement(transition.condition.elm);\n          elmStatement.name = transition.condition.description;\n          elm.library.statements.def.push(elmStatement);\n        }\n        return {\n          ...transition,\n          id: undefined,\n          condition: transition.condition ? { ...transition.condition, elm: undefined } : undefined\n        };\n      }),\n      // Strip id from each node.action\n      action:\n        (node as ActionNode).action == null\n          ? undefined\n          : (node as ActionNode).action.map((action: Action) => ({\n              ...action,\n              id: undefined\n            }))\n    };\n  });\n\n  setNavigationalElm(pathwayToExport, elm);\n\n  return JSON.stringify(pathwayToExport, undefined, 2);\n}\n\nfunction mergeElm(elm: ElmLibrary, additionalElm: ElmLibrary): void {\n  // Merge usings\n  additionalElm.library.usings?.def.forEach(using => {\n    // Check if it is in ELM\n    if (!elm.library.usings?.def.find(def => def.uri === using.uri))\n      elm.library.usings?.def.push(using);\n  });\n\n  // Merge includes\n  additionalElm.library.includes?.def.forEach(include => {\n    if (!elm.library.includes?.def.find(def => def.path === include.path))\n      elm.library.includes?.def.push(include);\n  });\n\n  // Merge valueSets\n  additionalElm.library.valueSets?.def.forEach(valueSet => {\n    if (!elm.library.valueSets?.def.find(def => def.id === valueSet.id))\n      elm.library.valueSets?.def.push(valueSet);\n  });\n  // Merge codes\n  additionalElm.library.codes?.def.forEach(code => {\n    if (!elm.library.codes?.def.find(def => def.name === code.name))\n      elm.library.codes?.def.push(code);\n  });\n  // Merge codesystems\n  additionalElm.library.codeSystems?.def.forEach(codesystem => {\n    if (!elm.library.codeSystems?.def.find(def => def.name === codesystem.name))\n      elm.library.codeSystems?.def.push(codesystem);\n  });\n\n  // TODO: merge concepts\n}\n\nfunction getElmStatement(elm: ElmLibrary): ElmStatement {\n  const defaultStatementNames = [\n    'Patient',\n    'MeetsInclusionCriteria',\n    'InPopulation',\n    'Recommendation',\n    'Rationale',\n    'Errors'\n  ];\n  const elmStatement = elm.library.statements.def.find(\n    def => !defaultStatementNames.includes(def.name)\n  );\n\n  // elmStatement type is ElmStatement | undefined but criteria\n  // provider validates such a statement exists in the elm\n  return elmStatement as ElmStatement;\n}\n\n// TODO: possibly add more precondition methods\nexport function addPrecondition(\n  pathway: Pathway,\n  elementName: string,\n  expected: string,\n  cql: string\n): string {\n  const id = shortid.generate();\n  const precondition: Precondition = {\n    id: id,\n    elementName: elementName,\n    expected: expected,\n    cql: cql\n  };\n  pathway.preconditions.push(precondition);\n\n  return id;\n}\n\nexport function setNavigationalElm(pathway: Pathway, elm: object): void {\n  if (!pathway.elm) pathway.elm = {};\n  pathway.elm.navigational = elm;\n}\n\nexport function setPreconditionElm(pathway: Pathway, elm: object): void {\n  if (!pathway.elm) pathway.elm = {};\n  pathway.elm.preconditions = elm;\n}\n\nexport function createNode(key?: string): PathwayNode {\n  if (!key) key = shortid.generate();\n  const node: PathwayNode = {\n    key,\n    label: 'New Node',\n    transitions: [],\n    nodeTypeIsUndefined: true\n  };\n\n  return node;\n}\n\nexport function addNode(pathway: Pathway, node: PathwayNode): Pathway {\n  return {\n    ...pathway,\n    nodes: {\n      ...pathway.nodes,\n      [node.key as string]: node\n    }\n  };\n}\n\nexport function addActionNode(pathway: Pathway): Pathway {\n  const node = createNode();\n  const newPathway = addNode(pathway, node);\n\n  return makeNodeAction(newPathway, node.key as string);\n}\n\nexport function setNodeLabel(pathway: Pathway, key: string, label: string): Pathway {\n  return {\n    ...pathway,\n    nodes: {\n      ...pathway.nodes,\n      [key]: {\n        ...pathway.nodes[key],\n        label\n      }\n    }\n  };\n}\n\nexport function setNodeNodeType(pathway: Pathway, nodeKey: string, nodeType: string): Pathway {\n  switch (nodeType) {\n    case 'action':\n      return makeNodeAction(pathway, nodeKey);\n    case 'branch':\n      return makeNodeBranch(pathway, nodeKey);\n    default:\n      return pathway;\n  }\n}\n\nexport function setNodeCriteriaSource(\n  pathway: Pathway,\n  key: string,\n  criteriaSource: string\n): Pathway {\n  return {\n    ...pathway,\n    nodes: {\n      ...pathway.nodes,\n      [key]: {\n        ...pathway.nodes[key],\n        criteriaSource\n      }\n    }\n  };\n}\n\nexport function setNodeAction(pathway: Pathway, key: string, action: Action[]): Pathway {\n  return {\n    ...pathway,\n    nodes: {\n      ...pathway.nodes,\n      [key]: {\n        ...pathway.nodes[key],\n        action\n      }\n    }\n  };\n}\n\nexport function setNodeMcodeCriteria(\n  pathway: Pathway,\n  key: string,\n  mcodeCriteria: string\n): Pathway {\n  return {\n    ...pathway,\n    nodes: {\n      ...pathway.nodes,\n      [key]: {\n        ...pathway.nodes[key],\n        mcodeCriteria\n      }\n    }\n  };\n}\n\nexport function setNodeOtherCriteria(\n  pathway: Pathway,\n  key: string,\n  otherCriteria: string\n): Pathway {\n  return {\n    ...pathway,\n    nodes: {\n      ...pathway.nodes,\n      [key]: {\n        ...pathway.nodes[key],\n        otherCriteria\n      }\n    }\n  };\n}\n\nexport function addTransition(pathway: Pathway, startNodeKey: string, endNodeKey: string): Pathway {\n  const transition: Transition = {\n    id: shortid.generate(),\n    transition: endNodeKey\n  };\n\n  return {\n    ...pathway,\n    nodes: {\n      ...pathway.nodes,\n      [startNodeKey]: {\n        ...pathway.nodes[startNodeKey],\n        transitions: [...pathway.nodes[startNodeKey].transitions, transition]\n      }\n    }\n  };\n}\n\nexport function setTransitionCondition(\n  pathway: Pathway,\n  startNodeKey: string,\n  transitionId: string,\n  description: string,\n  elm: ElmLibrary,\n  criteriaLabel?: string\n): Pathway {\n  const foundTransition = pathway.nodes[startNodeKey]?.transitions?.find(\n    (transition: Transition) => transition.id === transitionId\n  );\n\n  const cql = criteriaLabel ? criteriaLabel : getElmStatement(elm).name;\n\n  if (foundTransition)\n    foundTransition.condition = {\n      description: description,\n      cql: cql,\n      elm: elm\n    };\n\n  return {\n    ...pathway,\n    nodes: {\n      ...pathway.nodes,\n      [startNodeKey]: {\n        ...pathway.nodes[startNodeKey]\n      }\n    }\n  };\n}\n\nexport function setActionNodeElm(pathway: Pathway, nodeKey: string, elm: ElmLibrary): Pathway {\n  return {\n    ...pathway,\n    nodes: {\n      ...pathway.nodes,\n      [nodeKey]: {\n        ...pathway.nodes[nodeKey],\n        elm: elm,\n        cql: getElmStatement(elm).name\n      }\n    }\n  };\n}\n\n// TODO: possibly add more action methods\nexport function addAction(\n  pathway: Pathway,\n  key: string,\n  type: string,\n  description: string,\n  resource: MedicationRequest | ServiceRequest\n): string {\n  const id = shortid.generate();\n  const action = {\n    id: id,\n    type: type,\n    description: description,\n    resource: resource\n  };\n  (pathway.nodes[key] as ActionNode).action.push(action);\n  return id;\n}\n\nexport function getNodeType(pathway: Pathway, key: string | undefined): string {\n  if (!key) {\n    return 'null';\n  }\n  const node = pathway.nodes[key];\n  if (node.nodeTypeIsUndefined) {\n    return 'null';\n  } else if (!(node as ActionNode).action && key !== 'Start') {\n    return 'branch';\n  } else {\n    return 'action';\n  }\n}\n\n/*\nSet Element Functions\n*/\nexport function setPathwayName(pathway: Pathway, name: string): void {\n  pathway.name = name;\n}\n\nexport function setPathwayDescription(pathway: Pathway, description: string): void {\n  pathway.description = description;\n}\n\nexport function setLibrary(pathway: Pathway, library: string): void {\n  pathway.library = library;\n}\n\nexport function setTransition(\n  pathway: Pathway,\n  startNodeKey: string,\n  endNodeKey: string,\n  transitionId: string\n): void {\n  const transition = pathway.nodes[startNodeKey]?.transitions?.find(\n    (transition: Transition) => transition.id === transitionId\n  );\n  if (transition) transition.transition = endNodeKey;\n}\n\nexport function setTransitionConditionDescription(\n  pathway: Pathway,\n  startNodeKey: string,\n  transitionId: string,\n  description: string\n): Pathway {\n  const foundTransition = pathway.nodes[startNodeKey]?.transitions?.find(\n    (transition: Transition) => transition.id === transitionId\n  );\n\n  if (foundTransition?.condition) {\n    foundTransition.condition.description = description;\n  } else if (foundTransition) {\n    foundTransition.condition = {\n      description: description,\n      cql: ''\n    };\n  }\n\n  return {\n    ...pathway,\n    nodes: {\n      ...pathway.nodes,\n      [startNodeKey]: {\n        ...pathway.nodes[startNodeKey]\n      }\n    }\n  };\n}\n\nexport function setTransitionConditionElm(\n  pathway: Pathway,\n  startNodeKey: string,\n  transitionId: string,\n  elm: ElmLibrary\n): void {\n  const foundTransition = pathway.nodes[startNodeKey]?.transitions?.find(\n    (transition: Transition) => transition.id === transitionId\n  );\n\n  if (foundTransition?.condition) {\n    foundTransition.condition.elm = elm;\n    foundTransition.condition.cql = getElmStatement(elm).name;\n  }\n}\n\nexport function setActionType(\n  pathway: Pathway,\n  nodeKey: string,\n  actionId: string,\n  type: string\n): void {\n  if ((pathway.nodes[nodeKey] as ActionNode).action) {\n    const action = (pathway.nodes[nodeKey] as ActionNode).action.find(\n      (action: Action) => action.id === actionId\n    );\n    if (action) action.type = type;\n  }\n}\n\nexport function setActionDescription(\n  pathway: Pathway,\n  nodeKey: string,\n  actionId: string,\n  description: string\n): void {\n  const node = (pathway.nodes[nodeKey] as ActionNode).action;\n\n  if (node) {\n    const action = node.find((action: Action) => action.id === actionId);\n    if (action) {\n      action.description = description;\n    }\n  }\n}\n\nexport function setActionResource(\n  pathway: Pathway,\n  nodeKey: string,\n  actionId: string,\n  resource: MedicationRequest | ServiceRequest\n): void {\n  if ((pathway.nodes[nodeKey] as ActionNode).action) {\n    const action = (pathway.nodes[nodeKey] as ActionNode).action.find(\n      (action: Action) => action.id === actionId\n    );\n    if (action) action.resource = resource;\n  }\n}\n\nexport function setActionResourceDisplay(\n  pathway: Pathway,\n  nodeKey: string,\n  actionId: string,\n  display: string\n): void {\n  if ((pathway.nodes[nodeKey] as ActionNode).action) {\n    const action = (pathway.nodes[nodeKey] as ActionNode).action.find(\n      (action: Action) => action.id === actionId\n    );\n    const resource = action?.resource;\n    if (\n      resource?.resourceType === 'MedicationRequest' &&\n      resource.medicationCodeableConcept.coding.length\n    )\n      resource.medicationCodeableConcept.coding[0].display = display;\n    else if (resource?.resourceType === 'ServiceRequest' && resource.code.coding.length)\n      resource.code.coding[0].display = display;\n  }\n}\n\nexport function makeNodeAction(pathway: Pathway, nodeKey: string): Pathway {\n  const node = pathway.nodes[nodeKey] as ActionNode;\n\n  if (node.cql !== undefined && node.action !== undefined) {\n    return pathway;\n  }\n\n  return {\n    ...pathway,\n    nodes: {\n      ...pathway.nodes,\n      [nodeKey]: {\n        ...node,\n        cql: '',\n        action: [],\n        nodeTypeIsUndefined: undefined\n      }\n    }\n  };\n}\n\nexport function makeNodeBranch(pathway: Pathway, nodeKey: string): Pathway {\n  const node = pathway.nodes[nodeKey] as ActionNode;\n\n  if (\n    node.cql === undefined &&\n    node.elm === undefined &&\n    node.action === undefined &&\n    node.nodeTypeIsUndefined === undefined\n  ) {\n    return pathway;\n  }\n\n  return {\n    ...pathway,\n    nodes: {\n      ...pathway.nodes,\n      [nodeKey]: {\n        ...node,\n        cql: undefined,\n        elm: undefined,\n        action: undefined,\n        nodeTypeIsUndefined: undefined\n      }\n    }\n  };\n}\n\nexport function createCQL(action: Action, nodeKey: string): string {\n  const resource = action.resource;\n  // CQl identifier cannot start with a number or contain '-'\n  const cqlId = `cql${shortid.generate().replace(/-/g, 'a')}`;\n  let cql = `library ${cqlId} version '1'\\nusing FHIR version '4.0.0'\\n`;\n\n  const codesystemStatement = (system: string): string => `codesystem \"${system}\": '${system}'\\n`;\n\n  const returnStatement = (resourceType: string): string =>\n    `return Tuple{ resourceType: '${resourceType}', id: R.id.value, status: R.status.value}`;\n\n  const retrieveStatement = (resourceType: string): string => `[${resourceType}: \"${cqlId} code\"]`;\n\n  const defineStatement = (): string => `define \"${nodeKey}\":`;\n\n  if (resource.resourceType === 'MedicationRequest') {\n    const coding = resource.medicationCodeableConcept.coding[0];\n\n    cql += codesystemStatement(coding.system);\n\n    // eslint-disable-next-line\n    cql += `code \"${cqlId} code\": '${escape(coding.code)}' from \"${coding.system}\" display '${\n      coding.display\n    }'\\n`;\n    cql += `${defineStatement()}\n      ${retrieveStatement('MedicationRequest')} R ${returnStatement('MedicationRequest')}`;\n  } else if (resource.resourceType === 'ServiceRequest') {\n    const coding = resource.code.coding[0];\n\n    cql += codesystemStatement(coding.system);\n\n    // eslint-disable-next-line\n    cql += `code \"${cqlId} code\": '${escape(coding.code)}' from \"${coding.system}\" display '${\n      coding.display\n    }'\\n`;\n    cql += `${defineStatement()}\n      if exists ${retrieveStatement('Procedure')} \n      then ${retrieveStatement('Procedure')} R ${returnStatement('Procedure')} \n      else ${retrieveStatement('ServiceRequest')} R ${returnStatement('ServiceRequest')}`;\n  } else if (resource.resourceType === 'CarePlan') {\n    cql += `${defineStatement()}\n      [CarePlan] R where R.title.value = '${escape(resource.title)}' ${returnStatement(\n      'CarePlan'\n    )}`;\n  } else {\n    console.error(\n      'Auto generating CQL for action - unsupported resource type: ' + resource.resourceType\n    );\n  }\n\n  return cql;\n}\n\n/*\nRemove Element Function\n*/\nexport function removePathwayDescription(pathway: Pathway): void {\n  delete pathway.description;\n}\n\nexport function removePrecondition(pathway: Pathway, id: string): void {\n  const preconditions = pathway.preconditions.filter(\n    (precondition: Precondition) => precondition.id !== id\n  );\n  pathway.preconditions = preconditions;\n}\n\nexport function removeNavigationalElm(pathway: Pathway): void {\n  delete pathway.elm?.navigational;\n}\n\nexport function removePreconditionElm(pathway: Pathway): void {\n  delete pathway.elm?.preconditions;\n}\n\nexport function removeNode(pathway: Pathway, key: string): void {\n  delete pathway.nodes[key];\n\n  Object.keys(pathway.nodes).forEach((nodeKey: string) => {\n    const node = pathway.nodes[nodeKey];\n    node.transitions.forEach((transition: Transition) => {\n      if (transition.transition === key) removeTransition(pathway, nodeKey, transition.id ?? '-1');\n    });\n  });\n}\n\nexport function removeTransitionCondition(\n  pathway: Pathway,\n  nodeKey: string,\n  transitionId: string\n): Pathway {\n  const transition = pathway.nodes[nodeKey].transitions.find(\n    (transition: Transition) => transition.id === transitionId\n  );\n  if (transition) delete transition.condition;\n\n  return {\n    ...pathway,\n    nodes: {\n      ...pathway.nodes,\n      [nodeKey]: {\n        ...pathway.nodes[nodeKey]\n      }\n    }\n  };\n}\n\nexport function removeTransition(pathway: Pathway, nodeKey: string, transitionId: string): void {\n  const transitions = pathway.nodes[nodeKey].transitions.filter(\n    (transition: Transition) => transition.id !== transitionId\n  );\n  pathway.nodes[nodeKey].transitions = transitions;\n}\n\nexport function removeAction(pathway: Pathway, nodeKey: string, actionId: string): void {\n  if ((pathway.nodes[nodeKey] as ActionNode).action) {\n    const actions = (pathway.nodes[nodeKey] as ActionNode).action.filter(\n      (action: Action) => action.id !== actionId\n    );\n    (pathway.nodes[nodeKey] as ActionNode).action = actions;\n  }\n}\n","import { makeStyles, Theme as AugmentedTheme } from '@material-ui/core/styles';\n\nexport default makeStyles(\n  (theme: AugmentedTheme) => ({\n    root: {\n      display: 'flex',\n      alignItems: 'center',\n      padding: '2em',\n      backgroundColor: theme.palette.background.default,\n      color: theme.palette.text.primary,\n      height: '6em',\n      justifyContent: 'space-between'\n    },\n    backButton: {\n      height: '45px',\n      width: '45px'\n    },\n    navigationIcons: {\n      fontSize: '20px',\n      color: theme.palette.grey['800'],\n      cursor: 'pointer'\n    },\n    pathwayName: {\n      fontSize: '1.4em',\n      marginLeft: '1.5em'\n    }\n  }),\n  { name: 'Navigation', index: 1 }\n);\n","import React, { FC, useCallback, useState, MouseEvent } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faChevronLeft, faEllipsisH } from '@fortawesome/free-solid-svg-icons';\nimport { IconButton, Menu, MenuItem } from '@material-ui/core';\n\nimport { Pathway } from 'pathways-model';\nimport { downloadPathway } from 'utils/builder';\nimport { useCriteriaContext } from 'components/CriteriaProvider';\nimport useStyles from './styles';\n\ninterface Props {\n  pathway: Pathway;\n}\n\nconst Navigation: FC<Props> = ({ pathway }) => {\n  const { updateBuildCriteriaNodeId } = useCriteriaContext();\n  const [anchorEl, setAnchorEl] = useState<null | HTMLElement>(null);\n  const styles = useStyles();\n  const history = useHistory();\n\n  const openMenu = useCallback((event: MouseEvent<HTMLButtonElement>): void => {\n    setAnchorEl(event.currentTarget);\n  }, []);\n\n  const closeMenu = useCallback((): void => {\n    setAnchorEl(null);\n  }, []);\n\n  const handleGoBack = useCallback((): void => {\n    updateBuildCriteriaNodeId('');\n    history.push('/');\n  }, [history, updateBuildCriteriaNodeId]);\n\n  return (\n    <nav className={styles.root}>\n      <div>\n        <IconButton className={styles.backButton} onClick={handleGoBack} aria-label=\"go back\">\n          <FontAwesomeIcon icon={faChevronLeft} className={styles.navigationIcons} />\n        </IconButton>\n\n        <span className={styles.pathwayName}>{pathway?.name}</span>\n      </div>\n      <IconButton onClick={openMenu} aria-controls=\"pathway-options-menu\" aria-haspopup=\"true\">\n        <FontAwesomeIcon icon={faEllipsisH} className={styles.navigationIcons} />\n      </IconButton>\n      <Menu\n        id=\"pathway-options-menu\"\n        anchorEl={anchorEl}\n        getContentAnchorEl={null}\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'left' }}\n        keepMounted\n        open={Boolean(anchorEl)}\n        onClose={closeMenu}\n      >\n        <MenuItem\n          onClick={(): void => {\n            downloadPathway(pathway);\n            closeMenu();\n          }}\n        >\n          Export Pathway\n        </MenuItem>\n      </Menu>\n    </nav>\n  );\n};\n\nexport default Navigation;\n","import React, {\n  FC,\n  memo,\n  createContext,\n  useCallback,\n  useContext,\n  useEffect,\n  useState,\n  ReactNode\n} from 'react';\nimport { Pathway } from 'pathways-model';\nimport { ServiceLoaded } from 'pathways-objects';\nimport config from 'utils/ConfigManager';\nimport useGetService from './Services';\n\ninterface PathwayContextInterface {\n  pathways: Pathway[];\n  status: string;\n  addPathway: (pathway: Pathway) => void;\n  deletePathway: (id: string) => void;\n  updatePathway: (pathway: Pathway) => void;\n}\n\nexport const PathwayContext = createContext<PathwayContextInterface>({} as PathwayContextInterface);\n\ninterface PathwayProviderProps {\n  children: ReactNode;\n}\n\nexport const PathwayProvider: FC<PathwayProviderProps> = memo(({ children }) => {\n  const [pathways, setPathways] = useState<Pathway[]>([]);\n  const service = useGetService<Pathway>(config.get('demoPathwaysService'));\n  const servicePayload = (service as ServiceLoaded<Pathway[]>).payload;\n\n  const addPathway = useCallback((pathway: Pathway) => {\n    setPathways(currentPathways => [...currentPathways, pathway]);\n  }, []);\n\n  const deletePathway = useCallback((id: string) => {\n    setPathways(currentPathways => currentPathways.filter(pathway => pathway.id !== id));\n  }, []);\n\n  const updatePathway = useCallback(\n    (newPathway: Pathway) => {\n      const index = pathways.findIndex(pathway => pathway.id === newPathway.id);\n      setPathways(currentPathways => [\n        ...currentPathways.slice(0, index),\n        newPathway,\n        ...currentPathways.slice(index + 1)\n      ]);\n    },\n    [pathways]\n  );\n\n  useEffect(() => {\n    if (servicePayload) setPathways(servicePayload);\n  }, [servicePayload]);\n\n  switch (service.status) {\n    case 'error':\n      return <div>Error loading pathways</div>;\n\n    default:\n      return (\n        <PathwayContext.Provider\n          value={{\n            pathways,\n            addPathway,\n            deletePathway,\n            updatePathway,\n            status: service.status\n          }}\n        >\n          {children}\n        </PathwayContext.Provider>\n      );\n  }\n});\n\nexport const usePathwayContext = (): PathwayContextInterface => useContext(PathwayContext);\n","import { makeStyles, Theme as AugmentedTheme } from '@material-ui/core/styles';\n\nexport default makeStyles(\n  (theme: AugmentedTheme) => ({\n    root: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: theme.variables.spacing.globalPadding,\n      color: theme.palette.text.primary,\n      backgroundColor: theme.palette.grey['800'],\n      width: '33%',\n      minWidth: '500px',\n      overflowY: 'scroll',\n      float: 'left'\n    },\n    formControl: {\n      margin: theme.spacing(1, 0),\n      minWidth: 375\n    },\n    divider: {\n      width: '100%'\n    },\n    headerLabelStart: {\n      cursor: 'default'\n    },\n    displayText: {\n      margin: '0 0 5px 0',\n      fontWeight: 900,\n      fontSize: '1em'\n    },\n    sidebarHeader: {\n      display: 'flex',\n      justifyContent: 'space-between'\n    },\n    sidebarHeaderGroup: {\n      display: 'flex',\n      alignItems: 'center'\n    },\n    sidebarHeaderButton: {\n      height: '45px',\n      width: '45px',\n      color: theme.palette.text.primary\n    },\n    headerLabelGroup: {\n      display: 'flex',\n      cursor: 'pointer',\n      height: '60px'\n    },\n    headerLabel: {\n      display: 'flex',\n      alignItems: 'center',\n      fontSize: '1.6em',\n      fontWeight: 700,\n      margin: '0 5px'\n    },\n    headerLabelText: {\n      marginBottom: '5px'\n    },\n    editIcon: {\n      fontSize: '0.6em',\n      marginLeft: '10px'\n    },\n    sidebarButtonGroup: {\n      display: 'flex',\n      margin: '10px 0'\n    },\n    sidebarButton: {\n      minWidth: 180,\n      marginRight: '20px'\n    },\n    sidebarButtonText: {\n      fontStyle: 'italic'\n    },\n    outlinedDiv: {\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'flex-start',\n      '& div': {\n        width: '100%'\n      }\n    },\n    outlinedDivError: {\n      borderColor: `${theme.palette.error.main} !important`,\n      '&:hover': {\n        borderColor: `${theme.palette.error.main} !important`\n      }\n    },\n    toggleSidebar: {\n      display: 'inline-flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      float: 'left',\n      width: '50px',\n      minWidth: '50px',\n      height: '50px',\n      fontSize: '2em',\n      backgroundColor: theme.palette.primary.main,\n      color: theme.palette.text.primary,\n      '&:hover': {\n        cursor: 'pointer'\n      }\n    },\n    cancelButton: {\n      alignSelf: 'flex-end',\n      marginTop: '5px',\n      padding: '5px 15px',\n      fontSize: '1em'\n    },\n    buildCriteriaContainer: {\n      display: 'flex',\n      justifyContent: 'space-between'\n    },\n    saveButton: {\n      marginLeft: '1em'\n    }\n  }),\n  { name: 'Sidebar', index: 1 }\n);\n","import React, { FC, memo, useCallback, useState, useEffect, useRef, RefObject } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faChevronLeft, faChevronRight } from '@fortawesome/free-solid-svg-icons';\n\nimport { SidebarHeader, BranchNodeEditor, ActionNodeEditor, NullNode } from '.';\nimport { PathwayNode, ActionNode, BranchNode, Pathway } from 'pathways-model';\nimport { setNodeNodeType, addTransition, createNode, addNode, getNodeType } from 'utils/builder';\nimport { usePathwayContext } from 'components/PathwayProvider';\nimport useStyles from './styles';\n\ninterface SidebarProps {\n  pathway: Pathway;\n  headerElement: RefObject<HTMLDivElement>;\n  currentNode: ActionNode | BranchNode | PathwayNode;\n}\n\nconst Sidebar: FC<SidebarProps> = ({ pathway, headerElement, currentNode }) => {\n  const { updatePathway } = usePathwayContext();\n  const [isExpanded, setIsExpanded] = useState<boolean>(true);\n  const styles = useStyles();\n  const history = useHistory();\n  const sidebarContainerElement = useRef<HTMLDivElement>(null);\n  const currentNodeKey = currentNode?.key;\n\n  const toggleSidebar = useCallback((): void => {\n    setIsExpanded(!isExpanded);\n  }, [isExpanded]);\n\n  const changeNodeType = useCallback(\n    (nodeType: string): void => {\n      if (currentNodeKey) updatePathway(setNodeNodeType(pathway, currentNodeKey, nodeType));\n    },\n    [pathway, updatePathway, currentNodeKey]\n  );\n\n  const redirectToNode = useCallback(\n    nodeKey => {\n      const url = `/builder/${encodeURIComponent(pathway.id)}/node/${encodeURIComponent(nodeKey)}`;\n      if (url !== history.location.pathname) {\n        history.push(url);\n      }\n    },\n    [history, pathway.id]\n  );\n\n  const addPathwayNode = useCallback(\n    (nodeType: string): void => {\n      if (!currentNodeKey) return;\n\n      const newNode = createNode();\n      let newPathway = addNode(pathway, newNode);\n      newPathway = addTransition(newPathway, currentNodeKey, newNode.key as string);\n      newPathway = setNodeNodeType(newPathway, newNode.key as string, nodeType);\n      updatePathway(newPathway);\n      redirectToNode(newNode.key);\n    },\n    [pathway, updatePathway, currentNodeKey, redirectToNode]\n  );\n\n  // Set the height of the sidebar container\n  useEffect(() => {\n    if (sidebarContainerElement?.current && headerElement?.current)\n      sidebarContainerElement.current.style.height =\n        window.innerHeight - headerElement.current.clientHeight + 'px';\n  }, [isExpanded, headerElement]);\n\n  const nodeType = getNodeType(pathway, currentNodeKey);\n  return (\n    <>\n      {isExpanded && (\n        <div className={styles.root} ref={sidebarContainerElement}>\n          <SidebarHeader pathway={pathway} currentNode={currentNode} isTransition={false} />\n\n          <hr className={styles.divider} />\n\n          {nodeType === 'null' && (\n            <NullNode\n              pathway={pathway}\n              currentNode={currentNode}\n              changeNodeType={changeNodeType}\n              addNode={addPathwayNode}\n            />\n          )}\n\n          {nodeType === 'action' && (\n            <ActionNodeEditor\n              pathway={pathway}\n              currentNode={currentNode as ActionNode}\n              changeNodeType={changeNodeType}\n              addNode={addPathwayNode}\n            />\n          )}\n\n          {nodeType === 'branch' && (\n            <BranchNodeEditor\n              pathway={pathway}\n              currentNode={currentNode}\n              changeNodeType={changeNodeType}\n            />\n          )}\n        </div>\n      )}\n\n      <div className={styles.toggleSidebar} onClick={toggleSidebar}>\n        <FontAwesomeIcon icon={isExpanded ? faChevronLeft : faChevronRight} />\n      </div>\n    </>\n  );\n};\n\nexport default memo(Sidebar);\n","import React, { FC, memo, useCallback, useRef, useState, KeyboardEvent, FocusEvent } from 'react';\nimport clsx from 'clsx';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faEdit,\n  faEllipsisH,\n  faChevronLeft,\n  faChevronRight\n} from '@fortawesome/free-solid-svg-icons';\nimport { IconButton, FormControl, Input } from '@material-ui/core';\n\nimport { Pathway, PathwayNode } from 'pathways-model';\nimport { setNodeLabel } from 'utils/builder';\nimport { usePathwayContext } from 'components/PathwayProvider';\nimport useStyles from './styles';\n\ninterface SidebarHeaderProps {\n  pathway: Pathway;\n  currentNode: PathwayNode;\n  isTransition: boolean;\n}\n\nconst SidebarHeader: FC<SidebarHeaderProps> = ({ pathway, currentNode, isTransition }) => {\n  const { updatePathway } = usePathwayContext();\n  const [showInput, setShowInput] = useState<boolean>(false);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const currentNodeKey = currentNode?.key;\n  const currentNodeLabel = currentNode?.label || '';\n  const styles = useStyles();\n\n  const goToParentNode = useCallback(() => {\n    // TODO\n  }, []);\n\n  const goToNode = useCallback(() => {\n    // TODO\n  }, []);\n\n  const openNodeOptions = useCallback(() => {\n    // TODO\n  }, []);\n\n  const changeNodeLabel = useCallback(() => {\n    const label = inputRef.current?.value ?? '';\n    if (currentNodeKey) updatePathway(setNodeLabel(pathway, currentNodeKey, label));\n    setShowInput(false);\n  }, [pathway, updatePathway, currentNodeKey]);\n\n  const handleShowInput = useCallback(() => {\n    setShowInput(true);\n  }, []);\n\n  const handleKeyPress = useCallback(\n    (event: KeyboardEvent<HTMLDivElement>): void => {\n      if (event.key === 'Enter') changeNodeLabel();\n    },\n    [changeNodeLabel]\n  );\n\n  return (\n    <div className={styles.sidebarHeader}>\n      <div className={styles.sidebarHeaderGroup}>\n        {currentNodeKey !== 'Start' && !isTransition && (\n          <IconButton\n            className={styles.sidebarHeaderButton}\n            onClick={goToParentNode}\n            aria-label=\"go to parent node\"\n          >\n            <FontAwesomeIcon icon={faChevronLeft} />\n          </IconButton>\n        )}\n\n        <div className={styles.headerLabelGroup} onClick={handleShowInput}>\n          {showInput && currentNodeKey !== 'Start' ? (\n            <FormControl className={styles.formControl} fullWidth>\n              <Input\n                className={styles.headerLabel}\n                type=\"text\"\n                inputRef={inputRef}\n                onBlur={changeNodeLabel}\n                onKeyPress={handleKeyPress}\n                defaultValue={currentNodeLabel}\n                autoFocus\n                onFocus={(event: FocusEvent<HTMLInputElement>): void => event.target.select()}\n              />\n            </FormControl>\n          ) : (\n            <div\n              className={clsx(\n                styles.headerLabel,\n                styles.headerLabelText,\n                currentNodeKey === 'Start' && styles.headerLabelStart\n              )}\n            >\n              {currentNodeLabel}\n              {currentNodeKey !== 'Start' && (\n                <FontAwesomeIcon className={styles.editIcon} icon={faEdit} />\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n\n      <div className={styles.sidebarHeaderGroup}>\n        <IconButton\n          className={styles.sidebarHeaderButton}\n          onClick={isTransition ? goToNode : openNodeOptions}\n          aria-label={isTransition ? 'go to transition node' : 'open node options'}\n        >\n          <FontAwesomeIcon icon={isTransition ? faChevronRight : faEllipsisH} />\n        </IconButton>\n      </div>\n    </div>\n  );\n};\n\nexport default memo(SidebarHeader);\n","import React, { FC, memo, ReactNode } from 'react';\nimport { Button } from '@material-ui/core';\n\nimport useStyles from './styles';\n\ninterface SidebarButtonProps {\n  buttonName: string;\n  buttonIcon: ReactNode;\n  buttonText: string;\n  onClick?: () => void;\n}\n\nconst SidebarButton: FC<SidebarButtonProps> = ({ buttonName, buttonIcon, buttonText, onClick }) => {\n  const styles = useStyles();\n\n  return (\n    <div className={styles.sidebarButtonGroup}>\n      <Button\n        className={styles.sidebarButton}\n        variant=\"contained\"\n        color=\"primary\"\n        startIcon={buttonIcon}\n        onClick={onClick}\n      >\n        {buttonName}\n      </Button>\n\n      <div className={styles.sidebarButtonText}>{buttonText}</div>\n    </div>\n  );\n};\n\nexport default memo(SidebarButton);\n","import React, { FC, memo, useCallback, ChangeEvent } from 'react';\nimport { InputLabel, FormControl, Select, MenuItem } from '@material-ui/core';\n\ninterface Option {\n  label: string;\n  value: string;\n}\n\ninterface DropDownProps {\n  id: string;\n  label: string;\n  options: Array<Option>;\n  value?: string;\n  onChange: Function | null;\n}\n\nconst DropDown: FC<DropDownProps> = ({ id, label, options, value, onChange }: DropDownProps) => {\n  const handleSetSelected = useCallback(\n    (event: ChangeEvent<{ value: unknown }>): void => {\n      if (onChange) onChange(event);\n    },\n    [onChange]\n  );\n\n  return (\n    <FormControl variant=\"outlined\" fullWidth>\n      <InputLabel id={id} htmlFor={`${id}-select`}>\n        {label}\n      </InputLabel>\n\n      <Select\n        id={`${id}-select`}\n        value={value || ''}\n        onChange={handleSetSelected}\n        label={label}\n        error={value == null || value === ''}\n        MenuProps={{\n          getContentAnchorEl: null,\n          anchorOrigin: {\n            vertical: 'bottom',\n            horizontal: 'center'\n          },\n          transformOrigin: {\n            vertical: 'top',\n            horizontal: 'center'\n          }\n        }}\n        displayEmpty\n      >\n        {options.map(option => (\n          <MenuItem key={option.value} value={option.value}>\n            {option.label}\n          </MenuItem>\n        ))}\n      </Select>\n    </FormControl>\n  );\n};\n\nexport default memo(DropDown);\n","import React, { FC, memo, useCallback, ChangeEvent } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faPlus } from '@fortawesome/free-solid-svg-icons';\n\nimport { SidebarButton, BranchTransition } from '.';\nimport DropDown from 'components/elements/DropDown';\nimport { addTransition, createNode, addNode } from 'utils/builder';\nimport { Pathway, PathwayNode } from 'pathways-model';\nimport { usePathwayContext } from 'components/PathwayProvider';\n\nimport useStyles from './styles';\n\nconst nodeTypeOptions = [\n  { value: 'action', label: 'Action' },\n  { value: 'branch', label: 'Branch' }\n];\n\ninterface BranchNodeEditorProps {\n  pathway: Pathway;\n  currentNode: PathwayNode;\n  changeNodeType: (event: string) => void;\n}\n\nconst BranchNodeEditor: FC<BranchNodeEditorProps> = ({ pathway, currentNode, changeNodeType }) => {\n  const { updatePathway } = usePathwayContext();\n  const currentNodeKey = currentNode?.key;\n  const styles = useStyles();\n\n  const selectNodeType = useCallback(\n    (event: ChangeEvent<{ value: string }>): void => {\n      changeNodeType(event?.target.value || '');\n    },\n    [changeNodeType]\n  );\n\n  const handleAddTransition = useCallback((): void => {\n    const newNode = createNode();\n\n    const newPathway = addNode(pathway, newNode);\n    updatePathway(addTransition(newPathway, currentNodeKey || '', newNode.key as string));\n  }, [pathway, updatePathway, currentNodeKey]);\n\n  return (\n    <>\n      <DropDown\n        id=\"nodeType\"\n        label=\"Node Type\"\n        options={nodeTypeOptions}\n        onChange={selectNodeType}\n        value=\"branch\"\n      />\n      {currentNode.transitions.map(transition => {\n        return (\n          <BranchTransition\n            key={transition.id}\n            pathway={pathway}\n            currentNodeKey={currentNodeKey || ''}\n            transition={transition}\n          />\n        );\n      })}\n\n      <hr className={styles.divider} />\n\n      <SidebarButton\n        buttonName=\"Add Transition\"\n        buttonIcon={<FontAwesomeIcon icon={faPlus} />}\n        buttonText=\"Add transition logic for a clinical decision within a workflow.\"\n        onClick={handleAddTransition}\n      />\n    </>\n  );\n};\n\nexport default memo(BranchNodeEditor);\n","// External CQL -> ELM service\nimport { CqlObject } from './cql-extractor';\nimport config from 'utils/ConfigManager';\nimport {\n  extractJSONContent,\n  extractMultipartBoundary,\n  extractMultipartFileName\n} from 'utils/regexes';\n\nconst url = config.get('cqlToElmWebserviceUrl');\n\nexport interface ElmObject {\n  main: object;\n  libraries: {\n    [key: string]: object;\n  };\n}\n\n/**\n * Function that requests web_service to convert the cql into elm.\n * @param cql - cql file that is the input to the function.\n * @return The resulting elm translation of the cql file.\n */\nexport default function convertCQL(cql: CqlObject): Promise<ElmObject> {\n  // Connect to web service\n  const formdata = new FormData();\n  Object.keys(cql.libraries).forEach((key, i) => {\n    formdata.append(`${key}`, cql.libraries[key]);\n  });\n\n  formdata.append('main', cql.main);\n  return fetch(url, {\n    method: 'POST',\n    body: formdata\n  }).then(elm => {\n    const header = elm.headers.get('content-type');\n    let boundary = '';\n    if (header) {\n      // sample header= \"multipart/form-data;boundary=Boundary_1\"\n      const result = extractMultipartBoundary.exec(header);\n      boundary = result ? `--${result[1]}` : '';\n    }\n    const obj: ElmObject = { main: {}, libraries: {} };\n    return elm.text().then(text => {\n      const elms = text.split(boundary).reduce((oldArray, line, i) => {\n        const body = extractJSONContent.exec(line);\n        if (body) {\n          const elmName = extractMultipartFileName.exec(line);\n          if (elmName && elmName[1] === 'main') {\n            oldArray[elmName[1]] = JSON.parse(body[1]);\n          } else if (elmName) {\n            oldArray.libraries[elmName[1]] = JSON.parse(body[1]);\n          }\n        }\n        return oldArray;\n      }, obj);\n\n      return elms;\n    });\n  });\n}\n\nexport function convertBasicCQL(cql: string): Promise<object> {\n  // Connect to web service\n\n  return fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/cql',\n      Accept: 'application/elm+json'\n    },\n    body: cql\n  }).then(elm => elm.json());\n}\n","import React, { FC, memo, useCallback, ChangeEvent } from 'react';\nimport { SidebarButton } from '.';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faPlus, faCheckCircle } from '@fortawesome/free-solid-svg-icons';\nimport { setNodeAction, createCQL, setActionDescription, setActionNodeElm } from 'utils/builder';\nimport DropDown from 'components/elements/DropDown';\nimport { Pathway, ActionNode, Action } from 'pathways-model';\nimport { ElmLibrary } from 'elm-model';\nimport useStyles from './styles';\nimport shortid from 'shortid';\nimport { TextField } from '@material-ui/core';\nimport { convertBasicCQL } from 'engine/cql-to-elm';\nimport { usePathwayContext } from 'components/PathwayProvider';\n\nconst nodeTypeOptions = [\n  { label: 'Action', value: 'action' },\n  { label: 'Branch', value: 'branch' }\n];\n\nconst actionTypeOptions = [\n  { label: 'Medication', value: 'MedicationRequest' },\n  { label: 'Procedure', value: 'ServiceRequest' },\n  { label: 'Regimen', value: 'CarePlan' }\n];\n\nconst codeSystemOptions = [\n  { label: 'ICD-9-CM', value: 'http://hl7.org/fhir/sid/icd-9-cm' },\n  { label: 'ICD-10-CM', value: 'http://hl7.org/fhir/sid/icd-10-cm' },\n  { label: 'LOINC', value: 'http://loinc.org' },\n  { label: 'NCI', value: 'http://ncimeta.nci.nih.gov' },\n  { label: 'RXNORM', value: 'http://www.nlm.nih.gov/research/umls/rxnorm' },\n  { label: 'SNOMED', value: 'http://snomed.info/sct' }\n];\n\ninterface ActionNodeEditorProps {\n  pathway: Pathway;\n  currentNode: ActionNode;\n  changeNodeType: (event: string) => void;\n  addNode: (event: string) => void;\n}\n\nconst ActionNodeEditor: FC<ActionNodeEditorProps> = ({\n  pathway,\n  currentNode,\n  changeNodeType,\n  addNode\n}) => {\n  const { updatePathway } = usePathwayContext();\n  const styles = useStyles();\n  const selectNodeType = useCallback(\n    (event: ChangeEvent<{ value: string }>): void => {\n      changeNodeType(event?.target.value || '');\n    },\n    [changeNodeType]\n  );\n\n  const addActionCQL = useCallback(\n    (action: Action, currentNodeKey: string): void => {\n      const cql = createCQL(action, currentNodeKey);\n      convertBasicCQL(cql).then(elm => {\n        updatePathway(setActionNodeElm(pathway, currentNodeKey, elm as ElmLibrary));\n      });\n    },\n    [pathway, updatePathway]\n  );\n\n  const changeCode = useCallback(\n    (event: ChangeEvent<{ value: string }>): void => {\n      if (!currentNode.key) return;\n\n      const code = event?.target.value || '';\n      const action: Action = currentNode.action[0];\n      if (action.resource.medicationCodeableConcept) {\n        action.resource.medicationCodeableConcept.coding[0].code = code;\n      } else {\n        action.resource.code.coding[0].code = code;\n      }\n      resetDisplay(action);\n      updatePathway(setNodeAction(pathway, currentNode.key, [action]));\n    },\n    [currentNode, pathway, updatePathway]\n  );\n\n  const changeDescription = useCallback(\n    (event: ChangeEvent<{ value: string }>): void => {\n      if (!currentNode.key) return;\n\n      const description = event?.target.value || '';\n      const actionId = currentNode.action[0].id; // TODO: change this for supporting multiple action\n      if (actionId) {\n        setActionDescription(pathway, currentNode.key, actionId, description);\n        updatePathway(setNodeAction(pathway, currentNode.key, currentNode.action));\n      }\n    },\n    [currentNode, pathway, updatePathway]\n  );\n\n  const changeTitle = useCallback(\n    (event: ChangeEvent<{ value: string }>): void => {\n      if (!currentNode.key) return;\n\n      const title = event?.target.value || '';\n      const action = currentNode.action[0];\n      action.resource.title = title;\n      resetDisplay(action);\n      updatePathway(setNodeAction(pathway, currentNode.key, [action]));\n\n      addActionCQL(action, currentNode.key);\n    },\n    [currentNode, pathway, updatePathway, addActionCQL]\n  );\n\n  const selectActionType = useCallback(\n    (event: ChangeEvent<{ value: string }>): void => {\n      if (!currentNode.key) return;\n      const value = event?.target.value || '';\n      const actionType = actionTypeOptions.find(option => {\n        return option.value === value;\n      });\n      let action: Action;\n      if (actionType?.value === 'CarePlan') {\n        action = {\n          type: 'create',\n          description: '',\n          id: shortid.generate(),\n          resource: {\n            resourceType: actionType?.value,\n            title: ''\n          }\n        };\n      } else if (actionType?.value === 'MedicationRequest') {\n        action = {\n          type: 'create',\n          description: '',\n          id: shortid.generate(),\n          resource: {\n            resourceType: actionType?.value,\n            medicationCodeableConcept: {\n              coding: [\n                {\n                  system: '',\n                  code: '',\n                  display: ''\n                }\n              ]\n            }\n          }\n        };\n      } else {\n        action = {\n          type: 'create',\n          description: '',\n          id: shortid.generate(),\n          resource: {\n            resourceType: actionType?.value,\n            code: {\n              coding: [\n                {\n                  system: '',\n                  code: '',\n                  display: ''\n                }\n              ]\n            }\n          }\n        };\n      }\n\n      updatePathway(setNodeAction(pathway, currentNode.key, [action]));\n    },\n    [currentNode, pathway, updatePathway]\n  );\n\n  const selectCodeSystem = useCallback(\n    (event: ChangeEvent<{ value: string }>): void => {\n      if (!currentNode.key) return;\n\n      const codeSystem = event?.target.value || '';\n      const action = currentNode.action[0];\n      if (action.resource.medicationCodeableConcept) {\n        action.resource.medicationCodeableConcept.coding[0].system = codeSystem;\n      } else {\n        action.resource.code.coding[0].system = codeSystem;\n      }\n      resetDisplay(action);\n      updatePathway(setNodeAction(pathway, currentNode.key, [action]));\n    },\n    [currentNode, pathway, updatePathway]\n  );\n\n  const validateFunction = (): void => {\n    if (currentNode.key && currentNode.action.length) {\n      const action = currentNode.action[0];\n      if (action.resource.medicationCodeableConcept) {\n        action.resource.medicationCodeableConcept.coding[0].display = 'Example display text';\n      } else if (action.resource.title) {\n        action.resource.description = 'Example CarePlan Text';\n      } else {\n        action.resource.code.coding[0].display = 'Example display text'; // TODO: actually validate\n      }\n      updatePathway(setNodeAction(pathway, currentNode.key, [action]));\n\n      addActionCQL(action, currentNode.key);\n    } else {\n      console.error('No Actions -- Cannot Validate');\n    }\n  };\n\n  const resetDisplay = (action: Action): void => {\n    if (action.resource.medicationCodeableConcept) {\n      action.resource.medicationCodeableConcept.coding[0].display = '';\n    } else if (action.resource.resourceType === 'CarePlan') {\n      action.resource.description = '';\n    } else {\n      action.resource.code.coding[0].display = ''; // TODO: actually validate\n    }\n  };\n\n  const onEnter = (e: React.KeyboardEvent<HTMLInputElement>): void => {\n    if (e.key === 'Enter') {\n      validateFunction();\n    }\n  };\n\n  // The node has a key and is not the start node\n  const changeNodeTypeEnabled = currentNode.key !== undefined && currentNode.key !== 'Start';\n\n  const action = currentNode.action;\n  const resource = action?.length > 0 && action[0].resource;\n  let system = '';\n  let code = '';\n  let display = '';\n  if (resource.resourceType === 'MedicationRequest' || resource.resourceType === 'ServiceRequest') {\n    system = resource.code\n      ? resource.code.coding[0].system\n      : resource.medicationCodeableConcept.coding[0].system;\n    code = resource.code\n      ? resource.code.coding[0].code\n      : resource.medicationCodeableConcept.coding[0].code;\n    display = resource.code\n      ? resource.code.coding[0].display\n      : resource.medicationCodeableConcept.coding[0].display;\n  } else {\n    display = resource.description;\n  }\n  // If the node does not have transitions it can be added to\n  const displayAddButtons = currentNode.key !== undefined && currentNode.transitions.length === 0;\n  return (\n    <>\n      {changeNodeTypeEnabled && (\n        <>\n          <DropDown\n            id=\"nodeType\"\n            label=\"Node Type\"\n            options={nodeTypeOptions}\n            onChange={selectNodeType}\n            value=\"action\"\n          />\n          <DropDown\n            id=\"actionType\"\n            label=\"Action Type\"\n            options={actionTypeOptions}\n            onChange={selectActionType}\n            value={resource.resourceType}\n          />\n          {(resource.resourceType === 'MedicationRequest' ||\n            resource.resourceType === 'ServiceRequest') && (\n            <>\n              <DropDown\n                id=\"codeSystem\"\n                label=\"Code System\"\n                options={codeSystemOptions}\n                onChange={selectCodeSystem}\n                value={system}\n              />\n              {system && (\n                <TextField\n                  id=\"code-input\"\n                  label=\"Code\"\n                  value={code}\n                  onChange={changeCode}\n                  variant=\"outlined\"\n                  error={code === ''}\n                  inputProps={{ onKeyPress: onEnter }}\n                />\n              )}\n              {code && (\n                <>\n                  {display ? (\n                    <div className={styles.displayText}>\n                      <FontAwesomeIcon icon={faCheckCircle} /> {display}\n                    </div>\n                  ) : (\n                    <SidebarButton\n                      buttonName=\"Validate\"\n                      buttonIcon={<FontAwesomeIcon icon={faCheckCircle} />}\n                      buttonText={display || 'Check validation of the input system and code'}\n                      onClick={validateFunction}\n                    />\n                  )}\n\n                  <TextField\n                    id=\"description-input\"\n                    label=\"Description\"\n                    value={action[0].description || ''}\n                    onChange={changeDescription}\n                    variant=\"outlined\"\n                    error={action[0].description === ''}\n                  />\n                </>\n              )}\n            </>\n          )}\n\n          {resource.resourceType === 'CarePlan' && (\n            // design for careplan ?\n            <>\n              <TextField\n                id=\"title-input\"\n                label=\"Title\"\n                value={resource.title || ''}\n                onChange={changeTitle}\n                variant=\"outlined\"\n                error={resource.title == null}\n                inputProps={{ onKeyPress: onEnter }}\n              />\n              {resource.title && (\n                <TextField\n                  id=\"description-input\"\n                  label=\"Description\"\n                  value={action[0].description || ''}\n                  onChange={changeDescription}\n                  variant=\"outlined\"\n                  error={action[0].description === ''}\n                />\n              )}\n            </>\n          )}\n        </>\n      )}\n      {displayAddButtons && (\n        <>\n          {changeNodeTypeEnabled && <hr className={styles.divider} />}\n          <SidebarButton\n            buttonName=\"Add Action Node\"\n            buttonIcon={<FontAwesomeIcon icon={faPlus} />}\n            buttonText=\"Any clinical or workflow step which is not a decision.\"\n            onClick={(): void => addNode('action')}\n          />\n\n          <SidebarButton\n            buttonName=\"Add Branch Node\"\n            buttonIcon={<FontAwesomeIcon icon={faPlus} />}\n            buttonText=\"A logical branching point based on clinical or workflow criteria.\"\n            onClick={(): void => addNode('branch')}\n          />\n        </>\n      )}\n    </>\n  );\n};\n\nexport default memo(ActionNodeEditor);\n","import React, { FC, memo, useCallback, ChangeEvent } from 'react';\n\nimport DropDown from 'components/elements/DropDown';\nimport { Pathway, PathwayNode } from 'pathways-model';\n\nconst nodeTypeOptions = [\n  { label: '', value: '' },\n  { label: 'Action', value: 'action' },\n  { label: 'Branch', value: 'branch' }\n];\n\ninterface NullNodeProps {\n  pathway: Pathway;\n  currentNode: PathwayNode;\n  changeNodeType: (event: string) => void;\n  addNode: (event: string) => void;\n}\n\nconst NullNode: FC<NullNodeProps> = ({ pathway, currentNode, changeNodeType, addNode }) => {\n  const selectNodeType = useCallback(\n    (event: ChangeEvent<{ value: string }>): void => {\n      changeNodeType(event?.target.value || '');\n    },\n    [changeNodeType]\n  );\n\n  // The node has a key and is not the start node\n  const changeNodeTypeEnabled = currentNode.key !== undefined && currentNode.key !== 'Start';\n\n  return (\n    <>\n      {changeNodeTypeEnabled && (\n        <DropDown\n          id=\"nodeType\"\n          label=\"Node Type\"\n          options={nodeTypeOptions}\n          onChange={selectNodeType}\n          value=\"\"\n        />\n      )}\n    </>\n  );\n};\n\nexport default memo(NullNode);\n","import React, { FC, memo, useState, useCallback, ChangeEvent, useEffect } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faPlus, faSave, faTools, faTrashAlt } from '@fortawesome/free-solid-svg-icons';\nimport DropDown from 'components/elements/DropDown';\nimport { Button, Checkbox, FormControlLabel, TextField, Box } from '@material-ui/core';\nimport {\n  removeTransitionCondition,\n  setTransitionCondition,\n  setTransitionConditionDescription\n} from 'utils/builder';\nimport { OutlinedDiv, SidebarHeader, SidebarButton } from '.';\nimport { Pathway, Transition } from 'pathways-model';\nimport { useCriteriaContext } from 'components/CriteriaProvider';\nimport { usePathwayContext } from 'components/PathwayProvider';\nimport useStyles from './styles';\n\ninterface BranchTransitionProps {\n  pathway: Pathway;\n  currentNodeKey: string;\n  transition: Transition;\n}\n\nconst BranchTransition: FC<BranchTransitionProps> = ({ pathway, currentNodeKey, transition }) => {\n  const { updatePathway } = usePathwayContext();\n  const { criteria, buildCriteriaNodeId, updateBuildCriteriaNodeId } = useCriteriaContext();\n  const criteriaOptions = criteria.map(c => ({ value: c.id, label: c.label }));\n  const styles = useStyles();\n  const transitionKey = transition?.transition || '';\n  const transitionNode = pathway.nodes[transitionKey];\n  const [useCriteriaSelected, setUseCriteriaSelected] = useState<boolean>(false);\n  const criteriaDescription = transition.condition?.description;\n  const criteriaIsValid = criteriaDescription != null;\n  const criteriaDisplayIsValid = criteriaDescription && criteriaDescription !== '';\n  const hasCriteria = transition.condition?.cql || transition.condition?.description;\n  const buttonText = hasCriteria ? 'DELETE' : 'CANCEL';\n  const icon = hasCriteria ? <FontAwesomeIcon icon={faTrashAlt} /> : null;\n  const displayCriteria =\n    useCriteriaSelected || transition.condition?.cql || transition.condition?.description;\n  const [buildCriteriaSelected, setBuildCriteriaSelected] = useState<boolean>(false);\n  const [criteriaName, setCriteriaName] = useState<string>('');\n\n  const handleUseCriteria = useCallback((): void => {\n    if (hasCriteria && transition.id) {\n      // delete the transition criteria\n      updatePathway(removeTransitionCondition(pathway, currentNodeKey, transition.id));\n      setUseCriteriaSelected(false);\n    } else {\n      setUseCriteriaSelected(!useCriteriaSelected);\n    }\n  }, [useCriteriaSelected, currentNodeKey, pathway, hasCriteria, transition.id, updatePathway]);\n\n  const selectCriteriaSource = useCallback(\n    (event: ChangeEvent<{ value: string }>): void => {\n      if (!currentNodeKey || !transition.id) return;\n\n      const criteriaSource = event?.target.value || '';\n      let elm = undefined;\n      criteria.forEach(c => {\n        if (c.id === criteriaSource) {\n          elm = c.elm;\n        }\n      });\n      if (!elm) return;\n      updatePathway(\n        setTransitionCondition(\n          pathway,\n          currentNodeKey,\n          transition.id,\n          transition.condition?.description || '',\n          elm,\n          criteriaSource\n        )\n      );\n    },\n    [currentNodeKey, transition.id, updatePathway, pathway, transition.condition, criteria]\n  );\n\n  const setCriteriaDisplay = useCallback(\n    (event: ChangeEvent<{ value: string }>): void => {\n      if (!currentNodeKey || !transition.id) return;\n\n      const criteriaDisplay = event?.target.value || '';\n      updatePathway(\n        setTransitionConditionDescription(pathway, currentNodeKey, transition.id, criteriaDisplay)\n      );\n    },\n    [currentNodeKey, transition.id, updatePathway, pathway]\n  );\n\n  const handleCriteriaName = useCallback(\n    (event: ChangeEvent<{ value: string }>): void => {\n      setCriteriaName(event?.target.value || '');\n    },\n    [setCriteriaName]\n  );\n\n  const handleBuildCriteria = useCallback((): void => {\n    updateBuildCriteriaNodeId(transition.id ?? '');\n    setBuildCriteriaSelected(!buildCriteriaSelected);\n  }, [buildCriteriaSelected, updateBuildCriteriaNodeId, transition]);\n\n  const handleBuildCriteriaCancel = useCallback((): void => {\n    if (buildCriteriaNodeId === transition.id) updateBuildCriteriaNodeId('');\n    setBuildCriteriaSelected(false);\n    setCriteriaName('');\n  }, [updateBuildCriteriaNodeId, setCriteriaName, buildCriteriaNodeId, transition]);\n\n  // Cancel current build criteria if clicked on another BranchTransition\n  useEffect(() => {\n    if (buildCriteriaNodeId !== '' && buildCriteriaNodeId !== transition.id) {\n      handleBuildCriteriaCancel();\n    }\n  }, [buildCriteriaNodeId, handleBuildCriteriaCancel, transition]);\n\n  return (\n    <>\n      <hr className={styles.divider} />\n\n      <SidebarHeader pathway={pathway} currentNode={transitionNode} isTransition={true} />\n\n      {!displayCriteria && !buildCriteriaSelected && (\n        <SidebarButton\n          buttonName=\"Use Criteria\"\n          buttonIcon={<FontAwesomeIcon icon={faPlus} />}\n          buttonText=\"Add previously built or imported criteria logic to branch node.\"\n          onClick={handleUseCriteria}\n        />\n      )}\n\n      {displayCriteria && (\n        <OutlinedDiv label=\"Criteria Selector\" error={!criteriaIsValid || !criteriaDisplayIsValid}>\n          <>\n            <DropDown\n              id=\"Criteria\"\n              label=\"Criteria\"\n              options={criteriaOptions}\n              onChange={selectCriteriaSource}\n              value={transition.condition?.cql || undefined}\n            />\n\n            <TextField\n              label=\"Criteria Display\"\n              value={transition.condition?.description || ''}\n              variant=\"outlined\"\n              onChange={setCriteriaDisplay}\n              error={!criteriaDisplayIsValid}\n            />\n          </>\n\n          <Button\n            className={styles.cancelButton}\n            color=\"inherit\"\n            size=\"small\"\n            variant=\"outlined\"\n            startIcon={icon}\n            onClick={handleUseCriteria}\n          >\n            {buttonText}\n          </Button>\n        </OutlinedDiv>\n      )}\n\n      {!displayCriteria && !buildCriteriaSelected && (\n        <SidebarButton\n          buttonName=\"Build Criteria\"\n          buttonIcon={<FontAwesomeIcon icon={faTools} />}\n          buttonText=\"Create new criteria logic to add to branch node.\"\n          onClick={handleBuildCriteria}\n        />\n      )}\n\n      {buildCriteriaSelected && (\n        <OutlinedDiv label=\"Criteria Builder\" error={true}>\n          <TextField\n            error={criteriaName === ''}\n            label=\"Criteria Name\"\n            variant=\"outlined\"\n            onChange={handleCriteriaName}\n            fullWidth\n          />\n          <div className={styles.buildCriteriaContainer}>\n            <FormControlLabel\n              label={<Box fontStyle=\"italic\">Add to reusable criteria</Box>}\n              control={<Checkbox color=\"default\" />}\n            />\n            <Button\n              color=\"inherit\"\n              size=\"large\"\n              variant=\"outlined\"\n              onClick={handleBuildCriteriaCancel}\n            >\n              Cancel\n            </Button>\n            <Button\n              className={styles.saveButton}\n              color=\"inherit\"\n              size=\"large\"\n              variant=\"outlined\"\n              startIcon={<FontAwesomeIcon icon={faSave} />}\n              disabled\n            >\n              Save\n            </Button>\n          </div>\n        </OutlinedDiv>\n      )}\n    </>\n  );\n};\n\nexport default memo(BranchTransition);\n","import React, { FC, memo, ReactNode } from 'react';\nimport clsx from 'clsx';\n\nimport TextField from '@material-ui/core/TextField';\nimport useStyles from './styles';\n\ninterface InputComponentProps {\n  children?: ReactNode;\n}\n\nconst InputComponent: FC<InputComponentProps> = ({ children }) => {\n  return <>{children}</>;\n};\n\ninterface OutlinedDivProps {\n  children: ReactNode;\n  label: string;\n  error: boolean;\n}\n\nconst OutlinedDiv: FC<OutlinedDivProps> = ({ children, label, error }) => {\n  const styles = useStyles();\n\n  return (\n    <TextField\n      variant=\"outlined\"\n      label={label}\n      multiline\n      InputLabelProps={{ shrink: true }}\n      InputProps={{\n        inputComponent: InputComponent,\n        classes: {\n          root: clsx(styles.outlinedDiv, error && styles.outlinedDivError),\n          notchedOutline: clsx(error && styles.outlinedDivError)\n        }\n      }}\n      inputProps={{ children }}\n    />\n  );\n};\n\nexport default memo(OutlinedDiv);\n","/* eslint-disable guard-for-in */\n/* eslint-disable max-len */\n\nimport { Pathway, PathwayNode } from 'pathways-model';\nimport { Node, Nodes, Layout, NodeCoordinates, Edges, NodeDimensions } from 'graph-model';\n\nimport dagre from 'dagre';\n\nimport config from 'utils/ConfigManager';\nconst graphLayoutProvider = config.get('graphLayoutProvider', 'dagre');\n\n/**\n * Obtain the graph layout for the pathway as coordinates for every node\n *\n * @param pathway - JSON pathway\n */\nexport default function layout(pathway: Pathway, nodeDimensions: NodeDimensions): Layout {\n  return graphLayoutProvider === 'dagre'\n    ? layoutDagre(pathway, nodeDimensions)\n    : layoutCustom(pathway);\n}\n\n/**\n * Layout the pathway using the Dagre layout engine.\n * @see {@link https://github.com/dagrejs/dagre}\n */\nfunction layoutDagre(pathway: Pathway, nodeDimensions: NodeDimensions): Layout {\n  const START = 'Start';\n  const NODE_HEIGHT = 50;\n  const NODE_WIDTH_FACTOR = 10; // factor to convert label length => width, assume font size roughly 10\n  const nodeKeys = Object.keys(pathway.nodes);\n  const g = new dagre.graphlib.Graph();\n\n  g.setGraph({});\n  g.setDefaultEdgeLabel(() => ({})); // dagre requires a default edge label, we want it to just be empty\n\n  nodeKeys.forEach(nodeKey => {\n    const node: PathwayNode = pathway.nodes[nodeKey];\n    const nodeDimension = nodeDimensions[nodeKey];\n\n    if (nodeDimension) {\n      g.setNode(nodeKey, {\n        label: node.label,\n        width: nodeDimension.width,\n        height: nodeDimension.height\n      });\n    } else {\n      g.setNode(nodeKey, {\n        label: node.label,\n        width: node.label.length * NODE_WIDTH_FACTOR,\n        height: NODE_HEIGHT\n      });\n    }\n\n    node.transitions.forEach(transition => {\n      const label = transition.condition\n        ? {\n            label: transition.condition.description,\n            width: 25,\n            height: 20\n          }\n        : {};\n\n      g.setEdge(nodeKey, transition.transition, label);\n    });\n  });\n\n  dagre.layout(g);\n  const nodeCoordinates: NodeCoordinates = {};\n  const startNodeShift = g.node(START).x;\n\n  for (const nodeKey of nodeKeys) {\n    const node = g.node(nodeKey);\n    // dagre returns coordinates for the center of the node,\n    // our renderer expects coordinates for the corner of the node.\n    // further, our renderer expects the Start node to be centered at x: 0\n    nodeCoordinates[nodeKey] = {\n      x: node.x - startNodeShift - node.width / 2,\n      y: node.y - node.height / 2,\n      width: node.width\n    };\n  }\n\n  const edges: Edges = {};\n\n  g.edges().forEach(e => {\n    const edge = g.edge(e);\n    const edgeName = `${e.v}, ${e.w}`;\n    const label = edge.label ? { text: edge.label, x: edge.x - startNodeShift, y: edge.y } : null;\n\n    edges[edgeName] = {\n      label,\n      start: e.v,\n      end: e.w,\n      points: edge.points.map(p => {\n        return {\n          x: p.x - startNodeShift,\n          y: p.y\n        };\n      })\n    };\n  });\n\n  return { nodeCoordinates, edges };\n}\n\n/**\n * Layout the pathway using our homegrown layout algorithm.\n */\nfunction layoutCustom(pathway: Pathway): Layout {\n  const START = 'Start';\n  const NODE_WIDTH = 100;\n  const NODE_HEIGHT = 50;\n  const MIN_MARGIN_X = 10;\n  const MIN_MARGIN_Y = 50;\n  const nodes: Nodes = initializeNodes(pathway);\n  const graph: string[][] = [[START]];\n  const HORIZONTAL_OFFSET = NODE_WIDTH + MIN_MARGIN_X;\n  const VERTICAL_OFFSET = NODE_HEIGHT + MIN_MARGIN_Y;\n\n  // Set the rank for every node\n  let rank = 0;\n  do {\n    // Iterate over each node on the current level\n    for (const nodeKey of graph[rank]) {\n      // Assign all children to the next rank\n      assignRankToChildren(nodes[nodeKey], rank + 1);\n    }\n\n    rank++;\n\n    // To start rank = 0 and graph.length = 1. In each iteration children will be added\n    // to the next rank incrementing the length of graph. When there are no new children\n    // the graph.length will remain unchanged but the rank would have increased by one.\n    // Therefore we stop when the rank and graph length are the same.\n  } while (graph.length !== rank);\n\n  // Set the position of nodes within the rank\n  assignHorizontalPositionToNode(nodes[START], -1 * (NODE_WIDTH / 2));\n  for (rank = 1; rank < graph.length; rank++) {\n    assignHorizontalPositionToNodesInRank(rank);\n  }\n\n  return {\n    nodeCoordinates: produceCoordinates(),\n    edges: {}\n  };\n\n  /**\n   * Convert the Nodes into a Coordinates object\n   *\n   * @returns Coordinates for every node\n   */\n  function produceCoordinates(): NodeCoordinates {\n    const coordinates: NodeCoordinates = {};\n\n    for (const nodeKey in nodes) {\n      const node = nodes[nodeKey];\n      coordinates[nodeKey] = {\n        x: node.horizontalPosition,\n        y: node.rank * VERTICAL_OFFSET\n      };\n    }\n\n    return coordinates;\n  }\n\n  /**\n   * Set the horizontal position for child elements of a parent\n   *\n   * @param parent - the parent Node\n   * @param nodes - the Nodes\n   */\n  function spreadChildrenEvenly(parent: Node): void {\n    const children = parent.children.filter(\n      c => isNaN(nodes[c].horizontalPosition) || nodes[c].canMove\n    );\n    if (children.length === 0) return;\n    if (children.length === 1) {\n      assignHorizontalPositionToNode(nodes[children[0]], parent.horizontalPosition);\n      return;\n    }\n    if (children.length % 2 === 1) children.splice(Math.ceil(children.length / 2), 1); // Remove middle element if odd\n\n    // TODO: this does not consider if there are connections between the children which order to put them in\n    for (let i = 0; i < children.length / 2; i++) {\n      // Set the left child i from the center\n      let childNode = nodes[children[children.length / 2 - i - 1]];\n      assignHorizontalPositionToNode(\n        childNode,\n        parent.horizontalPosition - (i + 1) * HORIZONTAL_OFFSET\n      );\n      childNode.canMove = false;\n\n      // Set the right child i from the center\n      childNode = nodes[children[children.length / 2 + i]];\n      assignHorizontalPositionToNode(\n        childNode,\n        parent.horizontalPosition + (i + 1) * HORIZONTAL_OFFSET\n      );\n      childNode.canMove = false;\n    }\n  }\n\n  /**\n   * Assigns the node given by nodeKey the horizontal position hPos if it is not already set\n   * @param node - the node to set the horizontal position of\n   * @param hPos - the horizontal position for the node\n   */\n  function assignHorizontalPositionToNode(node: Node, hPos: number): void {\n    if (isNaN(node.horizontalPosition) || node.canMove) {\n      node.horizontalPosition = hPos;\n\n      // Check the new position is not on top of another node\n      let i = 1;\n      while (hasOverlap(node)) {\n        // Update Horizontal position of this node\n        // Alternate directions moving further and further away\n        const direction = i % 2 === 0 ? -1 : 1;\n        node.horizontalPosition = hPos + direction * Math.ceil(i / 2) * HORIZONTAL_OFFSET;\n        i += 1;\n      }\n    }\n  }\n\n  /**\n   * Assigns the horizontal position of all nodes on the current level\n   *\n   * @param rank - the level of the graph to assign node positions of\n   */\n  function assignHorizontalPositionToNodesInRank(rank: number): void {\n    for (const nodeKey of graph[rank]) {\n      const node = nodes[nodeKey];\n      if (!isNaN(node.horizontalPosition)) continue;\n      const parentsOnHigherRank = node.parents.filter(p => nodes[p].rank < node.rank);\n      if (parentsOnHigherRank.length === 1) {\n        const parentKey = node.parents[0];\n        const parent = nodes[parentKey];\n\n        if (parent.children.length % 2 === 1) {\n          // Odd number of children: one directly below, others to the side\n          const childNode = nodes[parent.children[Math.floor(parent.children.length / 2)]];\n          assignHorizontalPositionToNode(childNode, parent.horizontalPosition);\n        }\n        spreadChildrenEvenly(parent);\n      } else {\n        // Multiple Parents: Place the node at the average of parents on higher rank\n        // TODO: collect all parents to be next to each other\n        const sum = parentsOnHigherRank\n          .map(p => nodes[p].horizontalPosition)\n          .reduce((a, b) => a + b, 0);\n\n        assignHorizontalPositionToNode(node, sum / parentsOnHigherRank.length);\n      }\n    }\n  }\n\n  /**\n   * Determines if the node overlaps with any other nodes in the rank\n   *\n   * @param node - the node to check for overlap with\n   * @returns true if the node overlaps with any other node in the rank, false otherwise\n   */\n  function hasOverlap(node: Node): boolean {\n    const nodesInRank = graph[node.rank].map(name => nodes[name]);\n\n    for (const otherNode of nodesInRank) {\n      if (nodesOverlap(node, otherNode)) return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Helper function to determine if two nodes are in the same slot\n   *\n   * @param node - the first node\n   * @param otherNode - the second node\n   * @returns true if the nodes share same rank and position, false otherwise\n   */\n  function nodesOverlap(node: Node, otherNode: Node): boolean {\n    if (nodesEqual(node, otherNode)) return false;\n    else\n      return (\n        !isNaN(node.rank) &&\n        !isNaN(node.horizontalPosition) &&\n        !isNaN(otherNode.rank) &&\n        !isNaN(otherNode.horizontalPosition) &&\n        node.rank === otherNode.rank &&\n        node.horizontalPosition === otherNode.horizontalPosition\n      );\n  }\n\n  /**\n   * Determine if two nodes are the same\n   *\n   * @param node - the first node\n   * @param otherNode - the second node\n   * @returns true if the two nodes are the same (have the same label)\n   */\n  function nodesEqual(node: Node, otherNode: Node): boolean {\n    return node.label === otherNode.label;\n  }\n\n  /**\n   * Assigns the rank to every child of node. If the child has a lower rank the entire\n   * subtree rooted at that child will be shifted down by recursively assigning rank to\n   * the children.\n   *\n   * @param nodes - the Nodes\n   * @param graph - the graph as list of nodes by level\n   * @param node - the node to get children from\n   * @param rank - the rank to assign to the children\n   */\n  function assignRankToChildren(node: Node, rank: number): void {\n    node.children.forEach(child => {\n      const childNode = nodes[child];\n\n      // If the child is on a higher rank than the parent (node) move subtree rooted at child down\n      if (childNode.rank < node.rank) {\n        // Remove node from previous rank\n        graph[childNode.rank].splice(graph[childNode.rank].indexOf(child), 1);\n\n        // Move this node down\n        assignRankToNode(child, rank);\n\n        // Move all children of this child down\n        assignRankToChildren(childNode, rank + 1);\n      } else if (isNaN(childNode.rank)) assignRankToNode(child, rank);\n    });\n  }\n\n  /**\n   * Assigns the node labeled by nodeKey the rank by updating graph and nodes data structures\n   *\n   * @param nodes - the Nodes\n   * @param graph - the graph as list of nodes by level\n   * @param nodeKey - the name of the node to set the rank of\n   * @param rank - the new rank for the node\n   */\n  function assignRankToNode(nodeKey: string, rank: number): void {\n    try {\n      graph[rank].push(nodeKey);\n    } catch (err) {\n      graph[rank] = [nodeKey];\n    } finally {\n      nodes[nodeKey].rank = rank;\n    }\n  }\n\n  /**\n   * Initialize the Nodes data structure for the graph representation\n   *\n   * @param pathway - JSON Pathway\n   * @returns initial Nodes data structure with default values\n   */\n  function initializeNodes(pathway: Pathway): Nodes {\n    const nodes: Nodes = {};\n\n    // Iniitalize each node with default values\n    let nodeKey: string;\n    for (nodeKey in pathway.nodes) {\n      nodes[nodeKey] = {\n        label: nodeKey,\n        rank: NaN,\n        horizontalPosition: NaN,\n        children: [],\n        parents: [],\n        canMove: true\n      };\n    }\n\n    // Set the child and parent properties of each node\n    Object.keys(pathway.nodes).forEach(nodeKey => {\n      const node: PathwayNode = pathway.nodes[nodeKey];\n\n      node.transitions.forEach(transition => {\n        if (!nodes[nodeKey].children.includes(transition.transition))\n          nodes[nodeKey].children.push(transition.transition);\n        if (!nodes[transition.transition].parents.includes(nodeKey))\n          nodes[transition.transition].parents.push(nodeKey);\n      });\n    });\n\n    nodes[START].rank = 0;\n\n    return nodes;\n  }\n}\n","import { PathwayNode, ActionNode } from 'pathways-model';\n\nexport function isActionNode(node: PathwayNode): node is ActionNode {\n  const { action } = node as ActionNode;\n  return action !== undefined;\n}\n\nexport function isBranchNode(node: PathwayNode): boolean {\n  const { action, label } = node as ActionNode;\n  return action === undefined && label !== 'Start';\n}\n\ntype ConversionResource = {\n  [key: string]: string;\n};\nexport const resourceNameConversion: ConversionResource = {\n  MedicationRequest: 'Medication',\n  ServiceRequest: 'Procedure',\n  CarePlan: 'Regimen'\n};\n","import React, { FC, ReactNode, ReactElement, memo } from 'react';\nimport { ActionNode } from 'pathways-model';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport styles from './ExpandedNode.module.scss';\nimport { isBranchNode, resourceNameConversion } from 'utils/nodeUtils';\n\nimport { faExternalLinkAlt } from '@fortawesome/free-solid-svg-icons';\n\nimport { MedicationRequest, ServiceRequest } from 'fhir-objects';\ninterface ExpandedNodeProps {\n  actionNode: ActionNode;\n  isActionable: boolean;\n  isAction: boolean;\n}\nconst ExpandedNode: FC<ExpandedNodeProps> = memo(({ actionNode, isActionable, isAction }) => {\n  return (\n    <>\n      <ExpandedNodeMemo isAction={isAction} actionNode={actionNode} />\n    </>\n  );\n});\n\ntype ExpandedNodeFieldProps = {\n  title: string;\n  description: ReactNode;\n};\n\nconst ExpandedNodeField: FC<ExpandedNodeFieldProps> = ({ title, description }) => {\n  if (!description) return null;\n\n  return (\n    <tr>\n      <td className={styles.descTitle}>{title}</td>\n      <td className={styles.desc}>{description}</td>\n    </tr>\n  );\n};\n\nfunction isMedicationRequest(\n  request: MedicationRequest | ServiceRequest\n): request is MedicationRequest {\n  return (request as MedicationRequest).medicationCodeableConcept !== undefined;\n}\nfunction renderAction(actionNode: ActionNode): ReactElement[] {\n  let returnElements: ReactElement[] = [];\n  if (actionNode.action[0]) {\n    const resource = actionNode.action[0].resource;\n    const coding = isMedicationRequest(resource)\n      ? resource?.medicationCodeableConcept?.coding\n      : resource?.code?.coding;\n\n    const resourceType = resourceNameConversion[resource.resourceType]\n      ? resourceNameConversion[resource.resourceType]\n      : resource.resourceType;\n    returnElements = [\n      <ExpandedNodeField\n        key=\"Description\"\n        title=\"Description\"\n        description={actionNode.action[0].description}\n      />,\n      <ExpandedNodeField key=\"Type\" title=\"Type\" description={resourceType} />,\n      <ExpandedNodeField\n        key=\"System\"\n        title=\"System\"\n        description={\n          coding &&\n          coding[0].system && (\n            <>\n              {coding[0].system}\n              <a href={coding[0].system} target=\"_blank\" rel=\"noopener noreferrer\">\n                <FontAwesomeIcon icon={faExternalLinkAlt} className={styles.externalLink} />\n              </a>\n            </>\n          )\n        }\n      />,\n      <ExpandedNodeField key=\"Code\" title=\"Code\" description={coding && coding[0].code} />,\n      <ExpandedNodeField key=\"Display\" title=\"Display\" description={coding && coding[0].display} />,\n      <ExpandedNodeField key=\"Title\" title=\"Title\" description={resource.title} />\n    ];\n  }\n\n  return returnElements;\n}\ninterface ExpandedNodeMemoProps {\n  actionNode: ActionNode;\n  isAction: boolean;\n}\nconst ExpandedNodeMemo: FC<ExpandedNodeMemoProps> = memo(({ actionNode, isAction }) => {\n  const action = isAction && renderAction(actionNode);\n  const branch = isBranchNode(actionNode);\n  return (\n    <div className=\"expandedNode\">\n      <table className={styles.infoTable}>\n        <tbody>{action || branch}</tbody>\n      </table>\n    </div>\n  );\n});\n\nexport default ExpandedNode;\n","import React, { FC, Ref, forwardRef, memo, useCallback, useState, useEffect } from 'react';\nimport { ActionNode, PathwayNode, Pathway } from 'pathways-model';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nimport styles from './Node.module.scss';\nimport ExpandedNode from 'components/ExpandedNode';\nimport { isActionNode, isBranchNode } from 'utils/nodeUtils';\nimport { getNodeType } from 'utils/builder';\nimport { IconDefinition } from '@fortawesome/fontawesome-svg-core';\nimport {\n  faMicroscope,\n  faPlay,\n  faPrescriptionBottleAlt,\n  faSyringe,\n  faCheckCircle,\n  faTimesCircle,\n  faBookMedical\n} from '@fortawesome/free-solid-svg-icons';\n\ninterface NodeProps {\n  nodeKey: string;\n  pathwayNode: PathwayNode;\n  pathway: Pathway;\n  xCoordinate: number;\n  yCoordinate: number;\n  expanded?: boolean;\n  onClick?: (nodeKey: string) => void;\n  currentNode: PathwayNode;\n}\n\nconst Node: FC<NodeProps & { ref: Ref<HTMLDivElement> }> = memo(\n  forwardRef<HTMLDivElement, NodeProps>(\n    (\n      {\n        nodeKey,\n        pathwayNode,\n        pathway,\n        xCoordinate,\n        yCoordinate,\n        expanded = false,\n        onClick,\n        currentNode\n      },\n      ref\n    ) => {\n      const [hasMetadata, setHasMetadata] = useState<boolean>(\n        isActionNode(pathwayNode) ? pathwayNode.action.length > 0 : false\n      );\n\n      const onClickHandler = useCallback(() => {\n        if (onClick) onClick(nodeKey);\n      }, [onClick, nodeKey]);\n\n      useEffect(() => {\n        if (!hasMetadata && isActionNode(pathwayNode) && pathwayNode.action.length > 0) {\n          setHasMetadata(true);\n          if (!expanded) {\n            onClickHandler();\n          }\n        }\n      }, [hasMetadata, pathwayNode, setHasMetadata, onClickHandler, expanded]);\n\n      const { label } = pathwayNode;\n      const style = {\n        top: yCoordinate,\n        left: xCoordinate\n      };\n\n      const isCurrentNode = pathwayNode.key === currentNode.key;\n      const isTransitionOfCurrentBranch =\n        isBranchNode(currentNode) && currentNode.transitions.some(e => e?.transition === nodeKey);\n\n      const isActionable = isCurrentNode;\n      const topLevelClasses = [styles.node];\n      let expandedNodeClass = '';\n      if (expanded) topLevelClasses.push('expanded');\n      if (isActionable || isTransitionOfCurrentBranch) {\n        topLevelClasses.push(styles.actionable);\n        expandedNodeClass = styles.childActionable;\n      } else {\n        expandedNodeClass = styles.childNotActionable;\n      }\n      const isAction = isActionNode(pathwayNode);\n      const nodeType = getNodeType(pathway, nodeKey);\n      return (\n        <div className={topLevelClasses.join(' ')} style={style} ref={ref}>\n          <div className={`nodeTitle ${onClickHandler && 'clickable'}`} onClick={onClickHandler}>\n            <div className=\"iconAndLabel\">\n              <NodeIcon pathwayNode={pathwayNode} nodeType={nodeType} />\n              {label}\n            </div>\n            <StatusIcon status={null} />\n          </div>\n          {expanded && (\n            <div className={`${styles.expandedNode} ${expandedNodeClass}`}>\n              <ExpandedNode\n                actionNode={pathwayNode as ActionNode}\n                isActionable={isActionable}\n                isAction={isAction}\n              />\n            </div>\n          )}\n        </div>\n      );\n    }\n  )\n);\n\ninterface NodeIconProps {\n  pathwayNode: PathwayNode;\n  nodeType: string;\n}\n\nconst NodeIcon: FC<NodeIconProps> = ({ pathwayNode, nodeType }) => {\n  let icon: IconDefinition | undefined;\n  if (pathwayNode.label === 'Start') {\n    icon = faPlay;\n  } else if (nodeType === 'action') {\n    const actionNode = pathwayNode as ActionNode;\n    if (actionNode.action.length > 0) {\n      const resourceType = actionNode.action[0].resource.resourceType;\n      if (resourceType === 'MedicationRequest') icon = faPrescriptionBottleAlt;\n      else if (resourceType === 'ServiceRequest') icon = faSyringe;\n      else if (resourceType === 'CarePlan') icon = faBookMedical;\n    }\n  } else if (nodeType === 'branch') {\n    icon = faMicroscope;\n  }\n\n  return icon ? <FontAwesomeIcon icon={icon} className={styles.icon} /> : null;\n};\n\ninterface StatusIconProps {\n  status: boolean | null;\n}\n\nconst StatusIcon: FC<StatusIconProps> = ({ status }) => {\n  if (status == null) {\n    return null;\n  }\n  const icon = status ? faCheckCircle : faTimesCircle;\n  return (\n    <div className=\"statusIcon\">\n      <FontAwesomeIcon icon={icon} className={styles.icon} />\n    </div>\n  );\n};\n\nexport default Node;\n","import { makeStyles, Theme as AugmentedTheme } from '@material-ui/core/styles';\n\nexport default makeStyles(\n  (theme: AugmentedTheme) => ({\n    arrow: {\n      '& path': {\n        stroke: theme.palette.primary.main,\n        strokeWidth: 2\n      },\n      '& text': {\n        fontSize: '18px'\n      }\n    },\n    currentBranchArrow: {\n      '& path': {\n        stroke: theme.palette.secondary.main\n      }\n    },\n    arrowhead: {\n      '& polygon': {\n        fill: theme.palette.primary.main\n      }\n    },\n    currentBranchArrowhead: {\n      '& polygon': {\n        fill: theme.palette.secondary.main\n      }\n    }\n  }),\n  { name: 'Arrow', index: 1 }\n);\n","import React, { FC } from 'react';\nimport { Edge, Coordinate } from 'graph-model';\nimport { PathwayNode } from 'pathways-model';\nimport { isBranchNode } from 'utils/nodeUtils';\nimport useStyles from './styles';\nimport clsx from 'clsx';\n\ninterface ArrowProps {\n  edge: Edge;\n  edgeName: string;\n  widthOffset: number;\n  currentNode: PathwayNode;\n}\n\ninterface ArrowPathProps {\n  points: Coordinate[];\n  arrowheadId: string;\n  widthOffset: number;\n}\n\nconst Arrow: FC<ArrowProps> = ({ edge, edgeName, widthOffset, currentNode }) => {\n  const styles = useStyles();\n  const isCurrentBranchArrow = isBranchNode(currentNode) && edge.start === currentNode.key;\n  const edgeNameNoWhitespace = edgeName.replace(' ', '');\n  const arrowheadId = `arrowhead-${edgeNameNoWhitespace}`;\n\n  const { label } = edge;\n  return (\n    <svg className={clsx(styles.arrow, isCurrentBranchArrow && styles.currentBranchArrow)}>\n      <ArrowPath points={edge.points} arrowheadId={arrowheadId} widthOffset={widthOffset} />\n      {label ? (\n        <text x={label.x + widthOffset} y={label.y}>\n          {label.text}\n        </text>\n      ) : null}\n      <defs>\n        <marker\n          id={arrowheadId}\n          className={clsx(isCurrentBranchArrow ? styles.currentBranchArrowhead : styles.arrowhead)}\n          markerWidth=\"10\"\n          markerHeight=\"7\"\n          refX=\"0\"\n          refY=\"3.5\"\n          orient=\"auto\"\n        >\n          <polygon points=\"0 0, 10 3.5, 0 7\" />\n        </marker>\n      </defs>\n    </svg>\n  );\n};\n\n// Returns path for arrow from edge points\nconst ArrowPath: FC<ArrowPathProps> = ({ points, arrowheadId, widthOffset }) => {\n  const pointsWithOffset = points.map(p => ({ x: p.x + widthOffset, y: p.y }));\n  const length = pointsWithOffset.length;\n  pointsWithOffset[length - 1].y -= 17.5;\n  let pathString = `M ${pointsWithOffset[0].x} ${pointsWithOffset[0].y} `;\n\n  /**\n   * The points to use in the Cubic command is determined by the length of points array\n   * If i % 3 is 0, use all points including the 1st point\n   * If i % 3 is 1, use all points except the 1st point\n   * If i % 3 is 2, use all points including the 1st point and reuse every 3rd point\n   * We need points to be a multiple of 3 because the Cubic command expects 3 points\n   */\n  const writeCommandString = (remainder: number): string => {\n    return pointsWithOffset.reduce((acc, point, i, arr) => {\n      return i % 3 !== remainder\n        ? acc\n        : `${acc} C ${point.x} ${point.y} ${arr[i + 1].x} ${arr[i + 1].y} ${arr[i + 2].x}\n        ${arr[i + 2].y}`;\n    }, pathString);\n  };\n\n  pathString = writeCommandString(length % 3);\n\n  return <path d={pathString} fill=\"transparent\" markerEnd={`url(#${arrowheadId})`} />;\n};\n\nexport default Arrow;\n","import React, {\n  FC,\n  RefObject,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n  memo\n} from 'react';\nimport { useParams, useHistory } from 'react-router-dom';\n\nimport graphLayout from 'visualization/layout';\nimport Node from 'components/Node';\nimport Arrow from 'components/Arrow';\nimport { useCriteriaContext } from 'components/CriteriaProvider';\nimport { Pathway, PathwayNode } from 'pathways-model';\nimport { Layout, NodeDimensions, NodeCoordinates, Edges } from 'graph-model';\nimport styles from './Graph.module.scss';\nimport ResizeSensor from 'css-element-queries/src/ResizeSensor';\n\ninterface GraphProps {\n  pathway: Pathway;\n  interactive?: boolean;\n  expandCurrentNode?: boolean;\n  currentNode: PathwayNode;\n}\n\ninterface ExpandedNode {\n  [key: string]: boolean | string | null;\n}\n\nconst Graph: FC<GraphProps> = memo(\n  ({ pathway, interactive = true, expandCurrentNode = true, currentNode }) => {\n    const graphElement = useRef<HTMLDivElement>(null);\n    const nodeRefs = useRef<{ [key: string]: HTMLDivElement }>({});\n    const [parentWidth, setParentWidth] = useState<number>(\n      graphElement?.current?.parentElement?.clientWidth ?? 0\n    );\n\n    // Get the layout of the graph\n    const getGraphLayout = useCallback((): Layout => {\n      const nodeDimensions: NodeDimensions = {};\n\n      // Retrieve dimensions from nodeRefs\n      if (nodeRefs?.current) {\n        Object.keys(nodeRefs.current).forEach(key => {\n          const nodeElement = nodeRefs.current[key];\n          const width = nodeElement.clientWidth;\n          // nodeElement can have multiple children so calculate the sum to get the node height\n          const height = Array.from(nodeElement.children).reduce(\n            (acc, child) => acc + child.clientHeight,\n            0\n          );\n\n          nodeDimensions[key] = { width, height };\n        });\n      }\n\n      return graphLayout(pathway, nodeDimensions);\n    }, [pathway]);\n\n    const [layout, setLayout] = useState(getGraphLayout());\n    const { nodeCoordinates, edges } = layout;\n    const maxHeight = useMemo(() => {\n      return nodeCoordinates !== undefined\n        ? Object.values(nodeCoordinates)\n            .map(x => x.y)\n            .reduce((a, b) => Math.max(a, b))\n        : 0;\n    }, [nodeCoordinates]);\n\n    // If a node has a negative x value, shift nodes and edges to the right by that value\n    const minX =\n      nodeCoordinates !== undefined\n        ? Object.values(nodeCoordinates)\n            .map(x => x.x + parentWidth / 2)\n            .reduce((a, b) => Math.min(a, b))\n        : 0;\n\n    if (minX < 0) {\n      const toAdd = minX * -1;\n      Object.keys(nodeCoordinates).forEach(key => {\n        const node = nodeCoordinates[key];\n        node.x += toAdd;\n      });\n\n      Object.keys(edges).forEach(key => {\n        const edge = edges[key];\n\n        edge.points.forEach(p => (p.x += toAdd));\n        if (edge.label) edge.label.x += toAdd;\n      });\n    }\n\n    // Find node that is farthest to the right\n    const maxWidth = useMemo(() => {\n      return nodeCoordinates !== undefined\n        ? Object.values(nodeCoordinates)\n            // Add width of the node to account for x coordinate starting at top left corner\n            .map(x => x.x + parentWidth / 2 + (x.width ?? 0))\n            .reduce((a, b) => Math.max(a, b))\n        : 0;\n    }, [nodeCoordinates, parentWidth]);\n\n    const [expanded, setExpanded] = useState<ExpandedNode>(() =>\n      Object.keys(layout).reduce(\n        (acc, curr: string) => {\n          acc[curr] = false;\n          return acc;\n        },\n        { lastSelectedNode: null } as ExpandedNode\n      )\n    );\n\n    const toggleExpanded = useCallback((key: string) => {\n      if (key === 'Start') {\n        setExpanded(prevNode => ({\n          ...prevNode,\n          lastSelectedNode: key\n        }));\n      } else {\n        setExpanded(prevNode => ({\n          ...prevNode,\n          [key]:\n            !prevNode[key] || prevNode.lastSelectedNode === key ? !prevNode[key] : prevNode[key],\n          lastSelectedNode: key\n        }));\n      }\n    }, []);\n\n    // Recalculate graph layout if graph container size changes\n    useEffect(() => {\n      // Keeps track of whether the current useEffect cycle has ended\n      let cancel = false;\n\n      if (graphElement.current?.parentElement) {\n        new ResizeSensor(graphElement.current.parentElement, function() {\n          if (!cancel) {\n            setParentWidth(graphElement.current?.parentElement?.clientWidth ?? 0);\n            setLayout(getGraphLayout());\n          }\n        });\n        const { clientWidth } = graphElement.current.parentElement;\n        if (clientWidth && parentWidth !== clientWidth) {\n          setParentWidth(graphElement.current?.parentElement?.clientWidth ?? 0);\n          setLayout(getGraphLayout());\n        }\n      }\n\n      return (): void => {\n        cancel = true;\n      };\n    }, [getGraphLayout, parentWidth]);\n\n    // Recalculate graph layout if a node is expanded\n    useEffect(() => {\n      setLayout(getGraphLayout());\n    }, [pathway, expanded, getGraphLayout]);\n\n    return (\n      <GraphMemo\n        graphElement={graphElement}\n        interactive={interactive}\n        maxHeight={maxHeight}\n        nodeCoordinates={nodeCoordinates}\n        edges={edges}\n        pathway={pathway}\n        nodeRefs={nodeRefs}\n        parentWidth={parentWidth}\n        maxWidth={maxWidth}\n        expanded={expanded}\n        toggleExpanded={toggleExpanded}\n        currentNode={currentNode}\n      />\n    );\n  }\n);\n\ninterface GraphMemoProps {\n  graphElement: RefObject<HTMLDivElement>;\n  interactive: boolean;\n  maxHeight: number;\n  nodeCoordinates: NodeCoordinates;\n  edges: Edges;\n  pathway: Pathway;\n  nodeRefs: React.MutableRefObject<{\n    [key: string]: HTMLDivElement;\n  }>;\n  parentWidth: number;\n  maxWidth: number;\n  expanded: ExpandedNode;\n  toggleExpanded: (key: string) => void;\n  currentNode: PathwayNode;\n}\n\nconst GraphMemo: FC<GraphMemoProps> = memo(\n  ({\n    graphElement,\n    interactive,\n    maxHeight,\n    nodeCoordinates,\n    edges,\n    pathway,\n    nodeRefs,\n    parentWidth,\n    maxWidth,\n    expanded,\n    toggleExpanded,\n    currentNode\n  }) => {\n    const { id: pathwayId } = useParams();\n    const history = useHistory();\n    const { updateBuildCriteriaNodeId } = useCriteriaContext();\n    const redirectToNode = useCallback(\n      nodeId => {\n        const url = `/builder/${encodeURIComponent(pathwayId)}/node/${encodeURIComponent(nodeId)}`;\n        if (url !== history.location.pathname) {\n          history.push(url);\n        }\n      },\n      [history, pathwayId]\n    );\n    const onClickHandler = useCallback(\n      (nodeKey: string) => {\n        if (interactive) {\n          redirectToNode(nodeKey);\n          toggleExpanded(nodeKey);\n          updateBuildCriteriaNodeId('');\n        }\n      },\n      [redirectToNode, toggleExpanded, updateBuildCriteriaNodeId, interactive]\n    );\n    return (\n      <div\n        ref={graphElement}\n        id=\"graph-root\"\n        className={styles.root}\n        style={{\n          height: interactive ? maxHeight + 150 : 'inherit',\n          width: maxWidth + 'px',\n          position: 'relative',\n          marginRight: '5px'\n        }}\n      >\n        {nodeCoordinates !== undefined\n          ? Object.keys(nodeCoordinates).map(nodeKey => {\n              return (\n                <Node\n                  key={nodeKey}\n                  nodeKey={nodeKey}\n                  pathway={pathway}\n                  ref={(node: HTMLDivElement): void => {\n                    if (node) nodeRefs.current[nodeKey] = node;\n                    else delete nodeRefs.current[nodeKey];\n                  }}\n                  pathwayNode={pathway.nodes[nodeKey]}\n                  xCoordinate={nodeCoordinates[nodeKey].x + parentWidth / 2}\n                  yCoordinate={nodeCoordinates[nodeKey].y}\n                  expanded={Boolean(expanded[nodeKey])}\n                  onClick={onClickHandler}\n                  currentNode={currentNode}\n                />\n              );\n            })\n          : []}\n\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          style={{\n            width: maxWidth,\n            height: maxHeight,\n            zIndex: 1,\n            top: 0,\n            left: 0,\n            overflow: 'visible'\n          }}\n        >\n          {edges !== undefined\n            ? Object.keys(edges).map(edgeName => {\n                const edge = edges[edgeName];\n                return (\n                  <Arrow\n                    key={edgeName}\n                    edge={edge}\n                    edgeName={edgeName}\n                    widthOffset={parentWidth / 2}\n                    currentNode={currentNode}\n                  />\n                );\n              })\n            : []}\n        </svg>\n      </div>\n    );\n  }\n);\n\nexport default Graph;\n","import { makeStyles, Theme as AugmentedTheme, darken } from '@material-ui/core/styles';\n\nconst toggleButtonCss = {\n  borderRadius: '0%',\n  marginLeft: '1px',\n  width: '50px',\n  height: '50px'\n};\n\nexport default makeStyles(\n  (theme: AugmentedTheme) => ({\n    display: {\n      display: 'flex'\n    },\n    graph: {\n      width: '100%',\n      height: '100%',\n      'overflow-y': 'scroll'\n    },\n    graphHeader: {\n      display: 'flex',\n      height: '50px',\n      backgroundColor: theme.palette.common.white,\n      marginLeft: '1px'\n    },\n    graphHeaderText: {\n      height: '50px',\n      display: 'flex',\n      width: '100%',\n      backgroundColor: theme.palette.primary.main,\n      alignItems: 'center',\n      color: theme.palette.common.white,\n      fontSize: '1.4em',\n      paddingLeft: '1.5em'\n    },\n    toggleButton: {\n      '&-on': {\n        ...toggleButtonCss,\n        backgroundColor: theme.palette.primary.main,\n        '&:hover': {\n          backgroundColor: darken(theme.palette.primary.main, 0.1)\n        }\n      },\n      '&-off': {\n        ...toggleButtonCss,\n        backgroundColor: theme.palette.text.primary,\n        '&:hover': {\n          backgroundColor: darken(theme.palette.text.primary, 0.1)\n        }\n      }\n    },\n    toggleIcon: {\n      transform: 'rotate(90deg) scaleY(-1)',\n      color: theme.palette.common.white\n    }\n  }),\n  { name: 'Builder', index: 1 }\n);\n","import React, { FC, useRef, useEffect, memo, useState, useCallback } from 'react';\nimport { Pathway, PathwayNode } from 'pathways-model';\nimport { ThemeProvider as MuiThemeProvider } from '@material-ui/core/styles';\nimport { useCriteriaContext } from 'components/CriteriaProvider';\n\nimport Header from 'components/Header';\nimport Navigation from 'components/Navigation';\nimport Sidebar from 'components/Sidebar';\nimport Graph from 'components/Graph';\nimport { useTheme } from 'components/ThemeProvider';\n\nimport { IconButton } from '@material-ui/core';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faProjectDiagram } from '@fortawesome/free-solid-svg-icons';\nimport useStyles from './styles';\n\ninterface BuilderProps {\n  pathway: Pathway;\n  currentNode: PathwayNode;\n}\n\nconst Builder: FC<BuilderProps> = ({ pathway, currentNode }) => {\n  const styles = useStyles();\n  const { buildCriteriaNodeId } = useCriteriaContext();\n  const headerElement = useRef<HTMLDivElement>(null);\n  const graphContainerElement = useRef<HTMLDivElement>(null);\n  const theme = useTheme('dark');\n  const [showCriteriaBuilder, setShowCriteriaBuilder] = useState<boolean>(true);\n\n  const toggleShowCriteria = useCallback((): void => {\n    setShowCriteriaBuilder(!showCriteriaBuilder);\n  }, [showCriteriaBuilder]);\n\n  // Set the height of the graph container\n  useEffect(() => {\n    if (graphContainerElement?.current && headerElement?.current)\n      graphContainerElement.current.style.height =\n        window.innerHeight - headerElement.current.clientHeight + 'px';\n  }, [pathway, headerElement, graphContainerElement]);\n\n  // Reset criteriaBuilderToggle to true if not currently building criteria\n  useEffect(() => {\n    if (!showCriteriaBuilder && buildCriteriaNodeId === '') setShowCriteriaBuilder(true);\n  }, [buildCriteriaNodeId, showCriteriaBuilder]);\n\n  return (\n    <>\n      <div ref={headerElement}>\n        <Header />\n        <Navigation pathway={pathway} />\n      </div>\n\n      <div className={styles.display}>\n        <MuiThemeProvider theme={theme}>\n          <Sidebar pathway={pathway} headerElement={headerElement} currentNode={currentNode} />\n        </MuiThemeProvider>\n\n        <div ref={graphContainerElement} className={styles.graph}>\n          {buildCriteriaNodeId !== '' && (\n            <div className={styles.graphHeader}>\n              <div className={styles.graphHeaderText}>\n                <span>Criteria Builder</span>\n              </div>\n              <IconButton\n                className={`${styles.toggleButton}-${showCriteriaBuilder ? 'on' : 'off'}`}\n                onClick={toggleShowCriteria}\n              >\n                <FontAwesomeIcon className={styles.toggleIcon} icon={faProjectDiagram} />\n              </IconButton>\n            </div>\n          )}\n          {buildCriteriaNodeId !== '' && showCriteriaBuilder ? (\n            // Empty section for authoring tool\n            <div />\n          ) : (\n            <Graph pathway={pathway} expandCurrentNode={true} currentNode={currentNode} />\n          )}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default memo(Builder);\n","import React, { FC, memo, useMemo } from 'react';\nimport { Redirect, useParams } from 'react-router-dom';\n\nimport Builder from 'components/Builder';\nimport { usePathwayContext } from 'components/PathwayProvider';\n\nconst BuilderRoute: FC = () => {\n  const { id, nodeId } = useParams();\n  const { pathways } = usePathwayContext();\n  const pathwayId = decodeURIComponent(id);\n  const pathwayIndex = useMemo(() => pathways.findIndex(pathway => pathway.id === pathwayId), [\n    pathwayId,\n    pathways\n  ]);\n  const pathway = pathways[pathwayIndex];\n  const currentNode = pathway?.nodes?.[decodeURIComponent(nodeId)];\n\n  if (pathway == null) return null;\n  if (currentNode == null) return <Redirect to={`/builder/${id}/node/Start`} />;\n\n  return <Builder pathway={pathway} currentNode={currentNode} />;\n};\n\nexport default memo(BuilderRoute);\n","import React, { FC, createContext, useContext, useState, ReactNode } from 'react';\n\ninterface UserContextInterface {\n  user: string | null;\n  setUser: Function;\n}\n\nexport const UserContext = createContext<UserContextInterface>({} as UserContextInterface);\n\ninterface UserProviderProps {\n  children: ReactNode;\n}\n\nexport const UserProvider: FC<UserProviderProps> = ({ children }) => {\n  const [user, setUser] = useState<string | null>(null);\n  return <UserContext.Provider value={{ user, setUser }}>{children}</UserContext.Provider>;\n};\n\nexport const useUser = (): UserContextInterface => useContext(UserContext);\n","import { makeStyles, Theme as AugmentedTheme } from '@material-ui/core/styles';\n\nexport default makeStyles(\n  (theme: AugmentedTheme) => ({\n    root: {\n      display: 'flex',\n      flexDirection: 'column'\n    },\n    label: {\n      padding: `0.2em 2em`,\n      textTransform: 'none',\n      fontSize: '1.2em',\n      fontWeight: 100\n    }\n  }),\n  { name: 'Tabs', index: 1 }\n);\n","import React, { FC, memo, ReactNode } from 'react';\nimport { Tab as ReactTab, TabList, TabPanel, Tabs as ReactTabs } from 'react-tabs';\n\nimport { Button } from '@material-ui/core';\n\nimport useStyles from './styles';\nimport shortid from 'shortid';\n\ninterface Tab {\n  label: string;\n  component: ReactNode;\n}\n\ninterface TabsProp {\n  tabs: Tab[];\n}\n\nconst Tabs: FC<TabsProp> = ({ tabs }) => {\n  const styles = useStyles();\n\n  return (\n    <div className={styles.root}>\n      <ReactTabs>\n        <TabList>\n          {tabs.map(tab => (\n            <ReactTab key={shortid.generate()}>\n              <Button classes={{ label: styles.label }}>{tab.label}</Button>\n            </ReactTab>\n          ))}\n        </TabList>\n\n        {tabs.map(tab => (\n          <TabPanel key={shortid.generate()}>{tab.component}</TabPanel>\n        ))}\n      </ReactTabs>\n    </div>\n  );\n};\n\nexport default memo(Tabs);\n","import React, { FC, memo } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faSpinner } from '@fortawesome/free-solid-svg-icons';\n\nimport styles from './Loading.module.scss';\n\nconst Loading: FC = () => {\n  return (\n    <div className={styles.root}>\n      <FontAwesomeIcon icon={faSpinner} className={styles.root} size=\"4x\" spin />\n    </div>\n  );\n};\n\nexport default memo(Loading);\n","import { makeStyles, Theme as AugmentedTheme } from '@material-ui/core/styles';\n\nexport default makeStyles(\n  (theme: AugmentedTheme) => ({\n    root: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: theme.variables.spacing.globalPadding\n    },\n    createPathwayButton: {\n      alignSelf: 'flex-end'\n    },\n    pathwayList: {\n      marginTop: '2em'\n    },\n    pathwaysListButton: {\n      marginRight: '1em'\n    },\n    dialogCloseButton: {\n      float: 'right',\n      width: '45px'\n    }\n  }),\n  { name: 'PathwaysList', index: 1 }\n);\n","import React, { FC, useCallback, useRef, memo, FormEvent } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faPlus, faTimes } from '@fortawesome/free-solid-svg-icons';\nimport {\n  Button,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  TextField,\n  IconButton\n} from '@material-ui/core';\nimport shortid from 'shortid';\n\nimport { usePathwayContext } from 'components/PathwayProvider';\nimport useStyles from './styles';\nimport { createNewPathway } from 'utils/builder';\nimport { Pathway } from 'pathways-model';\n\ninterface PathwayModalProps {\n  open: boolean;\n  onClose: () => void;\n  editPathway?: Pathway;\n}\n\nconst PathwayModal: FC<PathwayModalProps> = ({ open, onClose, editPathway }) => {\n  const createNewPathwayMeta = !editPathway;\n  const styles = useStyles();\n  const history = useHistory();\n  const pathwayNameRef = useRef<HTMLInputElement>(null);\n  const pathwayDescRef = useRef<HTMLInputElement>(null);\n  const { addPathway, updatePathway } = usePathwayContext();\n\n  const closeModal = useCallback(\n    (pathwayId: string): void => {\n      history.push(`/builder/${encodeURIComponent(pathwayId)}/node/Start`);\n      onClose();\n    },\n    [history, onClose]\n  );\n\n  const handleCreateNewPathway = useCallback(\n    (event: FormEvent<HTMLFormElement>): void => {\n      event.preventDefault();\n      const pathwayId = shortid.generate();\n      const name: string = pathwayNameRef.current?.value ?? '';\n      const description: string = pathwayDescRef.current?.value ?? '';\n      addPathway(createNewPathway(name, description, pathwayId));\n      closeModal(pathwayId);\n    },\n    [addPathway, closeModal]\n  );\n\n  const handleUpdatePathway = useCallback(\n    (event: FormEvent<HTMLFormElement>): void => {\n      event.preventDefault();\n      if (editPathway) {\n        if (pathwayNameRef.current?.value) editPathway.name = pathwayNameRef.current?.value;\n        editPathway.description = pathwayDescRef.current?.value;\n        updatePathway(editPathway);\n        onClose();\n      }\n    },\n    [updatePathway, editPathway, onClose]\n  );\n\n  let name, description;\n  if (editPathway) {\n    name = editPathway.name;\n    const metaDescription = editPathway.description;\n    if (metaDescription && metaDescription !== '') description = metaDescription;\n  }\n\n  return (\n    <Dialog open={open} onClose={onClose} aria-labelledby=\"create-pathway\" fullWidth maxWidth=\"md\">\n      <DialogTitle disableTypography>\n        <IconButton aria-label=\"close\" onClick={onClose} className={styles.dialogCloseButton}>\n          <FontAwesomeIcon icon={faTimes} />\n        </IconButton>\n      </DialogTitle>\n\n      <form onSubmit={createNewPathwayMeta ? handleCreateNewPathway : handleUpdatePathway}>\n        <DialogContent>\n          <TextField\n            variant=\"outlined\"\n            autoFocus\n            label=\"Pathway Name\"\n            fullWidth\n            required={createNewPathwayMeta}\n            inputRef={pathwayNameRef}\n            defaultValue={createNewPathwayMeta ? undefined : name}\n          />\n\n          <TextField\n            variant=\"outlined\"\n            label=\"Pathway Description\"\n            fullWidth\n            inputRef={pathwayDescRef}\n            defaultValue={createNewPathwayMeta ? undefined : description}\n            multiline\n          />\n        </DialogContent>\n\n        <DialogActions>\n          <Button\n            variant=\"contained\"\n            color=\"primary\"\n            startIcon={createNewPathwayMeta && <FontAwesomeIcon icon={faPlus} />}\n            type=\"submit\"\n          >\n            {createNewPathwayMeta ? 'Create' : 'Save'}\n          </Button>\n        </DialogActions>\n      </form>\n    </Dialog>\n  );\n};\n\nexport default memo(PathwayModal);\n","import React, { FC, memo, useState, useCallback } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faEdit, faFileDownload, faTrashAlt } from '@fortawesome/free-solid-svg-icons';\nimport {\n  Button,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n  Link\n} from '@material-ui/core';\n\nimport { usePathwayContext } from 'components/PathwayProvider';\nimport { downloadPathway } from 'utils/builder';\nimport PathwayModal from './PathwayModal';\n\nimport useStyles from './styles';\nimport { Pathway } from 'pathways-model';\nimport { Link as RouterLink } from 'react-router-dom';\n\nconst PathwaysTable: FC = () => {\n  const styles = useStyles();\n  const { pathways, deletePathway } = usePathwayContext();\n  const [open, setOpen] = useState(false);\n  const [editablePathway, setEditablePathway] = useState<Pathway>();\n\n  const openEditPathwayModal = useCallback((pathway: Pathway): void => {\n    setOpen(true);\n    setEditablePathway(pathway);\n  }, []);\n\n  const closeEditPathwayModal = useCallback((): void => {\n    setOpen(false);\n  }, []);\n\n  return (\n    <div>\n      <TableContainer className={styles.pathwayList}>\n        <Table aria-label=\"pathway list\">\n          <TableHead>\n            <TableRow>\n              <TableCell>Pathway Name</TableCell>\n              <TableCell>Status</TableCell>\n              <TableCell>Last Updated</TableCell>\n              <TableCell></TableCell>\n            </TableRow>\n          </TableHead>\n\n          <TableBody>\n            {pathways.map(pathway => (\n              <TableRow key={pathway.id}>\n                <TableCell component=\"th\" scope=\"row\">\n                  <Link\n                    component={RouterLink}\n                    to={`/builder/${encodeURIComponent(pathway.id)}`}\n                    color=\"primary\"\n                    underline=\"none\"\n                  >\n                    {pathway.name}\n                  </Link>\n                </TableCell>\n\n                <TableCell>draft</TableCell>\n                <TableCell>2 days ago</TableCell>\n\n                <TableCell align=\"right\">\n                  <Button\n                    className={styles.pathwaysListButton}\n                    color=\"primary\"\n                    size=\"small\"\n                    startIcon={<FontAwesomeIcon icon={faEdit} />}\n                    onClick={(): void => openEditPathwayModal(pathway)}\n                  >\n                    Edit Info\n                  </Button>\n                  <Button\n                    className={styles.pathwaysListButton}\n                    color=\"primary\"\n                    size=\"small\"\n                    startIcon={<FontAwesomeIcon icon={faFileDownload} />}\n                    onClick={(): void => downloadPathway(pathway)}\n                  >\n                    Export\n                  </Button>\n                  <Button\n                    color=\"secondary\"\n                    size=\"small\"\n                    startIcon={<FontAwesomeIcon icon={faTrashAlt} />}\n                    onClick={(): void => deletePathway(pathway.id)}\n                  >\n                    Delete\n                  </Button>\n                </TableCell>\n              </TableRow>\n            ))}\n          </TableBody>\n        </Table>\n      </TableContainer>\n      <PathwayModal open={open} onClose={closeEditPathwayModal} editPathway={editablePathway} />\n    </div>\n  );\n};\n\nexport default memo(PathwaysTable);\n","import React, { FC, useCallback, useState, memo } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faPlus } from '@fortawesome/free-solid-svg-icons';\nimport { Button } from '@material-ui/core';\n\nimport { usePathwayContext } from 'components/PathwayProvider';\nimport Loading from 'components/elements/Loading';\nimport PathwaysTable from './PathwaysTable';\nimport PathwayModal from './PathwayModal';\n\nimport useStyles from './styles';\n\nconst PathwaysList: FC = () => {\n  const styles = useStyles();\n  const [open, setOpen] = useState(false);\n  const { status } = usePathwayContext();\n\n  const openNewPathwayModal = useCallback((): void => {\n    setOpen(true);\n  }, []);\n\n  const closeNewPathwayModal = useCallback((): void => {\n    setOpen(false);\n  }, []);\n\n  return (\n    <div className={styles.root}>\n      <Button\n        className={styles.createPathwayButton}\n        variant=\"contained\"\n        color=\"primary\"\n        startIcon={<FontAwesomeIcon icon={faPlus} />}\n        onClick={openNewPathwayModal}\n      >\n        Create Pathway\n      </Button>\n\n      <PathwayModal open={open} onClose={closeNewPathwayModal} />\n      {status === 'loading' ? <Loading /> : <PathwaysTable />}\n    </div>\n  );\n};\n\nexport default memo(PathwaysList);\n","import { makeStyles, Theme as AugmentedTheme } from '@material-ui/core/styles';\n\nexport default makeStyles(\n  (theme: AugmentedTheme) => ({\n    root: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: theme.variables.spacing.globalPadding\n    },\n    buttonRow: {\n      display: 'flex',\n      justifyContent: 'flex-end'\n    },\n    buildCriteriaButton: {\n      alignSelf: 'flex-end',\n      marginLeft: '20px'\n    },\n    criteriaList: {\n      marginTop: '2em'\n    },\n    editButton: {\n      marginRight: '1em'\n    },\n    dialogCloseButton: {\n      float: 'right',\n      width: '45px'\n    },\n    input: {\n      display: 'none'\n    },\n    chooseFileInput: {\n      display: 'flex',\n      alignItems: 'center'\n    },\n    inputButton: {\n      whiteSpace: 'nowrap',\n      marginRight: '1em'\n    },\n    fileName: {\n      fontStyle: 'italic'\n    }\n  }),\n  { name: 'CriteriaList', index: 1 }\n);\n","import React, { FC, memo } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faEdit, faTrashAlt } from '@fortawesome/free-solid-svg-icons';\nimport {\n  Button,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow\n} from '@material-ui/core';\nimport moment from 'moment';\n\nimport useStyles from './styles';\nimport { useCriteriaContext } from 'components/CriteriaProvider';\n\nconst CriteriaTable: FC = () => {\n  const styles = useStyles();\n  const { criteria, deleteCriteria } = useCriteriaContext();\n\n  const renderDate = (datetime: number): string => {\n    return moment(datetime).fromNow();\n  };\n\n  return (\n    <TableContainer className={styles.criteriaList}>\n      <Table aria-label=\"criteria list\">\n        <TableHead>\n          <TableRow>\n            <TableCell>Criteria Name</TableCell>\n            <TableCell>Version</TableCell>\n            <TableCell>Added</TableCell>\n            <TableCell></TableCell>\n          </TableRow>\n        </TableHead>\n\n        <TableBody>\n          {criteria.map(c => (\n            <TableRow key={c.id}>\n              <TableCell component=\"th\" scope=\"row\">\n                {c.label}\n              </TableCell>\n              <TableCell>{c.version}</TableCell>\n              <TableCell>{renderDate(c.modified)}</TableCell>\n\n              <TableCell align=\"right\">\n                <Button\n                  className={styles.editButton}\n                  color=\"primary\"\n                  size=\"small\"\n                  startIcon={<FontAwesomeIcon icon={faEdit} />}\n                >\n                  Edit\n                </Button>\n\n                <Button\n                  color=\"secondary\"\n                  size=\"small\"\n                  startIcon={<FontAwesomeIcon icon={faTrashAlt} />}\n                  onClick={(): void => deleteCriteria(c.id)}\n                >\n                  Delete\n                </Button>\n              </TableCell>\n            </TableRow>\n          ))}\n        </TableBody>\n      </Table>\n    </TableContainer>\n  );\n};\n\nexport default memo(CriteriaTable);\n","import React, { FC, useCallback, useRef, memo, FormEvent, useState } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faFileImport, faTimes } from '@fortawesome/free-solid-svg-icons';\nimport {\n  Button,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Input,\n  IconButton\n} from '@material-ui/core';\n\nimport { useCriteriaContext } from 'components/CriteriaProvider';\nimport useStyles from './styles';\n\ninterface ImportCriteriaModalProps {\n  open: boolean;\n  onClose: () => void;\n}\n\nconst ImportCriteriaModal: FC<ImportCriteriaModalProps> = ({ open, onClose }) => {\n  const styles = useStyles();\n  const [fileName, setFileName] = useState<string>('');\n  const importFileRef = useRef<HTMLInputElement>(null);\n\n  const { addCriteria } = useCriteriaContext();\n\n  const selectFile = useCallback(\n    (event: FormEvent<HTMLFormElement>) => {\n      event.preventDefault();\n      const files = importFileRef?.current?.files;\n      if (files?.length) addCriteria(files[0]);\n      onClose();\n      setFileName('');\n    },\n    [addCriteria, onClose]\n  );\n\n  const handleChooseFile = useCallback(() => {\n    if (importFileRef?.current?.files?.[0]) setFileName(importFileRef.current.files[0].name);\n  }, [importFileRef]);\n\n  return (\n    <Dialog open={open} onClose={onClose} aria-labelledby=\"import-criteria\" fullWidth maxWidth=\"sm\">\n      <DialogTitle disableTypography>\n        <IconButton aria-label=\"close\" onClick={onClose} className={styles.dialogCloseButton}>\n          <FontAwesomeIcon icon={faTimes} />\n        </IconButton>\n      </DialogTitle>\n\n      <form onSubmit={selectFile}>\n        <DialogContent>\n          <div className={styles.chooseFileInput}>\n            <Input\n              id=\"choose-file-input\"\n              className={styles.input}\n              inputRef={importFileRef}\n              type=\"file\"\n              inputProps={{ accept: '.json' }}\n              onChange={handleChooseFile}\n            />\n\n            <label htmlFor=\"choose-file-input\">\n              <Button\n                className={styles.inputButton}\n                variant=\"contained\"\n                color=\"primary\"\n                component=\"span\"\n              >\n                Choose File\n              </Button>\n            </label>\n\n            <div className={styles.fileName}>\n              {fileName ? <span>{fileName}</span> : <span>Choose ELM file to import.</span>}\n            </div>\n          </div>\n        </DialogContent>\n\n        <DialogActions>\n          <Button\n            variant=\"contained\"\n            color=\"primary\"\n            startIcon={<FontAwesomeIcon icon={faFileImport} />}\n            type=\"submit\"\n          >\n            Import\n          </Button>\n        </DialogActions>\n      </form>\n    </Dialog>\n  );\n};\n\nexport default memo(ImportCriteriaModal);\n","import React, { FC, memo, useState, useCallback } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faTools, faFileImport } from '@fortawesome/free-solid-svg-icons';\nimport { Button } from '@material-ui/core';\n\nimport { usePathwayContext } from 'components/PathwayProvider';\nimport Loading from 'components/elements/Loading';\nimport CriteriaTable from './CriteriaTable';\nimport ImportCriteriaModal from './ImportCriteriaModal';\n\nimport useStyles from './styles';\n\nconst CriteriaList: FC = () => {\n  const styles = useStyles();\n  const { status } = usePathwayContext();\n\n  const [open, setOpen] = useState<boolean>(false);\n  const openImportModal = useCallback((): void => {\n    setOpen(true);\n  }, []);\n\n  const closeImportModal = useCallback((): void => {\n    setOpen(false);\n  }, []);\n\n  return (\n    <div className={styles.root}>\n      <div className={styles.buttonRow}>\n        <Button\n          className={styles.buildCriteriaButton}\n          variant=\"contained\"\n          color=\"primary\"\n          startIcon={<FontAwesomeIcon icon={faFileImport} />}\n          onClick={openImportModal}\n        >\n          Import Library\n        </Button>\n        <Button\n          className={styles.buildCriteriaButton}\n          variant=\"contained\"\n          color=\"primary\"\n          startIcon={<FontAwesomeIcon icon={faTools} />}\n        >\n          Build Criteria\n        </Button>\n      </div>\n\n      <ImportCriteriaModal open={open} onClose={closeImportModal} />\n\n      {status === 'loading' ? <Loading /> : <CriteriaTable />}\n    </div>\n  );\n};\n\nexport default memo(CriteriaList);\n","import React, { FC, memo } from 'react';\nimport { HashRouter as Router, Route, Switch } from 'react-router-dom';\n\nimport Header from 'components/Header';\n\nimport BuilderRoute from './BuilderRoute';\nimport ThemeProvider from './ThemeProvider';\nimport { PathwayProvider } from './PathwayProvider';\nimport { UserProvider } from './UserProvider';\nimport { CriteriaProvider } from './CriteriaProvider';\nimport Tabs from './Tabs';\nimport PathwaysList from './PathwaysList';\nimport CriteriaList from './CriteriaList';\n\nconst App: FC = () => {\n  return (\n    <ThemeProvider theme=\"light\">\n      <UserProvider>\n        <PathwayProvider>\n          <CriteriaProvider>\n            <Router>\n              <Switch>\n                <Route path=\"/builder/:id/node/:nodeId\">\n                  <BuilderRoute />\n                </Route>\n                <Route path=\"/builder/:id\">\n                  <BuilderRoute />\n                </Route>\n                <Route path=\"/\">\n                  <Header />\n                  <Tabs\n                    tabs={[\n                      { label: 'Pathway', component: <PathwaysList /> },\n                      { label: 'Criteria', component: <CriteriaList /> }\n                    ]}\n                  />\n                </Route>\n              </Switch>\n            </Router>\n          </CriteriaProvider>\n        </PathwayProvider>\n      </UserProvider>\n    </ThemeProvider>\n  );\n};\n\nexport default memo(App);\n","import 'react-app-polyfill/ie11';\nimport 'react-app-polyfill/stable';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from 'components/App';\n\nimport './styles/index.scss';\n\nReactDOM.render(<App />, document.getElementById('root'));\n","export class ConfigManager {\n  constructor(config = {}) {\n    this.config = global.CONFIG ? { ...global.CONFIG, ...config } : { ...config };\n  }\n\n  get(name, defaultValue) {\n    const parts = name.split('.');\n    let context = this.config;\n    let value = null;\n    for (const i in parts) {\n      const part = parts[i];\n      value = context[part];\n      context = value;\n    }\n    return value || defaultValue;\n  }\n\n  add(conf) {\n    if (conf) {\n      this.config = {\n        ...this.config,\n        ...conf\n      };\n    }\n  }\n}\n\nconst config = new ConfigManager();\nexport default config;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"node\":\"Node_node__38uoJ\",\"icon\":\"Node_icon__354W4\",\"actionable\":\"Node_actionable__bHXKd\",\"expandedNode\":\"Node_expandedNode__1ar-A\",\"childNotActionable\":\"Node_childNotActionable__1bfBq\",\"childActionable\":\"Node_childActionable__SwUjD\"};"],"sourceRoot":""}